function by(a,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in a)){const l=Object.getOwnPropertyDescriptor(s,o);l&&Object.defineProperty(a,o,l.get?l:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function Sy(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var qd={exports:{}},Dr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pv;function RC(){if(Pv)return Dr;Pv=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:a,type:s,key:u,ref:o!==void 0?o:null,props:l}}return Dr.Fragment=e,Dr.jsx=n,Dr.jsxs=n,Dr}var Lv;function AC(){return Lv||(Lv=1,qd.exports=RC()),qd.exports}var b=AC(),Fd={exports:{}},be={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv;function MC(){if(Iv)return be;Iv=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),S=Symbol.iterator;function T(R){return R===null||typeof R!="object"?null:(R=S&&R[S]||R["@@iterator"],typeof R=="function"?R:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,D={};function M(R,K,ne){this.props=R,this.context=K,this.refs=D,this.updater=ne||x}M.prototype.isReactComponent={},M.prototype.setState=function(R,K){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,K,"setState")},M.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function Y(){}Y.prototype=M.prototype;function P(R,K,ne){this.props=R,this.context=K,this.refs=D,this.updater=ne||x}var A=P.prototype=new Y;A.constructor=P,E(A,M.prototype),A.isPureReactComponent=!0;var N=Array.isArray;function V(){}var X={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function J(R,K,ne){var le=ne.ref;return{$$typeof:a,type:R,key:K,ref:le!==void 0?le:null,props:ne}}function H(R,K){return J(R.type,K,R.props)}function se(R){return typeof R=="object"&&R!==null&&R.$$typeof===a}function fe(R){var K={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(ne){return K[ne]})}var qe=/\/+/g;function $e(R,K){return typeof R=="object"&&R!==null&&R.key!=null?fe(""+R.key):K.toString(36)}function Je(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(V,V):(R.status="pending",R.then(function(K){R.status==="pending"&&(R.status="fulfilled",R.value=K)},function(K){R.status==="pending"&&(R.status="rejected",R.reason=K)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function F(R,K,ne,le,ge){var ye=typeof R;(ye==="undefined"||ye==="boolean")&&(R=null);var ve=!1;if(R===null)ve=!0;else switch(ye){case"bigint":case"string":case"number":ve=!0;break;case"object":switch(R.$$typeof){case a:case e:ve=!0;break;case g:return ve=R._init,F(ve(R._payload),K,ne,le,ge)}}if(ve)return ge=ge(R),ve=le===""?"."+$e(R,0):le,N(ge)?(ne="",ve!=null&&(ne=ve.replace(qe,"$&/")+"/"),F(ge,K,ne,"",function(Pn){return Pn})):ge!=null&&(se(ge)&&(ge=H(ge,ne+(ge.key==null||R&&R.key===ge.key?"":(""+ge.key).replace(qe,"$&/")+"/")+ve)),K.push(ge)),1;ve=0;var Tt=le===""?".":le+":";if(N(R))for(var Ze=0;Ze<R.length;Ze++)le=R[Ze],ye=Tt+$e(le,Ze),ve+=F(le,K,ne,ye,ge);else if(Ze=T(R),typeof Ze=="function")for(R=Ze.call(R),Ze=0;!(le=R.next()).done;)le=le.value,ye=Tt+$e(le,Ze++),ve+=F(le,K,ne,ye,ge);else if(ye==="object"){if(typeof R.then=="function")return F(Je(R),K,ne,le,ge);throw K=String(R),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return ve}function ae(R,K,ne){if(R==null)return R;var le=[],ge=0;return F(R,le,"","",function(ye){return K.call(ne,ye,ge++)}),le}function ee(R){if(R._status===-1){var K=R._result;K=K(),K.then(function(ne){(R._status===0||R._status===-1)&&(R._status=1,R._result=ne)},function(ne){(R._status===0||R._status===-1)&&(R._status=2,R._result=ne)}),R._status===-1&&(R._status=0,R._result=K)}if(R._status===1)return R._result.default;throw R._result}var De=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)},Le={map:ae,forEach:function(R,K,ne){ae(R,function(){K.apply(this,arguments)},ne)},count:function(R){var K=0;return ae(R,function(){K++}),K},toArray:function(R){return ae(R,function(K){return K})||[]},only:function(R){if(!se(R))throw Error("React.Children.only expected to receive a single React element child.");return R}};return be.Activity=v,be.Children=Le,be.Component=M,be.Fragment=n,be.Profiler=o,be.PureComponent=P,be.StrictMode=s,be.Suspense=f,be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=X,be.__COMPILER_RUNTIME={__proto__:null,c:function(R){return X.H.useMemoCache(R)}},be.cache=function(R){return function(){return R.apply(null,arguments)}},be.cacheSignal=function(){return null},be.cloneElement=function(R,K,ne){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var le=E({},R.props),ge=R.key;if(K!=null)for(ye in K.key!==void 0&&(ge=""+K.key),K)!z.call(K,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&K.ref===void 0||(le[ye]=K[ye]);var ye=arguments.length-2;if(ye===1)le.children=ne;else if(1<ye){for(var ve=Array(ye),Tt=0;Tt<ye;Tt++)ve[Tt]=arguments[Tt+2];le.children=ve}return J(R.type,ge,le)},be.createContext=function(R){return R={$$typeof:u,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:l,_context:R},R},be.createElement=function(R,K,ne){var le,ge={},ye=null;if(K!=null)for(le in K.key!==void 0&&(ye=""+K.key),K)z.call(K,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(ge[le]=K[le]);var ve=arguments.length-2;if(ve===1)ge.children=ne;else if(1<ve){for(var Tt=Array(ve),Ze=0;Ze<ve;Ze++)Tt[Ze]=arguments[Ze+2];ge.children=Tt}if(R&&R.defaultProps)for(le in ve=R.defaultProps,ve)ge[le]===void 0&&(ge[le]=ve[le]);return J(R,ye,ge)},be.createRef=function(){return{current:null}},be.forwardRef=function(R){return{$$typeof:d,render:R}},be.isValidElement=se,be.lazy=function(R){return{$$typeof:g,_payload:{_status:-1,_result:R},_init:ee}},be.memo=function(R,K){return{$$typeof:m,type:R,compare:K===void 0?null:K}},be.startTransition=function(R){var K=X.T,ne={};X.T=ne;try{var le=R(),ge=X.S;ge!==null&&ge(ne,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(V,De)}catch(ye){De(ye)}finally{K!==null&&ne.types!==null&&(K.types=ne.types),X.T=K}},be.unstable_useCacheRefresh=function(){return X.H.useCacheRefresh()},be.use=function(R){return X.H.use(R)},be.useActionState=function(R,K,ne){return X.H.useActionState(R,K,ne)},be.useCallback=function(R,K){return X.H.useCallback(R,K)},be.useContext=function(R){return X.H.useContext(R)},be.useDebugValue=function(){},be.useDeferredValue=function(R,K){return X.H.useDeferredValue(R,K)},be.useEffect=function(R,K){return X.H.useEffect(R,K)},be.useEffectEvent=function(R){return X.H.useEffectEvent(R)},be.useId=function(){return X.H.useId()},be.useImperativeHandle=function(R,K,ne){return X.H.useImperativeHandle(R,K,ne)},be.useInsertionEffect=function(R,K){return X.H.useInsertionEffect(R,K)},be.useLayoutEffect=function(R,K){return X.H.useLayoutEffect(R,K)},be.useMemo=function(R,K){return X.H.useMemo(R,K)},be.useOptimistic=function(R,K){return X.H.useOptimistic(R,K)},be.useReducer=function(R,K,ne){return X.H.useReducer(R,K,ne)},be.useRef=function(R){return X.H.useRef(R)},be.useState=function(R){return X.H.useState(R)},be.useSyncExternalStore=function(R,K,ne){return X.H.useSyncExternalStore(R,K,ne)},be.useTransition=function(){return X.H.useTransition()},be.version="19.2.0",be}var jv;function Xh(){return jv||(jv=1,Fd.exports=MC()),Fd.exports}var B=Xh();const Wh=Sy(B),NC=by({__proto__:null,default:Wh},[B]);var Vd={exports:{}},Lt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv;function OC(){if(Uv)return Lt;Uv=1;var a=Xh();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(f,m,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:f,containerInfo:m,implementation:g}}var u=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Lt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Lt.createPortal=function(f,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(f,m,null,g)},Lt.flushSync=function(f){var m=u.T,g=s.p;try{if(u.T=null,s.p=2,f)return f()}finally{u.T=m,s.p=g,s.d.f()}},Lt.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(f,m))},Lt.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},Lt.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var g=m.as,v=d(g,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?s.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:S,fetchPriority:T}):g==="script"&&s.d.X(f,{crossOrigin:v,integrity:S,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Lt.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=d(m.as,m.crossOrigin);s.d.M(f,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(f)},Lt.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,v=d(g,m.crossOrigin);s.d.L(f,g,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Lt.preloadModule=function(f,m){if(typeof f=="string")if(m){var g=d(m.as,m.crossOrigin);s.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(f)},Lt.requestFormReset=function(f){s.d.r(f)},Lt.unstable_batchedUpdates=function(f,m){return f(m)},Lt.useFormState=function(f,m,g){return u.H.useFormState(f,m,g)},Lt.useFormStatus=function(){return u.H.useHostTransitionStatus()},Lt.version="19.2.0",Lt}var Bv;function ky(){if(Bv)return Vd.exports;Bv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),Vd.exports=OC(),Vd.exports}var Ty=ky();const DC=Sy(Ty),PC=by({__proto__:null,default:DC},[Ty]);var Hd={exports:{}},Pr={},Gd={exports:{}},Yd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function LC(){return zv||(zv=1,(function(a){function e(F,ae){var ee=F.length;F.push(ae);e:for(;0<ee;){var De=ee-1>>>1,Le=F[De];if(0<o(Le,ae))F[De]=ae,F[ee]=Le,ee=De;else break e}}function n(F){return F.length===0?null:F[0]}function s(F){if(F.length===0)return null;var ae=F[0],ee=F.pop();if(ee!==ae){F[0]=ee;e:for(var De=0,Le=F.length,R=Le>>>1;De<R;){var K=2*(De+1)-1,ne=F[K],le=K+1,ge=F[le];if(0>o(ne,ee))le<Le&&0>o(ge,ne)?(F[De]=ge,F[le]=ee,De=le):(F[De]=ne,F[K]=ee,De=K);else if(le<Le&&0>o(ge,ee))F[De]=ge,F[le]=ee,De=le;else break e}}return ae}function o(F,ae){var ee=F.sortIndex-ae.sortIndex;return ee!==0?ee:F.id-ae.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;a.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();a.unstable_now=function(){return u.now()-d}}var f=[],m=[],g=1,v=null,S=3,T=!1,x=!1,E=!1,D=!1,M=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function A(F){for(var ae=n(m);ae!==null;){if(ae.callback===null)s(m);else if(ae.startTime<=F)s(m),ae.sortIndex=ae.expirationTime,e(f,ae);else break;ae=n(m)}}function N(F){if(E=!1,A(F),!x)if(n(f)!==null)x=!0,V||(V=!0,fe());else{var ae=n(m);ae!==null&&Je(N,ae.startTime-F)}}var V=!1,X=-1,z=5,J=-1;function H(){return D?!0:!(a.unstable_now()-J<z)}function se(){if(D=!1,V){var F=a.unstable_now();J=F;var ae=!0;try{e:{x=!1,E&&(E=!1,Y(X),X=-1),T=!0;var ee=S;try{t:{for(A(F),v=n(f);v!==null&&!(v.expirationTime>F&&H());){var De=v.callback;if(typeof De=="function"){v.callback=null,S=v.priorityLevel;var Le=De(v.expirationTime<=F);if(F=a.unstable_now(),typeof Le=="function"){v.callback=Le,A(F),ae=!0;break t}v===n(f)&&s(f),A(F)}else s(f);v=n(f)}if(v!==null)ae=!0;else{var R=n(m);R!==null&&Je(N,R.startTime-F),ae=!1}}break e}finally{v=null,S=ee,T=!1}ae=void 0}}finally{ae?fe():V=!1}}}var fe;if(typeof P=="function")fe=function(){P(se)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,$e=qe.port2;qe.port1.onmessage=se,fe=function(){$e.postMessage(null)}}else fe=function(){M(se,0)};function Je(F,ae){X=M(function(){F(a.unstable_now())},ae)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(F){F.callback=null},a.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<F?Math.floor(1e3/F):5},a.unstable_getCurrentPriorityLevel=function(){return S},a.unstable_next=function(F){switch(S){case 1:case 2:case 3:var ae=3;break;default:ae=S}var ee=S;S=ae;try{return F()}finally{S=ee}},a.unstable_requestPaint=function(){D=!0},a.unstable_runWithPriority=function(F,ae){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ee=S;S=F;try{return ae()}finally{S=ee}},a.unstable_scheduleCallback=function(F,ae,ee){var De=a.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?De+ee:De):ee=De,F){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ee+Le,F={id:g++,callback:ae,priorityLevel:F,startTime:ee,expirationTime:Le,sortIndex:-1},ee>De?(F.sortIndex=ee,e(m,F),n(f)===null&&F===n(m)&&(E?(Y(X),X=-1):E=!0,Je(N,ee-De))):(F.sortIndex=Le,e(f,F),x||T||(x=!0,V||(V=!0,fe()))),F},a.unstable_shouldYield=H,a.unstable_wrapCallback=function(F){var ae=S;return function(){var ee=S;S=ae;try{return F.apply(this,arguments)}finally{S=ee}}}})(Yd)),Yd}var qv;function IC(){return qv||(qv=1,Gd.exports=LC()),Gd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fv;function jC(){if(Fv)return Pr;Fv=1;var a=IC(),e=Xh(),n=ky();function s(t){var i="https://react.dev/errors/"+t;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)i+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l(t){var i=t,r=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(r=i.return),t=i.return;while(t)}return i.tag===3?r:null}function u(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function d(t){if(t.tag===31){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function f(t){if(l(t)!==t)throw Error(s(188))}function m(t){var i=t.alternate;if(!i){if(i=l(t),i===null)throw Error(s(188));return i!==t?null:t}for(var r=t,c=i;;){var h=r.return;if(h===null)break;var p=h.alternate;if(p===null){if(c=h.return,c!==null){r=c;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===r)return f(h),t;if(p===c)return f(h),i;p=p.sibling}throw Error(s(188))}if(r.return!==c.return)r=h,c=p;else{for(var y=!1,k=h.child;k;){if(k===r){y=!0,r=h,c=p;break}if(k===c){y=!0,c=h,r=p;break}k=k.sibling}if(!y){for(k=p.child;k;){if(k===r){y=!0,r=p,c=h;break}if(k===c){y=!0,c=p,r=h;break}k=k.sibling}if(!y)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?t:i}function g(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t;for(t=t.child;t!==null;){if(i=g(t),i!==null)return i;t=t.sibling}return null}var v=Object.assign,S=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),P=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),J=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),se=Symbol.iterator;function fe(t){return t===null||typeof t!="object"?null:(t=se&&t[se]||t["@@iterator"],typeof t=="function"?t:null)}var qe=Symbol.for("react.client.reference");function $e(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===qe?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case E:return"Fragment";case M:return"Profiler";case D:return"StrictMode";case N:return"Suspense";case V:return"SuspenseList";case J:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case x:return"Portal";case P:return t.displayName||"Context";case Y:return(t._context.displayName||"Context")+".Consumer";case A:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case X:return i=t.displayName||null,i!==null?i:$e(t.type)||"Memo";case z:i=t._payload,t=t._init;try{return $e(t(i))}catch{}}return null}var Je=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},De=[],Le=-1;function R(t){return{current:t}}function K(t){0>Le||(t.current=De[Le],De[Le]=null,Le--)}function ne(t,i){Le++,De[Le]=t.current,t.current=i}var le=R(null),ge=R(null),ye=R(null),ve=R(null);function Tt(t,i){switch(ne(ye,i),ne(ge,t),ne(le,null),i.nodeType){case 9:case 11:t=(t=i.documentElement)&&(t=t.namespaceURI)?iv(t):0;break;default:if(t=i.tagName,i=i.namespaceURI)i=iv(i),t=av(i,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}K(le),ne(le,t)}function Ze(){K(le),K(ge),K(ye)}function Pn(t){t.memoizedState!==null&&ne(ve,t);var i=le.current,r=av(i,t.type);i!==r&&(ne(ge,t),ne(le,r))}function xi(t){ge.current===t&&(K(le),K(ge)),ve.current===t&&(K(ve),Ar._currentValue=ee)}var Ei,Df;function ua(t){if(Ei===void 0)try{throw Error()}catch(r){var i=r.stack.trim().match(/\n( *(at )?)/);Ei=i&&i[1]||"",Df=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ei+t+Df}var xc=!1;function Ec(t,i){if(!t||xc)return"";xc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(q){var U=q}Reflect.construct(t,[],W)}else{try{W.call()}catch(q){U=q}t.call(W.prototype)}}else{try{throw Error()}catch(q){U=q}(W=t())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(q){if(q&&U&&typeof q.stack=="string")return[q.stack,U.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),y=p[0],k=p[1];if(y&&k){var w=y.split(`
`),I=k.split(`
`);for(h=c=0;c<w.length&&!w[c].includes("DetermineComponentFrameRoot");)c++;for(;h<I.length&&!I[h].includes("DetermineComponentFrameRoot");)h++;if(c===w.length||h===I.length)for(c=w.length-1,h=I.length-1;1<=c&&0<=h&&w[c]!==I[h];)h--;for(;1<=c&&0<=h;c--,h--)if(w[c]!==I[h]){if(c!==1||h!==1)do if(c--,h--,0>h||w[c]!==I[h]){var G=`
`+w[c].replace(" at new "," at ");return t.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",t.displayName)),G}while(1<=c&&0<=h);break}}}finally{xc=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?ua(r):""}function sk(t,i){switch(t.tag){case 26:case 27:case 5:return ua(t.type);case 16:return ua("Lazy");case 13:return t.child!==i&&i!==null?ua("Suspense Fallback"):ua("Suspense");case 19:return ua("SuspenseList");case 0:case 15:return Ec(t.type,!1);case 11:return Ec(t.type.render,!1);case 1:return Ec(t.type,!0);case 31:return ua("Activity");default:return""}}function Pf(t){try{var i="",r=null;do i+=sk(t,r),r=t,t=t.return;while(t);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var wc=Object.prototype.hasOwnProperty,_c=a.unstable_scheduleCallback,Rc=a.unstable_cancelCallback,rk=a.unstable_shouldYield,ok=a.unstable_requestPaint,Wt=a.unstable_now,lk=a.unstable_getCurrentPriorityLevel,Lf=a.unstable_ImmediatePriority,If=a.unstable_UserBlockingPriority,lo=a.unstable_NormalPriority,ck=a.unstable_LowPriority,jf=a.unstable_IdlePriority,uk=a.log,dk=a.unstable_setDisableYieldValue,qs=null,Zt=null;function wi(t){if(typeof uk=="function"&&dk(t),Zt&&typeof Zt.setStrictMode=="function")try{Zt.setStrictMode(qs,t)}catch{}}var $t=Math.clz32?Math.clz32:mk,hk=Math.log,fk=Math.LN2;function mk(t){return t>>>=0,t===0?32:31-(hk(t)/fk|0)|0}var co=256,uo=262144,ho=4194304;function da(t){var i=t&42;if(i!==0)return i;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function fo(t,i,r){var c=t.pendingLanes;if(c===0)return 0;var h=0,p=t.suspendedLanes,y=t.pingedLanes;t=t.warmLanes;var k=c&134217727;return k!==0?(c=k&~p,c!==0?h=da(c):(y&=k,y!==0?h=da(y):r||(r=k&~t,r!==0&&(h=da(r))))):(k=c&~p,k!==0?h=da(k):y!==0?h=da(y):r||(r=c&~t,r!==0&&(h=da(r)))),h===0?0:i!==0&&i!==h&&(i&p)===0&&(p=h&-h,r=i&-i,p>=r||p===32&&(r&4194048)!==0)?i:h}function Fs(t,i){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&i)===0}function pk(t,i){switch(t){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uf(){var t=ho;return ho<<=1,(ho&62914560)===0&&(ho=4194304),t}function Ac(t){for(var i=[],r=0;31>r;r++)i.push(t);return i}function Vs(t,i){t.pendingLanes|=i,i!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function gk(t,i,r,c,h,p){var y=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var k=t.entanglements,w=t.expirationTimes,I=t.hiddenUpdates;for(r=y&~r;0<r;){var G=31-$t(r),W=1<<G;k[G]=0,w[G]=-1;var U=I[G];if(U!==null)for(I[G]=null,G=0;G<U.length;G++){var q=U[G];q!==null&&(q.lane&=-536870913)}r&=~W}c!==0&&Bf(t,c,0),p!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=p&~(y&~i))}function Bf(t,i,r){t.pendingLanes|=i,t.suspendedLanes&=~i;var c=31-$t(i);t.entangledLanes|=i,t.entanglements[c]=t.entanglements[c]|1073741824|r&261930}function zf(t,i){var r=t.entangledLanes|=i;for(t=t.entanglements;r;){var c=31-$t(r),h=1<<c;h&i|t[c]&i&&(t[c]|=i),r&=~h}}function qf(t,i){var r=i&-i;return r=(r&42)!==0?1:Mc(r),(r&(t.suspendedLanes|i))!==0?0:r}function Mc(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Nc(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Ff(){var t=ae.p;return t!==0?t:(t=window.event,t===void 0?32:_v(t.type))}function Vf(t,i){var r=ae.p;try{return ae.p=t,i()}finally{ae.p=r}}var _i=Math.random().toString(36).slice(2),Rt="__reactFiber$"+_i,qt="__reactProps$"+_i,ja="__reactContainer$"+_i,Oc="__reactEvents$"+_i,vk="__reactListeners$"+_i,yk="__reactHandles$"+_i,Hf="__reactResources$"+_i,Hs="__reactMarker$"+_i;function Dc(t){delete t[Rt],delete t[qt],delete t[Oc],delete t[vk],delete t[yk]}function Ua(t){var i=t[Rt];if(i)return i;for(var r=t.parentNode;r;){if(i=r[ja]||r[Rt]){if(r=i.alternate,i.child!==null||r!==null&&r.child!==null)for(t=dv(t);t!==null;){if(r=t[Rt])return r;t=dv(t)}return i}t=r,r=t.parentNode}return null}function Ba(t){if(t=t[Rt]||t[ja]){var i=t.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return t}return null}function Gs(t){var i=t.tag;if(i===5||i===26||i===27||i===6)return t.stateNode;throw Error(s(33))}function za(t){var i=t[Hf];return i||(i=t[Hf]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Ct(t){t[Hs]=!0}var Gf=new Set,Yf={};function ha(t,i){qa(t,i),qa(t+"Capture",i)}function qa(t,i){for(Yf[t]=i,t=0;t<i.length;t++)Gf.add(i[t])}var bk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kf={},Qf={};function Sk(t){return wc.call(Qf,t)?!0:wc.call(Kf,t)?!1:bk.test(t)?Qf[t]=!0:(Kf[t]=!0,!1)}function mo(t,i,r){if(Sk(i))if(r===null)t.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(i);return}}t.setAttribute(i,""+r)}}function po(t,i,r){if(r===null)t.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttribute(i,""+r)}}function Yn(t,i,r,c){if(c===null)t.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(i,r,""+c)}}function cn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Jf(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function kk(t,i,r){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,i);if(!t.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var h=c.get,p=c.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return h.call(this)},set:function(y){r=""+y,p.call(this,y)}}),Object.defineProperty(t,i,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(y){r=""+y},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Pc(t){if(!t._valueTracker){var i=Jf(t)?"checked":"value";t._valueTracker=kk(t,i,""+t[i])}}function Xf(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var r=i.getValue(),c="";return t&&(c=Jf(t)?t.checked?"true":"false":t.value),t=c,t!==r?(i.setValue(t),!0):!1}function go(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Tk=/[\n"\\]/g;function un(t){return t.replace(Tk,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Lc(t,i,r,c,h,p,y,k){t.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?t.type=y:t.removeAttribute("type"),i!=null?y==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+cn(i)):t.value!==""+cn(i)&&(t.value=""+cn(i)):y!=="submit"&&y!=="reset"||t.removeAttribute("value"),i!=null?Ic(t,y,cn(i)):r!=null?Ic(t,y,cn(r)):c!=null&&t.removeAttribute("value"),h==null&&p!=null&&(t.defaultChecked=!!p),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?t.name=""+cn(k):t.removeAttribute("name")}function Wf(t,i,r,c,h,p,y,k){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),i!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){Pc(t);return}r=r!=null?""+cn(r):"",i=i!=null?""+cn(i):r,k||i===t.value||(t.value=i),t.defaultValue=i}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=k?t.checked:!!c,t.defaultChecked=!!c,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(t.name=y),Pc(t)}function Ic(t,i,r){i==="number"&&go(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function Fa(t,i,r,c){if(t=t.options,i){i={};for(var h=0;h<r.length;h++)i["$"+r[h]]=!0;for(r=0;r<t.length;r++)h=i.hasOwnProperty("$"+t[r].value),t[r].selected!==h&&(t[r].selected=h),h&&c&&(t[r].defaultSelected=!0)}else{for(r=""+cn(r),i=null,h=0;h<t.length;h++){if(t[h].value===r){t[h].selected=!0,c&&(t[h].defaultSelected=!0);return}i!==null||t[h].disabled||(i=t[h])}i!==null&&(i.selected=!0)}}function Zf(t,i,r){if(i!=null&&(i=""+cn(i),i!==t.value&&(t.value=i),r==null)){t.defaultValue!==i&&(t.defaultValue=i);return}t.defaultValue=r!=null?""+cn(r):""}function $f(t,i,r,c){if(i==null){if(c!=null){if(r!=null)throw Error(s(92));if(Je(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),i=r}r=cn(i),t.defaultValue=r,c=t.textContent,c===r&&c!==""&&c!==null&&(t.value=c),Pc(t)}function Va(t,i){if(i){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=i;return}}t.textContent=i}var Ck=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function em(t,i,r){var c=i.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="":c?t.setProperty(i,r):typeof r!="number"||r===0||Ck.has(i)?i==="float"?t.cssFloat=r:t[i]=(""+r).trim():t[i]=r+"px"}function tm(t,i,r){if(i!=null&&typeof i!="object")throw Error(s(62));if(t=t.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var h in i)c=i[h],i.hasOwnProperty(h)&&r[h]!==c&&em(t,h,c)}else for(var p in i)i.hasOwnProperty(p)&&em(t,p,i[p])}function jc(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ek=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vo(t){return Ek.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Kn(){}var Uc=null;function Bc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ha=null,Ga=null;function nm(t){var i=Ba(t);if(i&&(t=i.stateNode)){var r=t[qt]||null;e:switch(t=i.stateNode,i.type){case"input":if(Lc(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),i=r.name,r.type==="radio"&&i!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+un(""+i)+'"][type="radio"]'),i=0;i<r.length;i++){var c=r[i];if(c!==t&&c.form===t.form){var h=c[qt]||null;if(!h)throw Error(s(90));Lc(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(i=0;i<r.length;i++)c=r[i],c.form===t.form&&Xf(c)}break e;case"textarea":Zf(t,r.value,r.defaultValue);break e;case"select":i=r.value,i!=null&&Fa(t,!!r.multiple,i,!1)}}}var zc=!1;function im(t,i,r){if(zc)return t(i,r);zc=!0;try{var c=t(i);return c}finally{if(zc=!1,(Ha!==null||Ga!==null)&&(al(),Ha&&(i=Ha,t=Ga,Ga=Ha=null,nm(i),t)))for(i=0;i<t.length;i++)nm(t[i])}}function Ys(t,i){var r=t.stateNode;if(r===null)return null;var c=r[qt]||null;if(c===null)return null;r=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(s(231,i,typeof r));return r}var Qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qc=!1;if(Qn)try{var Ks={};Object.defineProperty(Ks,"passive",{get:function(){qc=!0}}),window.addEventListener("test",Ks,Ks),window.removeEventListener("test",Ks,Ks)}catch{qc=!1}var Ri=null,Fc=null,yo=null;function am(){if(yo)return yo;var t,i=Fc,r=i.length,c,h="value"in Ri?Ri.value:Ri.textContent,p=h.length;for(t=0;t<r&&i[t]===h[t];t++);var y=r-t;for(c=1;c<=y&&i[r-c]===h[p-c];c++);return yo=h.slice(t,1<c?1-c:void 0)}function bo(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function So(){return!0}function sm(){return!1}function Ft(t){function i(r,c,h,p,y){this._reactName=r,this._targetInst=h,this.type=c,this.nativeEvent=p,this.target=y,this.currentTarget=null;for(var k in t)t.hasOwnProperty(k)&&(r=t[k],this[k]=r?r(p):p[k]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?So:sm,this.isPropagationStopped=sm,this}return v(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=So)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=So)},persist:function(){},isPersistent:So}),i}var fa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ko=Ft(fa),Qs=v({},fa,{view:0,detail:0}),wk=Ft(Qs),Vc,Hc,Js,To=v({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Js&&(Js&&t.type==="mousemove"?(Vc=t.screenX-Js.screenX,Hc=t.screenY-Js.screenY):Hc=Vc=0,Js=t),Vc)},movementY:function(t){return"movementY"in t?t.movementY:Hc}}),rm=Ft(To),_k=v({},To,{dataTransfer:0}),Rk=Ft(_k),Ak=v({},Qs,{relatedTarget:0}),Gc=Ft(Ak),Mk=v({},fa,{animationName:0,elapsedTime:0,pseudoElement:0}),Nk=Ft(Mk),Ok=v({},fa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Dk=Ft(Ok),Pk=v({},fa,{data:0}),om=Ft(Pk),Lk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ik={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uk(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=jk[t])?!!i[t]:!1}function Yc(){return Uk}var Bk=v({},Qs,{key:function(t){if(t.key){var i=Lk[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=bo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ik[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yc,charCode:function(t){return t.type==="keypress"?bo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),zk=Ft(Bk),qk=v({},To,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lm=Ft(qk),Fk=v({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yc}),Vk=Ft(Fk),Hk=v({},fa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gk=Ft(Hk),Yk=v({},To,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Kk=Ft(Yk),Qk=v({},fa,{newState:0,oldState:0}),Jk=Ft(Qk),Xk=[9,13,27,32],Kc=Qn&&"CompositionEvent"in window,Xs=null;Qn&&"documentMode"in document&&(Xs=document.documentMode);var Wk=Qn&&"TextEvent"in window&&!Xs,cm=Qn&&(!Kc||Xs&&8<Xs&&11>=Xs),um=" ",dm=!1;function hm(t,i){switch(t){case"keyup":return Xk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ya=!1;function Zk(t,i){switch(t){case"compositionend":return fm(i);case"keypress":return i.which!==32?null:(dm=!0,um);case"textInput":return t=i.data,t===um&&dm?null:t;default:return null}}function $k(t,i){if(Ya)return t==="compositionend"||!Kc&&hm(t,i)?(t=am(),yo=Fc=Ri=null,Ya=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return cm&&i.locale!=="ko"?null:i.data;default:return null}}var eT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mm(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!eT[t.type]:i==="textarea"}function pm(t,i,r,c){Ha?Ga?Ga.push(c):Ga=[c]:Ha=c,i=dl(i,"onChange"),0<i.length&&(r=new ko("onChange","change",null,r,c),t.push({event:r,listeners:i}))}var Ws=null,Zs=null;function tT(t){Wg(t,0)}function Co(t){var i=Gs(t);if(Xf(i))return t}function gm(t,i){if(t==="change")return i}var vm=!1;if(Qn){var Qc;if(Qn){var Jc="oninput"in document;if(!Jc){var ym=document.createElement("div");ym.setAttribute("oninput","return;"),Jc=typeof ym.oninput=="function"}Qc=Jc}else Qc=!1;vm=Qc&&(!document.documentMode||9<document.documentMode)}function bm(){Ws&&(Ws.detachEvent("onpropertychange",Sm),Zs=Ws=null)}function Sm(t){if(t.propertyName==="value"&&Co(Zs)){var i=[];pm(i,Zs,t,Bc(t)),im(tT,i)}}function nT(t,i,r){t==="focusin"?(bm(),Ws=i,Zs=r,Ws.attachEvent("onpropertychange",Sm)):t==="focusout"&&bm()}function iT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Co(Zs)}function aT(t,i){if(t==="click")return Co(i)}function sT(t,i){if(t==="input"||t==="change")return Co(i)}function rT(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var en=typeof Object.is=="function"?Object.is:rT;function $s(t,i){if(en(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var r=Object.keys(t),c=Object.keys(i);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var h=r[c];if(!wc.call(i,h)||!en(t[h],i[h]))return!1}return!0}function km(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Tm(t,i){var r=km(t);t=0;for(var c;r;){if(r.nodeType===3){if(c=t+r.textContent.length,t<=i&&c>=i)return{node:r,offset:i-t};t=c}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=km(r)}}function Cm(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?Cm(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function xm(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var i=go(t.document);i instanceof t.HTMLIFrameElement;){try{var r=typeof i.contentWindow.location.href=="string"}catch{r=!1}if(r)t=i.contentWindow;else break;i=go(t.document)}return i}function Xc(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}var oT=Qn&&"documentMode"in document&&11>=document.documentMode,Ka=null,Wc=null,er=null,Zc=!1;function Em(t,i,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Zc||Ka==null||Ka!==go(c)||(c=Ka,"selectionStart"in c&&Xc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),er&&$s(er,c)||(er=c,c=dl(Wc,"onSelect"),0<c.length&&(i=new ko("onSelect","select",null,i,r),t.push({event:i,listeners:c}),i.target=Ka)))}function ma(t,i){var r={};return r[t.toLowerCase()]=i.toLowerCase(),r["Webkit"+t]="webkit"+i,r["Moz"+t]="moz"+i,r}var Qa={animationend:ma("Animation","AnimationEnd"),animationiteration:ma("Animation","AnimationIteration"),animationstart:ma("Animation","AnimationStart"),transitionrun:ma("Transition","TransitionRun"),transitionstart:ma("Transition","TransitionStart"),transitioncancel:ma("Transition","TransitionCancel"),transitionend:ma("Transition","TransitionEnd")},$c={},wm={};Qn&&(wm=document.createElement("div").style,"AnimationEvent"in window||(delete Qa.animationend.animation,delete Qa.animationiteration.animation,delete Qa.animationstart.animation),"TransitionEvent"in window||delete Qa.transitionend.transition);function pa(t){if($c[t])return $c[t];if(!Qa[t])return t;var i=Qa[t],r;for(r in i)if(i.hasOwnProperty(r)&&r in wm)return $c[t]=i[r];return t}var _m=pa("animationend"),Rm=pa("animationiteration"),Am=pa("animationstart"),lT=pa("transitionrun"),cT=pa("transitionstart"),uT=pa("transitioncancel"),Mm=pa("transitionend"),Nm=new Map,eu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");eu.push("scrollEnd");function Cn(t,i){Nm.set(t,i),ha(i,[t])}var xo=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},dn=[],Ja=0,tu=0;function Eo(){for(var t=Ja,i=tu=Ja=0;i<t;){var r=dn[i];dn[i++]=null;var c=dn[i];dn[i++]=null;var h=dn[i];dn[i++]=null;var p=dn[i];if(dn[i++]=null,c!==null&&h!==null){var y=c.pending;y===null?h.next=h:(h.next=y.next,y.next=h),c.pending=h}p!==0&&Om(r,h,p)}}function wo(t,i,r,c){dn[Ja++]=t,dn[Ja++]=i,dn[Ja++]=r,dn[Ja++]=c,tu|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function nu(t,i,r,c){return wo(t,i,r,c),_o(t)}function ga(t,i){return wo(t,null,null,i),_o(t)}function Om(t,i,r){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r);for(var h=!1,p=t.return;p!==null;)p.childLanes|=r,c=p.alternate,c!==null&&(c.childLanes|=r),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(h=!0)),t=p,p=p.return;return t.tag===3?(p=t.stateNode,h&&i!==null&&(h=31-$t(r),t=p.hiddenUpdates,c=t[h],c===null?t[h]=[i]:c.push(i),i.lane=r|536870912),p):null}function _o(t){if(50<Tr)throw Tr=0,dd=null,Error(s(185));for(var i=t.return;i!==null;)t=i,i=t.return;return t.tag===3?t.stateNode:null}var Xa={};function dT(t,i,r,c){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(t,i,r,c){return new dT(t,i,r,c)}function iu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Jn(t,i){var r=t.alternate;return r===null?(r=tn(t.tag,i,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=i,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&65011712,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,i=t.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function Dm(t,i){t.flags&=65011714;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=i,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,i=r.dependencies,t.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t}function Ro(t,i,r,c,h,p){var y=0;if(c=t,typeof t=="function")iu(t)&&(y=1);else if(typeof t=="string")y=gC(t,r,le.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case J:return t=tn(31,r,i,h),t.elementType=J,t.lanes=p,t;case E:return va(r.children,h,p,i);case D:y=8,h|=24;break;case M:return t=tn(12,r,i,h|2),t.elementType=M,t.lanes=p,t;case N:return t=tn(13,r,i,h),t.elementType=N,t.lanes=p,t;case V:return t=tn(19,r,i,h),t.elementType=V,t.lanes=p,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case P:y=10;break e;case Y:y=9;break e;case A:y=11;break e;case X:y=14;break e;case z:y=16,c=null;break e}y=29,r=Error(s(130,t===null?"null":typeof t,"")),c=null}return i=tn(y,r,i,h),i.elementType=t,i.type=c,i.lanes=p,i}function va(t,i,r,c){return t=tn(7,t,c,i),t.lanes=r,t}function au(t,i,r){return t=tn(6,t,null,i),t.lanes=r,t}function Pm(t){var i=tn(18,null,null,0);return i.stateNode=t,i}function su(t,i,r){return i=tn(4,t.children!==null?t.children:[],t.key,i),i.lanes=r,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}var Lm=new WeakMap;function hn(t,i){if(typeof t=="object"&&t!==null){var r=Lm.get(t);return r!==void 0?r:(i={value:t,source:i,stack:Pf(i)},Lm.set(t,i),i)}return{value:t,source:i,stack:Pf(i)}}var Wa=[],Za=0,Ao=null,tr=0,fn=[],mn=0,Ai=null,Ln=1,In="";function Xn(t,i){Wa[Za++]=tr,Wa[Za++]=Ao,Ao=t,tr=i}function Im(t,i,r){fn[mn++]=Ln,fn[mn++]=In,fn[mn++]=Ai,Ai=t;var c=Ln;t=In;var h=32-$t(c)-1;c&=~(1<<h),r+=1;var p=32-$t(i)+h;if(30<p){var y=h-h%5;p=(c&(1<<y)-1).toString(32),c>>=y,h-=y,Ln=1<<32-$t(i)+h|r<<h|c,In=p+t}else Ln=1<<p|r<<h|c,In=t}function ru(t){t.return!==null&&(Xn(t,1),Im(t,1,0))}function ou(t){for(;t===Ao;)Ao=Wa[--Za],Wa[Za]=null,tr=Wa[--Za],Wa[Za]=null;for(;t===Ai;)Ai=fn[--mn],fn[mn]=null,In=fn[--mn],fn[mn]=null,Ln=fn[--mn],fn[mn]=null}function jm(t,i){fn[mn++]=Ln,fn[mn++]=In,fn[mn++]=Ai,Ln=i.id,In=i.overflow,Ai=t}var At=null,et=null,Pe=!1,Mi=null,pn=!1,lu=Error(s(519));function Ni(t){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nr(hn(i,t)),lu}function Um(t){var i=t.stateNode,r=t.type,c=t.memoizedProps;switch(i[Rt]=t,i[qt]=c,r){case"dialog":we("cancel",i),we("close",i);break;case"iframe":case"object":case"embed":we("load",i);break;case"video":case"audio":for(r=0;r<xr.length;r++)we(xr[r],i);break;case"source":we("error",i);break;case"img":case"image":case"link":we("error",i),we("load",i);break;case"details":we("toggle",i);break;case"input":we("invalid",i),Wf(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":we("invalid",i);break;case"textarea":we("invalid",i),$f(i,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||i.textContent===""+r||c.suppressHydrationWarning===!0||tv(i.textContent,r)?(c.popover!=null&&(we("beforetoggle",i),we("toggle",i)),c.onScroll!=null&&we("scroll",i),c.onScrollEnd!=null&&we("scrollend",i),c.onClick!=null&&(i.onclick=Kn),i=!0):i=!1,i||Ni(t,!0)}function Bm(t){for(At=t.return;At;)switch(At.tag){case 5:case 31:case 13:pn=!1;return;case 27:case 3:pn=!0;return;default:At=At.return}}function $a(t){if(t!==At)return!1;if(!Pe)return Bm(t),Pe=!0,!1;var i=t.tag,r;if((r=i!==3&&i!==27)&&((r=i===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||wd(t.type,t.memoizedProps)),r=!r),r&&et&&Ni(t),Bm(t),i===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));et=uv(t)}else if(i===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));et=uv(t)}else i===27?(i=et,Gi(t.type)?(t=Nd,Nd=null,et=t):et=i):et=At?vn(t.stateNode.nextSibling):null;return!0}function ya(){et=At=null,Pe=!1}function cu(){var t=Mi;return t!==null&&(Yt===null?Yt=t:Yt.push.apply(Yt,t),Mi=null),t}function nr(t){Mi===null?Mi=[t]:Mi.push(t)}var uu=R(null),ba=null,Wn=null;function Oi(t,i,r){ne(uu,i._currentValue),i._currentValue=r}function Zn(t){t._currentValue=uu.current,K(uu)}function du(t,i,r){for(;t!==null;){var c=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),t===r)break;t=t.return}}function hu(t,i,r,c){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var p=h.dependencies;if(p!==null){var y=h.child;p=p.firstContext;e:for(;p!==null;){var k=p;p=h;for(var w=0;w<i.length;w++)if(k.context===i[w]){p.lanes|=r,k=p.alternate,k!==null&&(k.lanes|=r),du(p.return,r,t),c||(y=null);break e}p=k.next}}else if(h.tag===18){if(y=h.return,y===null)throw Error(s(341));y.lanes|=r,p=y.alternate,p!==null&&(p.lanes|=r),du(y,r,t),y=null}else y=h.child;if(y!==null)y.return=h;else for(y=h;y!==null;){if(y===t){y=null;break}if(h=y.sibling,h!==null){h.return=y.return,y=h;break}y=y.return}h=y}}function es(t,i,r,c){t=null;for(var h=i,p=!1;h!==null;){if(!p){if((h.flags&524288)!==0)p=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var y=h.alternate;if(y===null)throw Error(s(387));if(y=y.memoizedProps,y!==null){var k=h.type;en(h.pendingProps.value,y.value)||(t!==null?t.push(k):t=[k])}}else if(h===ve.current){if(y=h.alternate,y===null)throw Error(s(387));y.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(Ar):t=[Ar])}h=h.return}t!==null&&hu(i,t,r,c),i.flags|=262144}function Mo(t){for(t=t.firstContext;t!==null;){if(!en(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Sa(t){ba=t,Wn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Mt(t){return zm(ba,t)}function No(t,i){return ba===null&&Sa(t),zm(t,i)}function zm(t,i){var r=i._currentValue;if(i={context:i,memoizedValue:r,next:null},Wn===null){if(t===null)throw Error(s(308));Wn=i,t.dependencies={lanes:0,firstContext:i},t.flags|=524288}else Wn=Wn.next=i;return r}var hT=typeof AbortController<"u"?AbortController:function(){var t=[],i=this.signal={aborted:!1,addEventListener:function(r,c){t.push(c)}};this.abort=function(){i.aborted=!0,t.forEach(function(r){return r()})}},fT=a.unstable_scheduleCallback,mT=a.unstable_NormalPriority,ft={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fu(){return{controller:new hT,data:new Map,refCount:0}}function ir(t){t.refCount--,t.refCount===0&&fT(mT,function(){t.controller.abort()})}var ar=null,mu=0,ts=0,ns=null;function pT(t,i){if(ar===null){var r=ar=[];mu=0,ts=vd(),ns={status:"pending",value:void 0,then:function(c){r.push(c)}}}return mu++,i.then(qm,qm),i}function qm(){if(--mu===0&&ar!==null){ns!==null&&(ns.status="fulfilled");var t=ar;ar=null,ts=0,ns=null;for(var i=0;i<t.length;i++)(0,t[i])()}}function gT(t,i){var r=[],c={status:"pending",value:null,reason:null,then:function(h){r.push(h)}};return t.then(function(){c.status="fulfilled",c.value=i;for(var h=0;h<r.length;h++)(0,r[h])(i)},function(h){for(c.status="rejected",c.reason=h,h=0;h<r.length;h++)(0,r[h])(void 0)}),c}var Fm=F.S;F.S=function(t,i){Eg=Wt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&pT(t,i),Fm!==null&&Fm(t,i)};var ka=R(null);function pu(){var t=ka.current;return t!==null?t:Xe.pooledCache}function Oo(t,i){i===null?ne(ka,ka.current):ne(ka,i.pool)}function Vm(){var t=pu();return t===null?null:{parent:ft._currentValue,pool:t}}var is=Error(s(460)),gu=Error(s(474)),Do=Error(s(542)),Po={then:function(){}};function Hm(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Gm(t,i,r){switch(r=t[r],r===void 0?t.push(i):r!==i&&(i.then(Kn,Kn),i=r),i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,Km(t),t;default:if(typeof i.status=="string")i.then(Kn,Kn);else{if(t=Xe,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=i,t.status="pending",t.then(function(c){if(i.status==="pending"){var h=i;h.status="fulfilled",h.value=c}},function(c){if(i.status==="pending"){var h=i;h.status="rejected",h.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw t=i.reason,Km(t),t}throw Ca=i,is}}function Ta(t){try{var i=t._init;return i(t._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(Ca=r,is):r}}var Ca=null;function Ym(){if(Ca===null)throw Error(s(459));var t=Ca;return Ca=null,t}function Km(t){if(t===is||t===Do)throw Error(s(483))}var as=null,sr=0;function Lo(t){var i=sr;return sr+=1,as===null&&(as=[]),Gm(as,t,i)}function rr(t,i){i=i.props.ref,t.ref=i!==void 0?i:null}function Io(t,i){throw i.$$typeof===S?Error(s(525)):(t=Object.prototype.toString.call(i),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t)))}function Qm(t){function i(O,_){if(t){var L=O.deletions;L===null?(O.deletions=[_],O.flags|=16):L.push(_)}}function r(O,_){if(!t)return null;for(;_!==null;)i(O,_),_=_.sibling;return null}function c(O){for(var _=new Map;O!==null;)O.key!==null?_.set(O.key,O):_.set(O.index,O),O=O.sibling;return _}function h(O,_){return O=Jn(O,_),O.index=0,O.sibling=null,O}function p(O,_,L){return O.index=L,t?(L=O.alternate,L!==null?(L=L.index,L<_?(O.flags|=67108866,_):L):(O.flags|=67108866,_)):(O.flags|=1048576,_)}function y(O){return t&&O.alternate===null&&(O.flags|=67108866),O}function k(O,_,L,Q){return _===null||_.tag!==6?(_=au(L,O.mode,Q),_.return=O,_):(_=h(_,L),_.return=O,_)}function w(O,_,L,Q){var me=L.type;return me===E?G(O,_,L.props.children,Q,L.key):_!==null&&(_.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===z&&Ta(me)===_.type)?(_=h(_,L.props),rr(_,L),_.return=O,_):(_=Ro(L.type,L.key,L.props,null,O.mode,Q),rr(_,L),_.return=O,_)}function I(O,_,L,Q){return _===null||_.tag!==4||_.stateNode.containerInfo!==L.containerInfo||_.stateNode.implementation!==L.implementation?(_=su(L,O.mode,Q),_.return=O,_):(_=h(_,L.children||[]),_.return=O,_)}function G(O,_,L,Q,me){return _===null||_.tag!==7?(_=va(L,O.mode,Q,me),_.return=O,_):(_=h(_,L),_.return=O,_)}function W(O,_,L){if(typeof _=="string"&&_!==""||typeof _=="number"||typeof _=="bigint")return _=au(""+_,O.mode,L),_.return=O,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case T:return L=Ro(_.type,_.key,_.props,null,O.mode,L),rr(L,_),L.return=O,L;case x:return _=su(_,O.mode,L),_.return=O,_;case z:return _=Ta(_),W(O,_,L)}if(Je(_)||fe(_))return _=va(_,O.mode,L,null),_.return=O,_;if(typeof _.then=="function")return W(O,Lo(_),L);if(_.$$typeof===P)return W(O,No(O,_),L);Io(O,_)}return null}function U(O,_,L,Q){var me=_!==null?_.key:null;if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return me!==null?null:k(O,_,""+L,Q);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case T:return L.key===me?w(O,_,L,Q):null;case x:return L.key===me?I(O,_,L,Q):null;case z:return L=Ta(L),U(O,_,L,Q)}if(Je(L)||fe(L))return me!==null?null:G(O,_,L,Q,null);if(typeof L.then=="function")return U(O,_,Lo(L),Q);if(L.$$typeof===P)return U(O,_,No(O,L),Q);Io(O,L)}return null}function q(O,_,L,Q,me){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return O=O.get(L)||null,k(_,O,""+Q,me);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case T:return O=O.get(Q.key===null?L:Q.key)||null,w(_,O,Q,me);case x:return O=O.get(Q.key===null?L:Q.key)||null,I(_,O,Q,me);case z:return Q=Ta(Q),q(O,_,L,Q,me)}if(Je(Q)||fe(Q))return O=O.get(L)||null,G(_,O,Q,me,null);if(typeof Q.then=="function")return q(O,_,L,Lo(Q),me);if(Q.$$typeof===P)return q(O,_,L,No(_,Q),me);Io(_,Q)}return null}function ce(O,_,L,Q){for(var me=null,Ie=null,he=_,Te=_=0,Ne=null;he!==null&&Te<L.length;Te++){he.index>Te?(Ne=he,he=null):Ne=he.sibling;var je=U(O,he,L[Te],Q);if(je===null){he===null&&(he=Ne);break}t&&he&&je.alternate===null&&i(O,he),_=p(je,_,Te),Ie===null?me=je:Ie.sibling=je,Ie=je,he=Ne}if(Te===L.length)return r(O,he),Pe&&Xn(O,Te),me;if(he===null){for(;Te<L.length;Te++)he=W(O,L[Te],Q),he!==null&&(_=p(he,_,Te),Ie===null?me=he:Ie.sibling=he,Ie=he);return Pe&&Xn(O,Te),me}for(he=c(he);Te<L.length;Te++)Ne=q(he,O,Te,L[Te],Q),Ne!==null&&(t&&Ne.alternate!==null&&he.delete(Ne.key===null?Te:Ne.key),_=p(Ne,_,Te),Ie===null?me=Ne:Ie.sibling=Ne,Ie=Ne);return t&&he.forEach(function(Xi){return i(O,Xi)}),Pe&&Xn(O,Te),me}function pe(O,_,L,Q){if(L==null)throw Error(s(151));for(var me=null,Ie=null,he=_,Te=_=0,Ne=null,je=L.next();he!==null&&!je.done;Te++,je=L.next()){he.index>Te?(Ne=he,he=null):Ne=he.sibling;var Xi=U(O,he,je.value,Q);if(Xi===null){he===null&&(he=Ne);break}t&&he&&Xi.alternate===null&&i(O,he),_=p(Xi,_,Te),Ie===null?me=Xi:Ie.sibling=Xi,Ie=Xi,he=Ne}if(je.done)return r(O,he),Pe&&Xn(O,Te),me;if(he===null){for(;!je.done;Te++,je=L.next())je=W(O,je.value,Q),je!==null&&(_=p(je,_,Te),Ie===null?me=je:Ie.sibling=je,Ie=je);return Pe&&Xn(O,Te),me}for(he=c(he);!je.done;Te++,je=L.next())je=q(he,O,Te,je.value,Q),je!==null&&(t&&je.alternate!==null&&he.delete(je.key===null?Te:je.key),_=p(je,_,Te),Ie===null?me=je:Ie.sibling=je,Ie=je);return t&&he.forEach(function(_C){return i(O,_C)}),Pe&&Xn(O,Te),me}function Ye(O,_,L,Q){if(typeof L=="object"&&L!==null&&L.type===E&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case T:e:{for(var me=L.key;_!==null;){if(_.key===me){if(me=L.type,me===E){if(_.tag===7){r(O,_.sibling),Q=h(_,L.props.children),Q.return=O,O=Q;break e}}else if(_.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===z&&Ta(me)===_.type){r(O,_.sibling),Q=h(_,L.props),rr(Q,L),Q.return=O,O=Q;break e}r(O,_);break}else i(O,_);_=_.sibling}L.type===E?(Q=va(L.props.children,O.mode,Q,L.key),Q.return=O,O=Q):(Q=Ro(L.type,L.key,L.props,null,O.mode,Q),rr(Q,L),Q.return=O,O=Q)}return y(O);case x:e:{for(me=L.key;_!==null;){if(_.key===me)if(_.tag===4&&_.stateNode.containerInfo===L.containerInfo&&_.stateNode.implementation===L.implementation){r(O,_.sibling),Q=h(_,L.children||[]),Q.return=O,O=Q;break e}else{r(O,_);break}else i(O,_);_=_.sibling}Q=su(L,O.mode,Q),Q.return=O,O=Q}return y(O);case z:return L=Ta(L),Ye(O,_,L,Q)}if(Je(L))return ce(O,_,L,Q);if(fe(L)){if(me=fe(L),typeof me!="function")throw Error(s(150));return L=me.call(L),pe(O,_,L,Q)}if(typeof L.then=="function")return Ye(O,_,Lo(L),Q);if(L.$$typeof===P)return Ye(O,_,No(O,L),Q);Io(O,L)}return typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint"?(L=""+L,_!==null&&_.tag===6?(r(O,_.sibling),Q=h(_,L),Q.return=O,O=Q):(r(O,_),Q=au(L,O.mode,Q),Q.return=O,O=Q),y(O)):r(O,_)}return function(O,_,L,Q){try{sr=0;var me=Ye(O,_,L,Q);return as=null,me}catch(he){if(he===is||he===Do)throw he;var Ie=tn(29,he,null,O.mode);return Ie.lanes=Q,Ie.return=O,Ie}finally{}}}var xa=Qm(!0),Jm=Qm(!1),Di=!1;function vu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yu(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Pi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Li(t,i,r){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Be&2)!==0){var h=c.pending;return h===null?i.next=i:(i.next=h.next,h.next=i),c.pending=i,i=_o(t),Om(t,null,r),i}return wo(t,c,i,r),_o(t)}function or(t,i,r){if(i=i.updateQueue,i!==null&&(i=i.shared,(r&4194048)!==0)){var c=i.lanes;c&=t.pendingLanes,r|=c,i.lanes=r,zf(t,r)}}function bu(t,i){var r=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var h=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var y={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?h=p=y:p=p.next=y,r=r.next}while(r!==null);p===null?h=p=i:p=p.next=i}else h=p=i;r={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=i:t.next=i,r.lastBaseUpdate=i}var Su=!1;function lr(){if(Su){var t=ns;if(t!==null)throw t}}function cr(t,i,r,c){Su=!1;var h=t.updateQueue;Di=!1;var p=h.firstBaseUpdate,y=h.lastBaseUpdate,k=h.shared.pending;if(k!==null){h.shared.pending=null;var w=k,I=w.next;w.next=null,y===null?p=I:y.next=I,y=w;var G=t.alternate;G!==null&&(G=G.updateQueue,k=G.lastBaseUpdate,k!==y&&(k===null?G.firstBaseUpdate=I:k.next=I,G.lastBaseUpdate=w))}if(p!==null){var W=h.baseState;y=0,G=I=w=null,k=p;do{var U=k.lane&-536870913,q=U!==k.lane;if(q?(Me&U)===U:(c&U)===U){U!==0&&U===ts&&(Su=!0),G!==null&&(G=G.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var ce=t,pe=k;U=i;var Ye=r;switch(pe.tag){case 1:if(ce=pe.payload,typeof ce=="function"){W=ce.call(Ye,W,U);break e}W=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=pe.payload,U=typeof ce=="function"?ce.call(Ye,W,U):ce,U==null)break e;W=v({},W,U);break e;case 2:Di=!0}}U=k.callback,U!==null&&(t.flags|=64,q&&(t.flags|=8192),q=h.callbacks,q===null?h.callbacks=[U]:q.push(U))}else q={lane:U,tag:k.tag,payload:k.payload,callback:k.callback,next:null},G===null?(I=G=q,w=W):G=G.next=q,y|=U;if(k=k.next,k===null){if(k=h.shared.pending,k===null)break;q=k,k=q.next,q.next=null,h.lastBaseUpdate=q,h.shared.pending=null}}while(!0);G===null&&(w=W),h.baseState=w,h.firstBaseUpdate=I,h.lastBaseUpdate=G,p===null&&(h.shared.lanes=0),zi|=y,t.lanes=y,t.memoizedState=W}}function Xm(t,i){if(typeof t!="function")throw Error(s(191,t));t.call(i)}function Wm(t,i){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)Xm(r[t],i)}var ss=R(null),jo=R(0);function Zm(t,i){t=oi,ne(jo,t),ne(ss,i),oi=t|i.baseLanes}function ku(){ne(jo,oi),ne(ss,ss.current)}function Tu(){oi=jo.current,K(ss),K(jo)}var nn=R(null),gn=null;function Ii(t){var i=t.alternate;ne(ut,ut.current&1),ne(nn,t),gn===null&&(i===null||ss.current!==null||i.memoizedState!==null)&&(gn=t)}function Cu(t){ne(ut,ut.current),ne(nn,t),gn===null&&(gn=t)}function $m(t){t.tag===22?(ne(ut,ut.current),ne(nn,t),gn===null&&(gn=t)):ji()}function ji(){ne(ut,ut.current),ne(nn,nn.current)}function an(t){K(nn),gn===t&&(gn=null),K(ut)}var ut=R(0);function Uo(t){for(var i=t;i!==null;){if(i.tag===13){var r=i.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Ad(r)||Md(r)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var $n=0,ke=null,He=null,mt=null,Bo=!1,rs=!1,Ea=!1,zo=0,ur=0,os=null,vT=0;function st(){throw Error(s(321))}function xu(t,i){if(i===null)return!1;for(var r=0;r<i.length&&r<t.length;r++)if(!en(t[r],i[r]))return!1;return!0}function Eu(t,i,r,c,h,p){return $n=p,ke=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,F.H=t===null||t.memoizedState===null?Ip:zu,Ea=!1,p=r(c,h),Ea=!1,rs&&(p=tp(i,r,c,h)),ep(t),p}function ep(t){F.H=fr;var i=He!==null&&He.next!==null;if($n=0,mt=He=ke=null,Bo=!1,ur=0,os=null,i)throw Error(s(300));t===null||pt||(t=t.dependencies,t!==null&&Mo(t)&&(pt=!0))}function tp(t,i,r,c){ke=t;var h=0;do{if(rs&&(os=null),ur=0,rs=!1,25<=h)throw Error(s(301));if(h+=1,mt=He=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}F.H=jp,p=i(r,c)}while(rs);return p}function yT(){var t=F.H,i=t.useState()[0];return i=typeof i.then=="function"?dr(i):i,t=t.useState()[0],(He!==null?He.memoizedState:null)!==t&&(ke.flags|=1024),i}function wu(){var t=zo!==0;return zo=0,t}function _u(t,i,r){i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~r}function Ru(t){if(Bo){for(t=t.memoizedState;t!==null;){var i=t.queue;i!==null&&(i.pending=null),t=t.next}Bo=!1}$n=0,mt=He=ke=null,rs=!1,ur=zo=0,os=null}function It(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?ke.memoizedState=mt=t:mt=mt.next=t,mt}function dt(){if(He===null){var t=ke.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var i=mt===null?ke.memoizedState:mt.next;if(i!==null)mt=i,He=t;else{if(t===null)throw ke.alternate===null?Error(s(467)):Error(s(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},mt===null?ke.memoizedState=mt=t:mt=mt.next=t}return mt}function qo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dr(t){var i=ur;return ur+=1,os===null&&(os=[]),t=Gm(os,t,i),i=ke,(mt===null?i.memoizedState:mt.next)===null&&(i=i.alternate,F.H=i===null||i.memoizedState===null?Ip:zu),t}function Fo(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return dr(t);if(t.$$typeof===P)return Mt(t)}throw Error(s(438,String(t)))}function Au(t){var i=null,r=ke.updateQueue;if(r!==null&&(i=r.memoCache),i==null){var c=ke.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(h){return h.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),r===null&&(r=qo(),ke.updateQueue=r),r.memoCache=i,r=i.data[i.index],r===void 0)for(r=i.data[i.index]=Array(t),c=0;c<t;c++)r[c]=H;return i.index++,r}function ei(t,i){return typeof i=="function"?i(t):i}function Vo(t){var i=dt();return Mu(i,He,t)}function Mu(t,i,r){var c=t.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var h=t.baseQueue,p=c.pending;if(p!==null){if(h!==null){var y=h.next;h.next=p.next,p.next=y}i.baseQueue=h=p,c.pending=null}if(p=t.baseState,h===null)t.memoizedState=p;else{i=h.next;var k=y=null,w=null,I=i,G=!1;do{var W=I.lane&-536870913;if(W!==I.lane?(Me&W)===W:($n&W)===W){var U=I.revertLane;if(U===0)w!==null&&(w=w.next={lane:0,revertLane:0,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),W===ts&&(G=!0);else if(($n&U)===U){I=I.next,U===ts&&(G=!0);continue}else W={lane:0,revertLane:I.revertLane,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},w===null?(k=w=W,y=p):w=w.next=W,ke.lanes|=U,zi|=U;W=I.action,Ea&&r(p,W),p=I.hasEagerState?I.eagerState:r(p,W)}else U={lane:W,revertLane:I.revertLane,gesture:I.gesture,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},w===null?(k=w=U,y=p):w=w.next=U,ke.lanes|=W,zi|=W;I=I.next}while(I!==null&&I!==i);if(w===null?y=p:w.next=k,!en(p,t.memoizedState)&&(pt=!0,G&&(r=ns,r!==null)))throw r;t.memoizedState=p,t.baseState=y,t.baseQueue=w,c.lastRenderedState=p}return h===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Nu(t){var i=dt(),r=i.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=t;var c=r.dispatch,h=r.pending,p=i.memoizedState;if(h!==null){r.pending=null;var y=h=h.next;do p=t(p,y.action),y=y.next;while(y!==h);en(p,i.memoizedState)||(pt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),r.lastRenderedState=p}return[p,c]}function np(t,i,r){var c=ke,h=dt(),p=Pe;if(p){if(r===void 0)throw Error(s(407));r=r()}else r=i();var y=!en((He||h).memoizedState,r);if(y&&(h.memoizedState=r,pt=!0),h=h.queue,Pu(sp.bind(null,c,h,t),[t]),h.getSnapshot!==i||y||mt!==null&&mt.memoizedState.tag&1){if(c.flags|=2048,ls(9,{destroy:void 0},ap.bind(null,c,h,r,i),null),Xe===null)throw Error(s(349));p||($n&127)!==0||ip(c,i,r)}return r}function ip(t,i,r){t.flags|=16384,t={getSnapshot:i,value:r},i=ke.updateQueue,i===null?(i=qo(),ke.updateQueue=i,i.stores=[t]):(r=i.stores,r===null?i.stores=[t]:r.push(t))}function ap(t,i,r,c){i.value=r,i.getSnapshot=c,rp(i)&&op(t)}function sp(t,i,r){return r(function(){rp(i)&&op(t)})}function rp(t){var i=t.getSnapshot;t=t.value;try{var r=i();return!en(t,r)}catch{return!0}}function op(t){var i=ga(t,2);i!==null&&Kt(i,t,2)}function Ou(t){var i=It();if(typeof t=="function"){var r=t;if(t=r(),Ea){wi(!0);try{r()}finally{wi(!1)}}}return i.memoizedState=i.baseState=t,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:t},i}function lp(t,i,r,c){return t.baseState=r,Mu(t,He,typeof c=="function"?c:ei)}function bT(t,i,r,c,h){if(Yo(t))throw Error(s(485));if(t=i.action,t!==null){var p={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){p.listeners.push(y)}};F.T!==null?r(!0):p.isTransition=!1,c(p),r=i.pending,r===null?(p.next=i.pending=p,cp(i,p)):(p.next=r.next,i.pending=r.next=p)}}function cp(t,i){var r=i.action,c=i.payload,h=t.state;if(i.isTransition){var p=F.T,y={};F.T=y;try{var k=r(h,c),w=F.S;w!==null&&w(y,k),up(t,i,k)}catch(I){Du(t,i,I)}finally{p!==null&&y.types!==null&&(p.types=y.types),F.T=p}}else try{p=r(h,c),up(t,i,p)}catch(I){Du(t,i,I)}}function up(t,i,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){dp(t,i,c)},function(c){return Du(t,i,c)}):dp(t,i,r)}function dp(t,i,r){i.status="fulfilled",i.value=r,hp(i),t.state=r,i=t.pending,i!==null&&(r=i.next,r===i?t.pending=null:(r=r.next,i.next=r,cp(t,r)))}function Du(t,i,r){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=r,hp(i),i=i.next;while(i!==c)}t.action=null}function hp(t){t=t.listeners;for(var i=0;i<t.length;i++)(0,t[i])()}function fp(t,i){return i}function mp(t,i){if(Pe){var r=Xe.formState;if(r!==null){e:{var c=ke;if(Pe){if(et){t:{for(var h=et,p=pn;h.nodeType!==8;){if(!p){h=null;break t}if(h=vn(h.nextSibling),h===null){h=null;break t}}p=h.data,h=p==="F!"||p==="F"?h:null}if(h){et=vn(h.nextSibling),c=h.data==="F!";break e}}Ni(c)}c=!1}c&&(i=r[0])}}return r=It(),r.memoizedState=r.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fp,lastRenderedState:i},r.queue=c,r=Dp.bind(null,ke,c),c.dispatch=r,c=Ou(!1),p=Bu.bind(null,ke,!1,c.queue),c=It(),h={state:i,dispatch:null,action:t,pending:null},c.queue=h,r=bT.bind(null,ke,h,p,r),h.dispatch=r,c.memoizedState=t,[i,r,!1]}function pp(t){var i=dt();return gp(i,He,t)}function gp(t,i,r){if(i=Mu(t,i,fp)[0],t=Vo(ei)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=dr(i)}catch(y){throw y===is?Do:y}else c=i;i=dt();var h=i.queue,p=h.dispatch;return r!==i.memoizedState&&(ke.flags|=2048,ls(9,{destroy:void 0},ST.bind(null,h,r),null)),[c,p,t]}function ST(t,i){t.action=i}function vp(t){var i=dt(),r=He;if(r!==null)return gp(i,r,t);dt(),i=i.memoizedState,r=dt();var c=r.queue.dispatch;return r.memoizedState=t,[i,c,!1]}function ls(t,i,r,c){return t={tag:t,create:r,deps:c,inst:i,next:null},i=ke.updateQueue,i===null&&(i=qo(),ke.updateQueue=i),r=i.lastEffect,r===null?i.lastEffect=t.next=t:(c=r.next,r.next=t,t.next=c,i.lastEffect=t),t}function yp(){return dt().memoizedState}function Ho(t,i,r,c){var h=It();ke.flags|=t,h.memoizedState=ls(1|i,{destroy:void 0},r,c===void 0?null:c)}function Go(t,i,r,c){var h=dt();c=c===void 0?null:c;var p=h.memoizedState.inst;He!==null&&c!==null&&xu(c,He.memoizedState.deps)?h.memoizedState=ls(i,p,r,c):(ke.flags|=t,h.memoizedState=ls(1|i,p,r,c))}function bp(t,i){Ho(8390656,8,t,i)}function Pu(t,i){Go(2048,8,t,i)}function kT(t){ke.flags|=4;var i=ke.updateQueue;if(i===null)i=qo(),ke.updateQueue=i,i.events=[t];else{var r=i.events;r===null?i.events=[t]:r.push(t)}}function Sp(t){var i=dt().memoizedState;return kT({ref:i,nextImpl:t}),function(){if((Be&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function kp(t,i){return Go(4,2,t,i)}function Tp(t,i){return Go(4,4,t,i)}function Cp(t,i){if(typeof i=="function"){t=t();var r=i(t);return function(){typeof r=="function"?r():i(null)}}if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function xp(t,i,r){r=r!=null?r.concat([t]):null,Go(4,4,Cp.bind(null,i,t),r)}function Lu(){}function Ep(t,i){var r=dt();i=i===void 0?null:i;var c=r.memoizedState;return i!==null&&xu(i,c[1])?c[0]:(r.memoizedState=[t,i],t)}function wp(t,i){var r=dt();i=i===void 0?null:i;var c=r.memoizedState;if(i!==null&&xu(i,c[1]))return c[0];if(c=t(),Ea){wi(!0);try{t()}finally{wi(!1)}}return r.memoizedState=[c,i],c}function Iu(t,i,r){return r===void 0||($n&1073741824)!==0&&(Me&261930)===0?t.memoizedState=i:(t.memoizedState=r,t=_g(),ke.lanes|=t,zi|=t,r)}function _p(t,i,r,c){return en(r,i)?r:ss.current!==null?(t=Iu(t,r,c),en(t,i)||(pt=!0),t):($n&42)===0||($n&1073741824)!==0&&(Me&261930)===0?(pt=!0,t.memoizedState=r):(t=_g(),ke.lanes|=t,zi|=t,i)}function Rp(t,i,r,c,h){var p=ae.p;ae.p=p!==0&&8>p?p:8;var y=F.T,k={};F.T=k,Bu(t,!1,i,r);try{var w=h(),I=F.S;if(I!==null&&I(k,w),w!==null&&typeof w=="object"&&typeof w.then=="function"){var G=gT(w,c);hr(t,i,G,on(t))}else hr(t,i,c,on(t))}catch(W){hr(t,i,{then:function(){},status:"rejected",reason:W},on())}finally{ae.p=p,y!==null&&k.types!==null&&(y.types=k.types),F.T=y}}function TT(){}function ju(t,i,r,c){if(t.tag!==5)throw Error(s(476));var h=Ap(t).queue;Rp(t,h,i,ee,r===null?TT:function(){return Mp(t),r(c)})}function Ap(t){var i=t.memoizedState;if(i!==null)return i;i={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:ee},next:null};var r={};return i.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:r},next:null},t.memoizedState=i,t=t.alternate,t!==null&&(t.memoizedState=i),i}function Mp(t){var i=Ap(t);i.next===null&&(i=t.alternate.memoizedState),hr(t,i.next.queue,{},on())}function Uu(){return Mt(Ar)}function Np(){return dt().memoizedState}function Op(){return dt().memoizedState}function CT(t){for(var i=t.return;i!==null;){switch(i.tag){case 24:case 3:var r=on();t=Pi(r);var c=Li(i,t,r);c!==null&&(Kt(c,i,r),or(c,i,r)),i={cache:fu()},t.payload=i;return}i=i.return}}function xT(t,i,r){var c=on();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Yo(t)?Pp(i,r):(r=nu(t,i,r,c),r!==null&&(Kt(r,t,c),Lp(r,i,c)))}function Dp(t,i,r){var c=on();hr(t,i,r,c)}function hr(t,i,r,c){var h={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Yo(t))Pp(i,h);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var y=i.lastRenderedState,k=p(y,r);if(h.hasEagerState=!0,h.eagerState=k,en(k,y))return wo(t,i,h,0),Xe===null&&Eo(),!1}catch{}finally{}if(r=nu(t,i,h,c),r!==null)return Kt(r,t,c),Lp(r,i,c),!0}return!1}function Bu(t,i,r,c){if(c={lane:2,revertLane:vd(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Yo(t)){if(i)throw Error(s(479))}else i=nu(t,r,c,2),i!==null&&Kt(i,t,2)}function Yo(t){var i=t.alternate;return t===ke||i!==null&&i===ke}function Pp(t,i){rs=Bo=!0;var r=t.pending;r===null?i.next=i:(i.next=r.next,r.next=i),t.pending=i}function Lp(t,i,r){if((r&4194048)!==0){var c=i.lanes;c&=t.pendingLanes,r|=c,i.lanes=r,zf(t,r)}}var fr={readContext:Mt,use:Fo,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useLayoutEffect:st,useInsertionEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useSyncExternalStore:st,useId:st,useHostTransitionStatus:st,useFormState:st,useActionState:st,useOptimistic:st,useMemoCache:st,useCacheRefresh:st};fr.useEffectEvent=st;var Ip={readContext:Mt,use:Fo,useCallback:function(t,i){return It().memoizedState=[t,i===void 0?null:i],t},useContext:Mt,useEffect:bp,useImperativeHandle:function(t,i,r){r=r!=null?r.concat([t]):null,Ho(4194308,4,Cp.bind(null,i,t),r)},useLayoutEffect:function(t,i){return Ho(4194308,4,t,i)},useInsertionEffect:function(t,i){Ho(4,2,t,i)},useMemo:function(t,i){var r=It();i=i===void 0?null:i;var c=t();if(Ea){wi(!0);try{t()}finally{wi(!1)}}return r.memoizedState=[c,i],c},useReducer:function(t,i,r){var c=It();if(r!==void 0){var h=r(i);if(Ea){wi(!0);try{r(i)}finally{wi(!1)}}}else h=i;return c.memoizedState=c.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},c.queue=t,t=t.dispatch=xT.bind(null,ke,t),[c.memoizedState,t]},useRef:function(t){var i=It();return t={current:t},i.memoizedState=t},useState:function(t){t=Ou(t);var i=t.queue,r=Dp.bind(null,ke,i);return i.dispatch=r,[t.memoizedState,r]},useDebugValue:Lu,useDeferredValue:function(t,i){var r=It();return Iu(r,t,i)},useTransition:function(){var t=Ou(!1);return t=Rp.bind(null,ke,t.queue,!0,!1),It().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,i,r){var c=ke,h=It();if(Pe){if(r===void 0)throw Error(s(407));r=r()}else{if(r=i(),Xe===null)throw Error(s(349));(Me&127)!==0||ip(c,i,r)}h.memoizedState=r;var p={value:r,getSnapshot:i};return h.queue=p,bp(sp.bind(null,c,p,t),[t]),c.flags|=2048,ls(9,{destroy:void 0},ap.bind(null,c,p,r,i),null),r},useId:function(){var t=It(),i=Xe.identifierPrefix;if(Pe){var r=In,c=Ln;r=(c&~(1<<32-$t(c)-1)).toString(32)+r,i="_"+i+"R_"+r,r=zo++,0<r&&(i+="H"+r.toString(32)),i+="_"}else r=vT++,i="_"+i+"r_"+r.toString(32)+"_";return t.memoizedState=i},useHostTransitionStatus:Uu,useFormState:mp,useActionState:mp,useOptimistic:function(t){var i=It();i.memoizedState=i.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=r,i=Bu.bind(null,ke,!0,r),r.dispatch=i,[t,i]},useMemoCache:Au,useCacheRefresh:function(){return It().memoizedState=CT.bind(null,ke)},useEffectEvent:function(t){var i=It(),r={impl:t};return i.memoizedState=r,function(){if((Be&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},zu={readContext:Mt,use:Fo,useCallback:Ep,useContext:Mt,useEffect:Pu,useImperativeHandle:xp,useInsertionEffect:kp,useLayoutEffect:Tp,useMemo:wp,useReducer:Vo,useRef:yp,useState:function(){return Vo(ei)},useDebugValue:Lu,useDeferredValue:function(t,i){var r=dt();return _p(r,He.memoizedState,t,i)},useTransition:function(){var t=Vo(ei)[0],i=dt().memoizedState;return[typeof t=="boolean"?t:dr(t),i]},useSyncExternalStore:np,useId:Np,useHostTransitionStatus:Uu,useFormState:pp,useActionState:pp,useOptimistic:function(t,i){var r=dt();return lp(r,He,t,i)},useMemoCache:Au,useCacheRefresh:Op};zu.useEffectEvent=Sp;var jp={readContext:Mt,use:Fo,useCallback:Ep,useContext:Mt,useEffect:Pu,useImperativeHandle:xp,useInsertionEffect:kp,useLayoutEffect:Tp,useMemo:wp,useReducer:Nu,useRef:yp,useState:function(){return Nu(ei)},useDebugValue:Lu,useDeferredValue:function(t,i){var r=dt();return He===null?Iu(r,t,i):_p(r,He.memoizedState,t,i)},useTransition:function(){var t=Nu(ei)[0],i=dt().memoizedState;return[typeof t=="boolean"?t:dr(t),i]},useSyncExternalStore:np,useId:Np,useHostTransitionStatus:Uu,useFormState:vp,useActionState:vp,useOptimistic:function(t,i){var r=dt();return He!==null?lp(r,He,t,i):(r.baseState=t,[t,r.queue.dispatch])},useMemoCache:Au,useCacheRefresh:Op};jp.useEffectEvent=Sp;function qu(t,i,r,c){i=t.memoizedState,r=r(c,i),r=r==null?i:v({},i,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Fu={enqueueSetState:function(t,i,r){t=t._reactInternals;var c=on(),h=Pi(c);h.payload=i,r!=null&&(h.callback=r),i=Li(t,h,c),i!==null&&(Kt(i,t,c),or(i,t,c))},enqueueReplaceState:function(t,i,r){t=t._reactInternals;var c=on(),h=Pi(c);h.tag=1,h.payload=i,r!=null&&(h.callback=r),i=Li(t,h,c),i!==null&&(Kt(i,t,c),or(i,t,c))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var r=on(),c=Pi(r);c.tag=2,i!=null&&(c.callback=i),i=Li(t,c,r),i!==null&&(Kt(i,t,r),or(i,t,r))}};function Up(t,i,r,c,h,p,y){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,p,y):i.prototype&&i.prototype.isPureReactComponent?!$s(r,c)||!$s(h,p):!0}function Bp(t,i,r,c){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(r,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(r,c),i.state!==t&&Fu.enqueueReplaceState(i,i.state,null)}function wa(t,i){var r=i;if("ref"in i){r={};for(var c in i)c!=="ref"&&(r[c]=i[c])}if(t=t.defaultProps){r===i&&(r=v({},r));for(var h in t)r[h]===void 0&&(r[h]=t[h])}return r}function zp(t){xo(t)}function qp(t){console.error(t)}function Fp(t){xo(t)}function Ko(t,i){try{var r=t.onUncaughtError;r(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function Vp(t,i,r){try{var c=t.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Vu(t,i,r){return r=Pi(r),r.tag=3,r.payload={element:null},r.callback=function(){Ko(t,i)},r}function Hp(t){return t=Pi(t),t.tag=3,t}function Gp(t,i,r,c){var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=c.value;t.payload=function(){return h(p)},t.callback=function(){Vp(i,r,c)}}var y=r.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(t.callback=function(){Vp(i,r,c),typeof h!="function"&&(qi===null?qi=new Set([this]):qi.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function ET(t,i,r,c,h){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=r.alternate,i!==null&&es(i,r,h,!0),r=nn.current,r!==null){switch(r.tag){case 31:case 13:return gn===null?sl():r.alternate===null&&rt===0&&(rt=3),r.flags&=-257,r.flags|=65536,r.lanes=h,c===Po?r.flags|=16384:(i=r.updateQueue,i===null?r.updateQueue=new Set([c]):i.add(c),md(t,c,h)),!1;case 22:return r.flags|=65536,c===Po?r.flags|=16384:(i=r.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=i):(r=i.retryQueue,r===null?i.retryQueue=new Set([c]):r.add(c)),md(t,c,h)),!1}throw Error(s(435,r.tag))}return md(t,c,h),sl(),!1}if(Pe)return i=nn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=h,c!==lu&&(t=Error(s(422),{cause:c}),nr(hn(t,r)))):(c!==lu&&(i=Error(s(423),{cause:c}),nr(hn(i,r))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,c=hn(c,r),h=Vu(t.stateNode,c,h),bu(t,h),rt!==4&&(rt=2)),!1;var p=Error(s(520),{cause:c});if(p=hn(p,r),kr===null?kr=[p]:kr.push(p),rt!==4&&(rt=2),i===null)return!0;c=hn(c,r),r=i;do{switch(r.tag){case 3:return r.flags|=65536,t=h&-h,r.lanes|=t,t=Vu(r.stateNode,c,t),bu(r,t),!1;case 1:if(i=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(qi===null||!qi.has(p))))return r.flags|=65536,h&=-h,r.lanes|=h,h=Hp(h),Gp(h,t,r,c),bu(r,h),!1}r=r.return}while(r!==null);return!1}var Hu=Error(s(461)),pt=!1;function Nt(t,i,r,c){i.child=t===null?Jm(i,null,r,c):xa(i,t.child,r,c)}function Yp(t,i,r,c,h){r=r.render;var p=i.ref;if("ref"in c){var y={};for(var k in c)k!=="ref"&&(y[k]=c[k])}else y=c;return Sa(i),c=Eu(t,i,r,y,p,h),k=wu(),t!==null&&!pt?(_u(t,i,h),ti(t,i,h)):(Pe&&k&&ru(i),i.flags|=1,Nt(t,i,c,h),i.child)}function Kp(t,i,r,c,h){if(t===null){var p=r.type;return typeof p=="function"&&!iu(p)&&p.defaultProps===void 0&&r.compare===null?(i.tag=15,i.type=p,Qp(t,i,p,c,h)):(t=Ro(r.type,null,c,i,i.mode,h),t.ref=i.ref,t.return=i,i.child=t)}if(p=t.child,!Zu(t,h)){var y=p.memoizedProps;if(r=r.compare,r=r!==null?r:$s,r(y,c)&&t.ref===i.ref)return ti(t,i,h)}return i.flags|=1,t=Jn(p,c),t.ref=i.ref,t.return=i,i.child=t}function Qp(t,i,r,c,h){if(t!==null){var p=t.memoizedProps;if($s(p,c)&&t.ref===i.ref)if(pt=!1,i.pendingProps=c=p,Zu(t,h))(t.flags&131072)!==0&&(pt=!0);else return i.lanes=t.lanes,ti(t,i,h)}return Gu(t,i,r,c,h)}function Jp(t,i,r,c){var h=c.children,p=t!==null?t.memoizedState:null;if(t===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|r:r,t!==null){for(c=i.child=t.child,h=0;c!==null;)h=h|c.lanes|c.childLanes,c=c.sibling;c=h&~p}else c=0,i.child=null;return Xp(t,i,p,r,c)}if((r&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},t!==null&&Oo(i,p!==null?p.cachePool:null),p!==null?Zm(i,p):ku(),$m(i);else return c=i.lanes=536870912,Xp(t,i,p!==null?p.baseLanes|r:r,r,c)}else p!==null?(Oo(i,p.cachePool),Zm(i,p),ji(),i.memoizedState=null):(t!==null&&Oo(i,null),ku(),ji());return Nt(t,i,h,r),i.child}function mr(t,i){return t!==null&&t.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Xp(t,i,r,c,h){var p=pu();return p=p===null?null:{parent:ft._currentValue,pool:p},i.memoizedState={baseLanes:r,cachePool:p},t!==null&&Oo(i,null),ku(),$m(i),t!==null&&es(t,i,c,!0),i.childLanes=h,null}function Qo(t,i){return i=Xo({mode:i.mode,children:i.children},t.mode),i.ref=t.ref,t.child=i,i.return=t,i}function Wp(t,i,r){return xa(i,t.child,null,r),t=Qo(i,i.pendingProps),t.flags|=2,an(i),i.memoizedState=null,t}function wT(t,i,r){var c=i.pendingProps,h=(i.flags&128)!==0;if(i.flags&=-129,t===null){if(Pe){if(c.mode==="hidden")return t=Qo(i,c),i.lanes=536870912,mr(null,t);if(Cu(i),(t=et)?(t=cv(t,pn),t=t!==null&&t.data==="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:Ai!==null?{id:Ln,overflow:In}:null,retryLane:536870912,hydrationErrors:null},r=Pm(t),r.return=i,i.child=r,At=i,et=null)):t=null,t===null)throw Ni(i);return i.lanes=536870912,null}return Qo(i,c)}var p=t.memoizedState;if(p!==null){var y=p.dehydrated;if(Cu(i),h)if(i.flags&256)i.flags&=-257,i=Wp(t,i,r);else if(i.memoizedState!==null)i.child=t.child,i.flags|=128,i=null;else throw Error(s(558));else if(pt||es(t,i,r,!1),h=(r&t.childLanes)!==0,pt||h){if(c=Xe,c!==null&&(y=qf(c,r),y!==0&&y!==p.retryLane))throw p.retryLane=y,ga(t,y),Kt(c,t,y),Hu;sl(),i=Wp(t,i,r)}else t=p.treeContext,et=vn(y.nextSibling),At=i,Pe=!0,Mi=null,pn=!1,t!==null&&jm(i,t),i=Qo(i,c),i.flags|=4096;return i}return t=Jn(t.child,{mode:c.mode,children:c.children}),t.ref=i.ref,i.child=t,t.return=i,t}function Jo(t,i){var r=i.ref;if(r===null)t!==null&&t.ref!==null&&(i.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(t===null||t.ref!==r)&&(i.flags|=4194816)}}function Gu(t,i,r,c,h){return Sa(i),r=Eu(t,i,r,c,void 0,h),c=wu(),t!==null&&!pt?(_u(t,i,h),ti(t,i,h)):(Pe&&c&&ru(i),i.flags|=1,Nt(t,i,r,h),i.child)}function Zp(t,i,r,c,h,p){return Sa(i),i.updateQueue=null,r=tp(i,c,r,h),ep(t),c=wu(),t!==null&&!pt?(_u(t,i,p),ti(t,i,p)):(Pe&&c&&ru(i),i.flags|=1,Nt(t,i,r,p),i.child)}function $p(t,i,r,c,h){if(Sa(i),i.stateNode===null){var p=Xa,y=r.contextType;typeof y=="object"&&y!==null&&(p=Mt(y)),p=new r(c,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Fu,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=c,p.state=i.memoizedState,p.refs={},vu(i),y=r.contextType,p.context=typeof y=="object"&&y!==null?Mt(y):Xa,p.state=i.memoizedState,y=r.getDerivedStateFromProps,typeof y=="function"&&(qu(i,r,y,c),p.state=i.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(y=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),y!==p.state&&Fu.enqueueReplaceState(p,p.state,null),cr(i,c,p,h),lr(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(t===null){p=i.stateNode;var k=i.memoizedProps,w=wa(r,k);p.props=w;var I=p.context,G=r.contextType;y=Xa,typeof G=="object"&&G!==null&&(y=Mt(G));var W=r.getDerivedStateFromProps;G=typeof W=="function"||typeof p.getSnapshotBeforeUpdate=="function",k=i.pendingProps!==k,G||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(k||I!==y)&&Bp(i,p,c,y),Di=!1;var U=i.memoizedState;p.state=U,cr(i,c,p,h),lr(),I=i.memoizedState,k||U!==I||Di?(typeof W=="function"&&(qu(i,r,W,c),I=i.memoizedState),(w=Di||Up(i,r,w,c,U,I,y))?(G||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=I),p.props=c,p.state=I,p.context=y,c=w):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{p=i.stateNode,yu(t,i),y=i.memoizedProps,G=wa(r,y),p.props=G,W=i.pendingProps,U=p.context,I=r.contextType,w=Xa,typeof I=="object"&&I!==null&&(w=Mt(I)),k=r.getDerivedStateFromProps,(I=typeof k=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(y!==W||U!==w)&&Bp(i,p,c,w),Di=!1,U=i.memoizedState,p.state=U,cr(i,c,p,h),lr();var q=i.memoizedState;y!==W||U!==q||Di||t!==null&&t.dependencies!==null&&Mo(t.dependencies)?(typeof k=="function"&&(qu(i,r,k,c),q=i.memoizedState),(G=Di||Up(i,r,G,c,U,q,w)||t!==null&&t.dependencies!==null&&Mo(t.dependencies))?(I||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,q,w),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,q,w)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&U===t.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&U===t.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=q),p.props=c,p.state=q,p.context=w,c=G):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&U===t.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&U===t.memoizedState||(i.flags|=1024),c=!1)}return p=c,Jo(t,i),c=(i.flags&128)!==0,p||c?(p=i.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,t!==null&&c?(i.child=xa(i,t.child,null,h),i.child=xa(i,null,r,h)):Nt(t,i,r,h),i.memoizedState=p.state,t=i.child):t=ti(t,i,h),t}function eg(t,i,r,c){return ya(),i.flags|=256,Nt(t,i,r,c),i.child}var Yu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ku(t){return{baseLanes:t,cachePool:Vm()}}function Qu(t,i,r){return t=t!==null?t.childLanes&~r:0,i&&(t|=rn),t}function tg(t,i,r){var c=i.pendingProps,h=!1,p=(i.flags&128)!==0,y;if((y=p)||(y=t!==null&&t.memoizedState===null?!1:(ut.current&2)!==0),y&&(h=!0,i.flags&=-129),y=(i.flags&32)!==0,i.flags&=-33,t===null){if(Pe){if(h?Ii(i):ji(),(t=et)?(t=cv(t,pn),t=t!==null&&t.data!=="&"?t:null,t!==null&&(i.memoizedState={dehydrated:t,treeContext:Ai!==null?{id:Ln,overflow:In}:null,retryLane:536870912,hydrationErrors:null},r=Pm(t),r.return=i,i.child=r,At=i,et=null)):t=null,t===null)throw Ni(i);return Md(t)?i.lanes=32:i.lanes=536870912,null}var k=c.children;return c=c.fallback,h?(ji(),h=i.mode,k=Xo({mode:"hidden",children:k},h),c=va(c,h,r,null),k.return=i,c.return=i,k.sibling=c,i.child=k,c=i.child,c.memoizedState=Ku(r),c.childLanes=Qu(t,y,r),i.memoizedState=Yu,mr(null,c)):(Ii(i),Ju(i,k))}var w=t.memoizedState;if(w!==null&&(k=w.dehydrated,k!==null)){if(p)i.flags&256?(Ii(i),i.flags&=-257,i=Xu(t,i,r)):i.memoizedState!==null?(ji(),i.child=t.child,i.flags|=128,i=null):(ji(),k=c.fallback,h=i.mode,c=Xo({mode:"visible",children:c.children},h),k=va(k,h,r,null),k.flags|=2,c.return=i,k.return=i,c.sibling=k,i.child=c,xa(i,t.child,null,r),c=i.child,c.memoizedState=Ku(r),c.childLanes=Qu(t,y,r),i.memoizedState=Yu,i=mr(null,c));else if(Ii(i),Md(k)){if(y=k.nextSibling&&k.nextSibling.dataset,y)var I=y.dgst;y=I,c=Error(s(419)),c.stack="",c.digest=y,nr({value:c,source:null,stack:null}),i=Xu(t,i,r)}else if(pt||es(t,i,r,!1),y=(r&t.childLanes)!==0,pt||y){if(y=Xe,y!==null&&(c=qf(y,r),c!==0&&c!==w.retryLane))throw w.retryLane=c,ga(t,c),Kt(y,t,c),Hu;Ad(k)||sl(),i=Xu(t,i,r)}else Ad(k)?(i.flags|=192,i.child=t.child,i=null):(t=w.treeContext,et=vn(k.nextSibling),At=i,Pe=!0,Mi=null,pn=!1,t!==null&&jm(i,t),i=Ju(i,c.children),i.flags|=4096);return i}return h?(ji(),k=c.fallback,h=i.mode,w=t.child,I=w.sibling,c=Jn(w,{mode:"hidden",children:c.children}),c.subtreeFlags=w.subtreeFlags&65011712,I!==null?k=Jn(I,k):(k=va(k,h,r,null),k.flags|=2),k.return=i,c.return=i,c.sibling=k,i.child=c,mr(null,c),c=i.child,k=t.child.memoizedState,k===null?k=Ku(r):(h=k.cachePool,h!==null?(w=ft._currentValue,h=h.parent!==w?{parent:w,pool:w}:h):h=Vm(),k={baseLanes:k.baseLanes|r,cachePool:h}),c.memoizedState=k,c.childLanes=Qu(t,y,r),i.memoizedState=Yu,mr(t.child,c)):(Ii(i),r=t.child,t=r.sibling,r=Jn(r,{mode:"visible",children:c.children}),r.return=i,r.sibling=null,t!==null&&(y=i.deletions,y===null?(i.deletions=[t],i.flags|=16):y.push(t)),i.child=r,i.memoizedState=null,r)}function Ju(t,i){return i=Xo({mode:"visible",children:i},t.mode),i.return=t,t.child=i}function Xo(t,i){return t=tn(22,t,null,i),t.lanes=0,t}function Xu(t,i,r){return xa(i,t.child,null,r),t=Ju(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function ng(t,i,r){t.lanes|=i;var c=t.alternate;c!==null&&(c.lanes|=i),du(t.return,i,r)}function Wu(t,i,r,c,h,p){var y=t.memoizedState;y===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:h,treeForkCount:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=c,y.tail=r,y.tailMode=h,y.treeForkCount=p)}function ig(t,i,r){var c=i.pendingProps,h=c.revealOrder,p=c.tail;c=c.children;var y=ut.current,k=(y&2)!==0;if(k?(y=y&1|2,i.flags|=128):y&=1,ne(ut,y),Nt(t,i,c,r),c=Pe?tr:0,!k&&t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ng(t,r,i);else if(t.tag===19)ng(t,r,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(r=i.child,h=null;r!==null;)t=r.alternate,t!==null&&Uo(t)===null&&(h=r),r=r.sibling;r=h,r===null?(h=i.child,i.child=null):(h=r.sibling,r.sibling=null),Wu(i,!1,h,r,p,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,h=i.child,i.child=null;h!==null;){if(t=h.alternate,t!==null&&Uo(t)===null){i.child=h;break}t=h.sibling,h.sibling=r,r=h,h=t}Wu(i,!0,r,null,p,c);break;case"together":Wu(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function ti(t,i,r){if(t!==null&&(i.dependencies=t.dependencies),zi|=i.lanes,(r&i.childLanes)===0)if(t!==null){if(es(t,i,r,!1),(r&i.childLanes)===0)return null}else return null;if(t!==null&&i.child!==t.child)throw Error(s(153));if(i.child!==null){for(t=i.child,r=Jn(t,t.pendingProps),i.child=r,r.return=i;t.sibling!==null;)t=t.sibling,r=r.sibling=Jn(t,t.pendingProps),r.return=i;r.sibling=null}return i.child}function Zu(t,i){return(t.lanes&i)!==0?!0:(t=t.dependencies,!!(t!==null&&Mo(t)))}function _T(t,i,r){switch(i.tag){case 3:Tt(i,i.stateNode.containerInfo),Oi(i,ft,t.memoizedState.cache),ya();break;case 27:case 5:Pn(i);break;case 4:Tt(i,i.stateNode.containerInfo);break;case 10:Oi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Cu(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Ii(i),i.flags|=128,null):(r&i.child.childLanes)!==0?tg(t,i,r):(Ii(i),t=ti(t,i,r),t!==null?t.sibling:null);Ii(i);break;case 19:var h=(t.flags&128)!==0;if(c=(r&i.childLanes)!==0,c||(es(t,i,r,!1),c=(r&i.childLanes)!==0),h){if(c)return ig(t,i,r);i.flags|=128}if(h=i.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),ne(ut,ut.current),c)break;return null;case 22:return i.lanes=0,Jp(t,i,r,i.pendingProps);case 24:Oi(i,ft,t.memoizedState.cache)}return ti(t,i,r)}function ag(t,i,r){if(t!==null)if(t.memoizedProps!==i.pendingProps)pt=!0;else{if(!Zu(t,r)&&(i.flags&128)===0)return pt=!1,_T(t,i,r);pt=(t.flags&131072)!==0}else pt=!1,Pe&&(i.flags&1048576)!==0&&Im(i,tr,i.index);switch(i.lanes=0,i.tag){case 16:e:{var c=i.pendingProps;if(t=Ta(i.elementType),i.type=t,typeof t=="function")iu(t)?(c=wa(t,c),i.tag=1,i=$p(null,i,t,c,r)):(i.tag=0,i=Gu(null,i,t,c,r));else{if(t!=null){var h=t.$$typeof;if(h===A){i.tag=11,i=Yp(null,i,t,c,r);break e}else if(h===X){i.tag=14,i=Kp(null,i,t,c,r);break e}}throw i=$e(t)||t,Error(s(306,i,""))}}return i;case 0:return Gu(t,i,i.type,i.pendingProps,r);case 1:return c=i.type,h=wa(c,i.pendingProps),$p(t,i,c,h,r);case 3:e:{if(Tt(i,i.stateNode.containerInfo),t===null)throw Error(s(387));c=i.pendingProps;var p=i.memoizedState;h=p.element,yu(t,i),cr(i,c,null,r);var y=i.memoizedState;if(c=y.cache,Oi(i,ft,c),c!==p.cache&&hu(i,[ft],r,!0),lr(),c=y.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:y.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=eg(t,i,c,r);break e}else if(c!==h){h=hn(Error(s(424)),i),nr(h),i=eg(t,i,c,r);break e}else{switch(t=i.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(et=vn(t.firstChild),At=i,Pe=!0,Mi=null,pn=!0,r=Jm(i,null,c,r),i.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(ya(),c===h){i=ti(t,i,r);break e}Nt(t,i,c,r)}i=i.child}return i;case 26:return Jo(t,i),t===null?(r=pv(i.type,null,i.pendingProps,null))?i.memoizedState=r:Pe||(r=i.type,t=i.pendingProps,c=hl(ye.current).createElement(r),c[Rt]=i,c[qt]=t,Ot(c,r,t),Ct(c),i.stateNode=c):i.memoizedState=pv(i.type,t.memoizedProps,i.pendingProps,t.memoizedState),null;case 27:return Pn(i),t===null&&Pe&&(c=i.stateNode=hv(i.type,i.pendingProps,ye.current),At=i,pn=!0,h=et,Gi(i.type)?(Nd=h,et=vn(c.firstChild)):et=h),Nt(t,i,i.pendingProps.children,r),Jo(t,i),t===null&&(i.flags|=4194304),i.child;case 5:return t===null&&Pe&&((h=c=et)&&(c=iC(c,i.type,i.pendingProps,pn),c!==null?(i.stateNode=c,At=i,et=vn(c.firstChild),pn=!1,h=!0):h=!1),h||Ni(i)),Pn(i),h=i.type,p=i.pendingProps,y=t!==null?t.memoizedProps:null,c=p.children,wd(h,p)?c=null:y!==null&&wd(h,y)&&(i.flags|=32),i.memoizedState!==null&&(h=Eu(t,i,yT,null,null,r),Ar._currentValue=h),Jo(t,i),Nt(t,i,c,r),i.child;case 6:return t===null&&Pe&&((t=r=et)&&(r=aC(r,i.pendingProps,pn),r!==null?(i.stateNode=r,At=i,et=null,t=!0):t=!1),t||Ni(i)),null;case 13:return tg(t,i,r);case 4:return Tt(i,i.stateNode.containerInfo),c=i.pendingProps,t===null?i.child=xa(i,null,c,r):Nt(t,i,c,r),i.child;case 11:return Yp(t,i,i.type,i.pendingProps,r);case 7:return Nt(t,i,i.pendingProps,r),i.child;case 8:return Nt(t,i,i.pendingProps.children,r),i.child;case 12:return Nt(t,i,i.pendingProps.children,r),i.child;case 10:return c=i.pendingProps,Oi(i,i.type,c.value),Nt(t,i,c.children,r),i.child;case 9:return h=i.type._context,c=i.pendingProps.children,Sa(i),h=Mt(h),c=c(h),i.flags|=1,Nt(t,i,c,r),i.child;case 14:return Kp(t,i,i.type,i.pendingProps,r);case 15:return Qp(t,i,i.type,i.pendingProps,r);case 19:return ig(t,i,r);case 31:return wT(t,i,r);case 22:return Jp(t,i,r,i.pendingProps);case 24:return Sa(i),c=Mt(ft),t===null?(h=pu(),h===null&&(h=Xe,p=fu(),h.pooledCache=p,p.refCount++,p!==null&&(h.pooledCacheLanes|=r),h=p),i.memoizedState={parent:c,cache:h},vu(i),Oi(i,ft,h)):((t.lanes&r)!==0&&(yu(t,i),cr(i,null,null,r),lr()),h=t.memoizedState,p=i.memoizedState,h.parent!==c?(h={parent:c,cache:c},i.memoizedState=h,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=h),Oi(i,ft,c)):(c=p.cache,Oi(i,ft,c),c!==h.cache&&hu(i,[ft],r,!0))),Nt(t,i,i.pendingProps.children,r),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function ni(t){t.flags|=4}function $u(t,i,r,c,h){if((i=(t.mode&32)!==0)&&(i=!1),i){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(Ng())t.flags|=8192;else throw Ca=Po,gu}else t.flags&=-16777217}function sg(t,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Sv(i))if(Ng())t.flags|=8192;else throw Ca=Po,gu}function Wo(t,i){i!==null&&(t.flags|=4),t.flags&16384&&(i=t.tag!==22?Uf():536870912,t.lanes|=i,hs|=i)}function pr(t,i){if(!Pe)switch(t.tailMode){case"hidden":i=t.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function tt(t){var i=t.alternate!==null&&t.alternate.child===t.child,r=0,c=0;if(i)for(var h=t.child;h!==null;)r|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)r|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=c,t.childLanes=r,i}function RT(t,i,r){var c=i.pendingProps;switch(ou(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tt(i),null;case 1:return tt(i),null;case 3:return r=i.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Zn(ft),Ze(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&($a(i)?ni(i):t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,cu())),tt(i),null;case 26:var h=i.type,p=i.memoizedState;return t===null?(ni(i),p!==null?(tt(i),sg(i,p)):(tt(i),$u(i,h,null,c,r))):p?p!==t.memoizedState?(ni(i),tt(i),sg(i,p)):(tt(i),i.flags&=-16777217):(t=t.memoizedProps,t!==c&&ni(i),tt(i),$u(i,h,t,c,r)),null;case 27:if(xi(i),r=ye.current,h=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==c&&ni(i);else{if(!c){if(i.stateNode===null)throw Error(s(166));return tt(i),null}t=le.current,$a(i)?Um(i):(t=hv(h,c,r),i.stateNode=t,ni(i))}return tt(i),null;case 5:if(xi(i),h=i.type,t!==null&&i.stateNode!=null)t.memoizedProps!==c&&ni(i);else{if(!c){if(i.stateNode===null)throw Error(s(166));return tt(i),null}if(p=le.current,$a(i))Um(i);else{var y=hl(ye.current);switch(p){case 1:p=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:p=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":p=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":p=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":p=y.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof c.is=="string"?y.createElement("select",{is:c.is}):y.createElement("select"),c.multiple?p.multiple=!0:c.size&&(p.size=c.size);break;default:p=typeof c.is=="string"?y.createElement(h,{is:c.is}):y.createElement(h)}}p[Rt]=i,p[qt]=c;e:for(y=i.child;y!==null;){if(y.tag===5||y.tag===6)p.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===i)break e;for(;y.sibling===null;){if(y.return===null||y.return===i)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}i.stateNode=p;e:switch(Ot(p,h,c),h){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ni(i)}}return tt(i),$u(i,i.type,t===null?null:t.memoizedProps,i.pendingProps,r),null;case 6:if(t&&i.stateNode!=null)t.memoizedProps!==c&&ni(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(s(166));if(t=ye.current,$a(i)){if(t=i.stateNode,r=i.memoizedProps,c=null,h=At,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}t[Rt]=i,t=!!(t.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||tv(t.nodeValue,r)),t||Ni(i,!0)}else t=hl(t).createTextNode(c),t[Rt]=i,i.stateNode=t}return tt(i),null;case 31:if(r=i.memoizedState,t===null||t.memoizedState!==null){if(c=$a(i),r!==null){if(t===null){if(!c)throw Error(s(318));if(t=i.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));t[Rt]=i}else ya(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;tt(i),t=!1}else r=cu(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),t=!0;if(!t)return i.flags&256?(an(i),i):(an(i),null);if((i.flags&128)!==0)throw Error(s(558))}return tt(i),null;case 13:if(c=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=$a(i),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(s(318));if(h=i.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[Rt]=i}else ya(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;tt(i),h=!1}else h=cu(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return i.flags&256?(an(i),i):(an(i),null)}return an(i),(i.flags&128)!==0?(i.lanes=r,i):(r=c!==null,t=t!==null&&t.memoizedState!==null,r&&(c=i.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==h&&(c.flags|=2048)),r!==t&&r&&(i.child.flags|=8192),Wo(i,i.updateQueue),tt(i),null);case 4:return Ze(),t===null&&kd(i.stateNode.containerInfo),tt(i),null;case 10:return Zn(i.type),tt(i),null;case 19:if(K(ut),c=i.memoizedState,c===null)return tt(i),null;if(h=(i.flags&128)!==0,p=c.rendering,p===null)if(h)pr(c,!1);else{if(rt!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(p=Uo(t),p!==null){for(i.flags|=128,pr(c,!1),t=p.updateQueue,i.updateQueue=t,Wo(i,t),i.subtreeFlags=0,t=r,r=i.child;r!==null;)Dm(r,t),r=r.sibling;return ne(ut,ut.current&1|2),Pe&&Xn(i,c.treeForkCount),i.child}t=t.sibling}c.tail!==null&&Wt()>nl&&(i.flags|=128,h=!0,pr(c,!1),i.lanes=4194304)}else{if(!h)if(t=Uo(p),t!==null){if(i.flags|=128,h=!0,t=t.updateQueue,i.updateQueue=t,Wo(i,t),pr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!Pe)return tt(i),null}else 2*Wt()-c.renderingStartTime>nl&&r!==536870912&&(i.flags|=128,h=!0,pr(c,!1),i.lanes=4194304);c.isBackwards?(p.sibling=i.child,i.child=p):(t=c.last,t!==null?t.sibling=p:i.child=p,c.last=p)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Wt(),t.sibling=null,r=ut.current,ne(ut,h?r&1|2:r&1),Pe&&Xn(i,c.treeForkCount),t):(tt(i),null);case 22:case 23:return an(i),Tu(),c=i.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(r&536870912)!==0&&(i.flags&128)===0&&(tt(i),i.subtreeFlags&6&&(i.flags|=8192)):tt(i),r=i.updateQueue,r!==null&&Wo(i,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==r&&(i.flags|=2048),t!==null&&K(ka),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),i.memoizedState.cache!==r&&(i.flags|=2048),Zn(ft),tt(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function AT(t,i){switch(ou(i),i.tag){case 1:return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return Zn(ft),Ze(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 26:case 27:case 5:return xi(i),null;case 31:if(i.memoizedState!==null){if(an(i),i.alternate===null)throw Error(s(340));ya()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 13:if(an(i),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(s(340));ya()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return K(ut),null;case 4:return Ze(),null;case 10:return Zn(i.type),null;case 22:case 23:return an(i),Tu(),t!==null&&K(ka),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 24:return Zn(ft),null;case 25:return null;default:return null}}function rg(t,i){switch(ou(i),i.tag){case 3:Zn(ft),Ze();break;case 26:case 27:case 5:xi(i);break;case 4:Ze();break;case 31:i.memoizedState!==null&&an(i);break;case 13:an(i);break;case 19:K(ut);break;case 10:Zn(i.type);break;case 22:case 23:an(i),Tu(),t!==null&&K(ka);break;case 24:Zn(ft)}}function gr(t,i){try{var r=i.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var h=c.next;r=h;do{if((r.tag&t)===t){c=void 0;var p=r.create,y=r.inst;c=p(),y.destroy=c}r=r.next}while(r!==h)}}catch(k){Ve(i,i.return,k)}}function Ui(t,i,r){try{var c=i.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var p=h.next;c=p;do{if((c.tag&t)===t){var y=c.inst,k=y.destroy;if(k!==void 0){y.destroy=void 0,h=i;var w=r,I=k;try{I()}catch(G){Ve(h,w,G)}}}c=c.next}while(c!==p)}}catch(G){Ve(i,i.return,G)}}function og(t){var i=t.updateQueue;if(i!==null){var r=t.stateNode;try{Wm(i,r)}catch(c){Ve(t,t.return,c)}}}function lg(t,i,r){r.props=wa(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(c){Ve(t,i,c)}}function vr(t,i){try{var r=t.ref;if(r!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof r=="function"?t.refCleanup=r(c):r.current=c}}catch(h){Ve(t,i,h)}}function jn(t,i){var r=t.ref,c=t.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(h){Ve(t,i,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(h){Ve(t,i,h)}else r.current=null}function cg(t){var i=t.type,r=t.memoizedProps,c=t.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break e;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(h){Ve(t,t.return,h)}}function ed(t,i,r){try{var c=t.stateNode;WT(c,t.type,r,i),c[qt]=i}catch(h){Ve(t,t.return,h)}}function ug(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Gi(t.type)||t.tag===4}function td(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ug(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Gi(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nd(t,i,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,i?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(t,i):(i=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,i.appendChild(t),r=r._reactRootContainer,r!=null||i.onclick!==null||(i.onclick=Kn));else if(c!==4&&(c===27&&Gi(t.type)&&(r=t.stateNode,i=null),t=t.child,t!==null))for(nd(t,i,r),t=t.sibling;t!==null;)nd(t,i,r),t=t.sibling}function Zo(t,i,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,i?r.insertBefore(t,i):r.appendChild(t);else if(c!==4&&(c===27&&Gi(t.type)&&(r=t.stateNode),t=t.child,t!==null))for(Zo(t,i,r),t=t.sibling;t!==null;)Zo(t,i,r),t=t.sibling}function dg(t){var i=t.stateNode,r=t.memoizedProps;try{for(var c=t.type,h=i.attributes;h.length;)i.removeAttributeNode(h[0]);Ot(i,c,r),i[Rt]=t,i[qt]=r}catch(p){Ve(t,t.return,p)}}var ii=!1,gt=!1,id=!1,hg=typeof WeakSet=="function"?WeakSet:Set,xt=null;function MT(t,i){if(t=t.containerInfo,xd=bl,t=xm(t),Xc(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var h=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break e}var y=0,k=-1,w=-1,I=0,G=0,W=t,U=null;t:for(;;){for(var q;W!==r||h!==0&&W.nodeType!==3||(k=y+h),W!==p||c!==0&&W.nodeType!==3||(w=y+c),W.nodeType===3&&(y+=W.nodeValue.length),(q=W.firstChild)!==null;)U=W,W=q;for(;;){if(W===t)break t;if(U===r&&++I===h&&(k=y),U===p&&++G===c&&(w=y),(q=W.nextSibling)!==null)break;W=U,U=W.parentNode}W=q}r=k===-1||w===-1?null:{start:k,end:w}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ed={focusedElem:t,selectionRange:r},bl=!1,xt=i;xt!==null;)if(i=xt,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,xt=t;else for(;xt!==null;){switch(i=xt,p=i.alternate,t=i.flags,i.tag){case 0:if((t&4)!==0&&(t=i.updateQueue,t=t!==null?t.events:null,t!==null))for(r=0;r<t.length;r++)h=t[r],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,r=i,h=p.memoizedProps,p=p.memoizedState,c=r.stateNode;try{var ce=wa(r.type,h);t=c.getSnapshotBeforeUpdate(ce,p),c.__reactInternalSnapshotBeforeUpdate=t}catch(pe){Ve(r,r.return,pe)}}break;case 3:if((t&1024)!==0){if(t=i.stateNode.containerInfo,r=t.nodeType,r===9)Rd(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Rd(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=i.sibling,t!==null){t.return=i.return,xt=t;break}xt=i.return}}function fg(t,i,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:si(t,r),c&4&&gr(5,r);break;case 1:if(si(t,r),c&4)if(t=r.stateNode,i===null)try{t.componentDidMount()}catch(y){Ve(r,r.return,y)}else{var h=wa(r.type,i.memoizedProps);i=i.memoizedState;try{t.componentDidUpdate(h,i,t.__reactInternalSnapshotBeforeUpdate)}catch(y){Ve(r,r.return,y)}}c&64&&og(r),c&512&&vr(r,r.return);break;case 3:if(si(t,r),c&64&&(t=r.updateQueue,t!==null)){if(i=null,r.child!==null)switch(r.child.tag){case 27:case 5:i=r.child.stateNode;break;case 1:i=r.child.stateNode}try{Wm(t,i)}catch(y){Ve(r,r.return,y)}}break;case 27:i===null&&c&4&&dg(r);case 26:case 5:si(t,r),i===null&&c&4&&cg(r),c&512&&vr(r,r.return);break;case 12:si(t,r);break;case 31:si(t,r),c&4&&gg(t,r);break;case 13:si(t,r),c&4&&vg(t,r),c&64&&(t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(r=BT.bind(null,r),sC(t,r))));break;case 22:if(c=r.memoizedState!==null||ii,!c){i=i!==null&&i.memoizedState!==null||gt,h=ii;var p=gt;ii=c,(gt=i)&&!p?ri(t,r,(r.subtreeFlags&8772)!==0):si(t,r),ii=h,gt=p}break;case 30:break;default:si(t,r)}}function mg(t){var i=t.alternate;i!==null&&(t.alternate=null,mg(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&Dc(i)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var nt=null,Vt=!1;function ai(t,i,r){for(r=r.child;r!==null;)pg(t,i,r),r=r.sibling}function pg(t,i,r){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(qs,r)}catch{}switch(r.tag){case 26:gt||jn(r,i),ai(t,i,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:gt||jn(r,i);var c=nt,h=Vt;Gi(r.type)&&(nt=r.stateNode,Vt=!1),ai(t,i,r),wr(r.stateNode),nt=c,Vt=h;break;case 5:gt||jn(r,i);case 6:if(c=nt,h=Vt,nt=null,ai(t,i,r),nt=c,Vt=h,nt!==null)if(Vt)try{(nt.nodeType===9?nt.body:nt.nodeName==="HTML"?nt.ownerDocument.body:nt).removeChild(r.stateNode)}catch(p){Ve(r,i,p)}else try{nt.removeChild(r.stateNode)}catch(p){Ve(r,i,p)}break;case 18:nt!==null&&(Vt?(t=nt,ov(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,r.stateNode),Ss(t)):ov(nt,r.stateNode));break;case 4:c=nt,h=Vt,nt=r.stateNode.containerInfo,Vt=!0,ai(t,i,r),nt=c,Vt=h;break;case 0:case 11:case 14:case 15:Ui(2,r,i),gt||Ui(4,r,i),ai(t,i,r);break;case 1:gt||(jn(r,i),c=r.stateNode,typeof c.componentWillUnmount=="function"&&lg(r,i,c)),ai(t,i,r);break;case 21:ai(t,i,r);break;case 22:gt=(c=gt)||r.memoizedState!==null,ai(t,i,r),gt=c;break;default:ai(t,i,r)}}function gg(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Ss(t)}catch(r){Ve(i,i.return,r)}}}function vg(t,i){if(i.memoizedState===null&&(t=i.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ss(t)}catch(r){Ve(i,i.return,r)}}function NT(t){switch(t.tag){case 31:case 13:case 19:var i=t.stateNode;return i===null&&(i=t.stateNode=new hg),i;case 22:return t=t.stateNode,i=t._retryCache,i===null&&(i=t._retryCache=new hg),i;default:throw Error(s(435,t.tag))}}function $o(t,i){var r=NT(t);i.forEach(function(c){if(!r.has(c)){r.add(c);var h=zT.bind(null,t,c);c.then(h,h)}})}function Ht(t,i){var r=i.deletions;if(r!==null)for(var c=0;c<r.length;c++){var h=r[c],p=t,y=i,k=y;e:for(;k!==null;){switch(k.tag){case 27:if(Gi(k.type)){nt=k.stateNode,Vt=!1;break e}break;case 5:nt=k.stateNode,Vt=!1;break e;case 3:case 4:nt=k.stateNode.containerInfo,Vt=!0;break e}k=k.return}if(nt===null)throw Error(s(160));pg(p,y,h),nt=null,Vt=!1,p=h.alternate,p!==null&&(p.return=null),h.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)yg(i,t),i=i.sibling}var xn=null;function yg(t,i){var r=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Ht(i,t),Gt(t),c&4&&(Ui(3,t,t.return),gr(3,t),Ui(5,t,t.return));break;case 1:Ht(i,t),Gt(t),c&512&&(gt||r===null||jn(r,r.return)),c&64&&ii&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var h=xn;if(Ht(i,t),Gt(t),c&512&&(gt||r===null||jn(r,r.return)),c&4){var p=r!==null?r.memoizedState:null;if(c=t.memoizedState,r===null)if(c===null)if(t.stateNode===null){e:{c=t.type,r=t.memoizedProps,h=h.ownerDocument||h;t:switch(c){case"title":p=h.getElementsByTagName("title")[0],(!p||p[Hs]||p[Rt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=h.createElement(c),h.head.insertBefore(p,h.querySelector("head > title"))),Ot(p,c,r),p[Rt]=t,Ct(p),c=p;break e;case"link":var y=yv("link","href",h).get(c+(r.href||""));if(y){for(var k=0;k<y.length;k++)if(p=y[k],p.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){y.splice(k,1);break t}}p=h.createElement(c),Ot(p,c,r),h.head.appendChild(p);break;case"meta":if(y=yv("meta","content",h).get(c+(r.content||""))){for(k=0;k<y.length;k++)if(p=y[k],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){y.splice(k,1);break t}}p=h.createElement(c),Ot(p,c,r),h.head.appendChild(p);break;default:throw Error(s(468,c))}p[Rt]=t,Ct(p),c=p}t.stateNode=c}else bv(h,t.type,t.stateNode);else t.stateNode=vv(h,c,t.memoizedProps);else p!==c?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,c===null?bv(h,t.type,t.stateNode):vv(h,c,t.memoizedProps)):c===null&&t.stateNode!==null&&ed(t,t.memoizedProps,r.memoizedProps)}break;case 27:Ht(i,t),Gt(t),c&512&&(gt||r===null||jn(r,r.return)),r!==null&&c&4&&ed(t,t.memoizedProps,r.memoizedProps);break;case 5:if(Ht(i,t),Gt(t),c&512&&(gt||r===null||jn(r,r.return)),t.flags&32){h=t.stateNode;try{Va(h,"")}catch(ce){Ve(t,t.return,ce)}}c&4&&t.stateNode!=null&&(h=t.memoizedProps,ed(t,h,r!==null?r.memoizedProps:h)),c&1024&&(id=!0);break;case 6:if(Ht(i,t),Gt(t),c&4){if(t.stateNode===null)throw Error(s(162));c=t.memoizedProps,r=t.stateNode;try{r.nodeValue=c}catch(ce){Ve(t,t.return,ce)}}break;case 3:if(pl=null,h=xn,xn=fl(i.containerInfo),Ht(i,t),xn=h,Gt(t),c&4&&r!==null&&r.memoizedState.isDehydrated)try{Ss(i.containerInfo)}catch(ce){Ve(t,t.return,ce)}id&&(id=!1,bg(t));break;case 4:c=xn,xn=fl(t.stateNode.containerInfo),Ht(i,t),Gt(t),xn=c;break;case 12:Ht(i,t),Gt(t);break;case 31:Ht(i,t),Gt(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,$o(t,c)));break;case 13:Ht(i,t),Gt(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(tl=Wt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,$o(t,c)));break;case 22:h=t.memoizedState!==null;var w=r!==null&&r.memoizedState!==null,I=ii,G=gt;if(ii=I||h,gt=G||w,Ht(i,t),gt=G,ii=I,Gt(t),c&8192)e:for(i=t.stateNode,i._visibility=h?i._visibility&-2:i._visibility|1,h&&(r===null||w||ii||gt||_a(t)),r=null,i=t;;){if(i.tag===5||i.tag===26){if(r===null){w=r=i;try{if(p=w.stateNode,h)y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{k=w.stateNode;var W=w.memoizedProps.style,U=W!=null&&W.hasOwnProperty("display")?W.display:null;k.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(ce){Ve(w,w.return,ce)}}}else if(i.tag===6){if(r===null){w=i;try{w.stateNode.nodeValue=h?"":w.memoizedProps}catch(ce){Ve(w,w.return,ce)}}}else if(i.tag===18){if(r===null){w=i;try{var q=w.stateNode;h?lv(q,!0):lv(w.stateNode,!1)}catch(ce){Ve(w,w.return,ce)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===t)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;i.sibling===null;){if(i.return===null||i.return===t)break e;r===i&&(r=null),i=i.return}r===i&&(r=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=t.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,$o(t,r))));break;case 19:Ht(i,t),Gt(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,$o(t,c)));break;case 30:break;case 21:break;default:Ht(i,t),Gt(t)}}function Gt(t){var i=t.flags;if(i&2){try{for(var r,c=t.return;c!==null;){if(ug(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var h=r.stateNode,p=td(t);Zo(t,p,h);break;case 5:var y=r.stateNode;r.flags&32&&(Va(y,""),r.flags&=-33);var k=td(t);Zo(t,k,y);break;case 3:case 4:var w=r.stateNode.containerInfo,I=td(t);nd(t,I,w);break;default:throw Error(s(161))}}catch(G){Ve(t,t.return,G)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function bg(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var i=t;bg(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),t=t.sibling}}function si(t,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)fg(t,i.alternate,i),i=i.sibling}function _a(t){for(t=t.child;t!==null;){var i=t;switch(i.tag){case 0:case 11:case 14:case 15:Ui(4,i,i.return),_a(i);break;case 1:jn(i,i.return);var r=i.stateNode;typeof r.componentWillUnmount=="function"&&lg(i,i.return,r),_a(i);break;case 27:wr(i.stateNode);case 26:case 5:jn(i,i.return),_a(i);break;case 22:i.memoizedState===null&&_a(i);break;case 30:_a(i);break;default:_a(i)}t=t.sibling}}function ri(t,i,r){for(r=r&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,h=t,p=i,y=p.flags;switch(p.tag){case 0:case 11:case 15:ri(h,p,r),gr(4,p);break;case 1:if(ri(h,p,r),c=p,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(I){Ve(c,c.return,I)}if(c=p,h=c.updateQueue,h!==null){var k=c.stateNode;try{var w=h.shared.hiddenCallbacks;if(w!==null)for(h.shared.hiddenCallbacks=null,h=0;h<w.length;h++)Xm(w[h],k)}catch(I){Ve(c,c.return,I)}}r&&y&64&&og(p),vr(p,p.return);break;case 27:dg(p);case 26:case 5:ri(h,p,r),r&&c===null&&y&4&&cg(p),vr(p,p.return);break;case 12:ri(h,p,r);break;case 31:ri(h,p,r),r&&y&4&&gg(h,p);break;case 13:ri(h,p,r),r&&y&4&&vg(h,p);break;case 22:p.memoizedState===null&&ri(h,p,r),vr(p,p.return);break;case 30:break;default:ri(h,p,r)}i=i.sibling}}function ad(t,i){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(t=i.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&ir(r))}function sd(t,i){t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&ir(t))}function En(t,i,r,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Sg(t,i,r,c),i=i.sibling}function Sg(t,i,r,c){var h=i.flags;switch(i.tag){case 0:case 11:case 15:En(t,i,r,c),h&2048&&gr(9,i);break;case 1:En(t,i,r,c);break;case 3:En(t,i,r,c),h&2048&&(t=null,i.alternate!==null&&(t=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==t&&(i.refCount++,t!=null&&ir(t)));break;case 12:if(h&2048){En(t,i,r,c),t=i.stateNode;try{var p=i.memoizedProps,y=p.id,k=p.onPostCommit;typeof k=="function"&&k(y,i.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(w){Ve(i,i.return,w)}}else En(t,i,r,c);break;case 31:En(t,i,r,c);break;case 13:En(t,i,r,c);break;case 23:break;case 22:p=i.stateNode,y=i.alternate,i.memoizedState!==null?p._visibility&2?En(t,i,r,c):yr(t,i):p._visibility&2?En(t,i,r,c):(p._visibility|=2,cs(t,i,r,c,(i.subtreeFlags&10256)!==0||!1)),h&2048&&ad(y,i);break;case 24:En(t,i,r,c),h&2048&&sd(i.alternate,i);break;default:En(t,i,r,c)}}function cs(t,i,r,c,h){for(h=h&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=t,y=i,k=r,w=c,I=y.flags;switch(y.tag){case 0:case 11:case 15:cs(p,y,k,w,h),gr(8,y);break;case 23:break;case 22:var G=y.stateNode;y.memoizedState!==null?G._visibility&2?cs(p,y,k,w,h):yr(p,y):(G._visibility|=2,cs(p,y,k,w,h)),h&&I&2048&&ad(y.alternate,y);break;case 24:cs(p,y,k,w,h),h&&I&2048&&sd(y.alternate,y);break;default:cs(p,y,k,w,h)}i=i.sibling}}function yr(t,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var r=t,c=i,h=c.flags;switch(c.tag){case 22:yr(r,c),h&2048&&ad(c.alternate,c);break;case 24:yr(r,c),h&2048&&sd(c.alternate,c);break;default:yr(r,c)}i=i.sibling}}var br=8192;function us(t,i,r){if(t.subtreeFlags&br)for(t=t.child;t!==null;)kg(t,i,r),t=t.sibling}function kg(t,i,r){switch(t.tag){case 26:us(t,i,r),t.flags&br&&t.memoizedState!==null&&vC(r,xn,t.memoizedState,t.memoizedProps);break;case 5:us(t,i,r);break;case 3:case 4:var c=xn;xn=fl(t.stateNode.containerInfo),us(t,i,r),xn=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=br,br=16777216,us(t,i,r),br=c):us(t,i,r));break;default:us(t,i,r)}}function Tg(t){var i=t.alternate;if(i!==null&&(t=i.child,t!==null)){i.child=null;do i=t.sibling,t.sibling=null,t=i;while(t!==null)}}function Sr(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var r=0;r<i.length;r++){var c=i[r];xt=c,xg(c,t)}Tg(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Cg(t),t=t.sibling}function Cg(t){switch(t.tag){case 0:case 11:case 15:Sr(t),t.flags&2048&&Ui(9,t,t.return);break;case 3:Sr(t);break;case 12:Sr(t);break;case 22:var i=t.stateNode;t.memoizedState!==null&&i._visibility&2&&(t.return===null||t.return.tag!==13)?(i._visibility&=-3,el(t)):Sr(t);break;default:Sr(t)}}function el(t){var i=t.deletions;if((t.flags&16)!==0){if(i!==null)for(var r=0;r<i.length;r++){var c=i[r];xt=c,xg(c,t)}Tg(t)}for(t=t.child;t!==null;){switch(i=t,i.tag){case 0:case 11:case 15:Ui(8,i,i.return),el(i);break;case 22:r=i.stateNode,r._visibility&2&&(r._visibility&=-3,el(i));break;default:el(i)}t=t.sibling}}function xg(t,i){for(;xt!==null;){var r=xt;switch(r.tag){case 0:case 11:case 15:Ui(8,r,i);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:ir(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,xt=c;else e:for(r=t;xt!==null;){c=xt;var h=c.sibling,p=c.return;if(mg(c),c===r){xt=null;break e}if(h!==null){h.return=p,xt=h;break e}xt=p}}}var OT={getCacheForType:function(t){var i=Mt(ft),r=i.data.get(t);return r===void 0&&(r=t(),i.data.set(t,r)),r},cacheSignal:function(){return Mt(ft).controller.signal}},DT=typeof WeakMap=="function"?WeakMap:Map,Be=0,Xe=null,Ee=null,Me=0,Fe=0,sn=null,Bi=!1,ds=!1,rd=!1,oi=0,rt=0,zi=0,Ra=0,od=0,rn=0,hs=0,kr=null,Yt=null,ld=!1,tl=0,Eg=0,nl=1/0,il=null,qi=null,yt=0,Fi=null,fs=null,li=0,cd=0,ud=null,wg=null,Tr=0,dd=null;function on(){return(Be&2)!==0&&Me!==0?Me&-Me:F.T!==null?vd():Ff()}function _g(){if(rn===0)if((Me&536870912)===0||Pe){var t=uo;uo<<=1,(uo&3932160)===0&&(uo=262144),rn=t}else rn=536870912;return t=nn.current,t!==null&&(t.flags|=32),rn}function Kt(t,i,r){(t===Xe&&(Fe===2||Fe===9)||t.cancelPendingCommit!==null)&&(ms(t,0),Vi(t,Me,rn,!1)),Vs(t,r),((Be&2)===0||t!==Xe)&&(t===Xe&&((Be&2)===0&&(Ra|=r),rt===4&&Vi(t,Me,rn,!1)),Un(t))}function Rg(t,i,r){if((Be&6)!==0)throw Error(s(327));var c=!r&&(i&127)===0&&(i&t.expiredLanes)===0||Fs(t,i),h=c?IT(t,i):fd(t,i,!0),p=c;do{if(h===0){ds&&!c&&Vi(t,i,0,!1);break}else{if(r=t.current.alternate,p&&!PT(r)){h=fd(t,i,!1),p=!1;continue}if(h===2){if(p=i,t.errorRecoveryDisabledLanes&p)var y=0;else y=t.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){i=y;e:{var k=t;h=kr;var w=k.current.memoizedState.isDehydrated;if(w&&(ms(k,y).flags|=256),y=fd(k,y,!1),y!==2){if(rd&&!w){k.errorRecoveryDisabledLanes|=p,Ra|=p,h=4;break e}p=Yt,Yt=h,p!==null&&(Yt===null?Yt=p:Yt.push.apply(Yt,p))}h=y}if(p=!1,h!==2)continue}}if(h===1){ms(t,0),Vi(t,i,0,!0);break}e:{switch(c=t,p=h,p){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:Vi(c,i,rn,!Bi);break e;case 2:Yt=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(h=tl+300-Wt(),10<h)){if(Vi(c,i,rn,!Bi),fo(c,0,!0)!==0)break e;li=i,c.timeoutHandle=sv(Ag.bind(null,c,r,Yt,il,ld,i,rn,Ra,hs,Bi,p,"Throttled",-0,0),h);break e}Ag(c,r,Yt,il,ld,i,rn,Ra,hs,Bi,p,null,-0,0)}}break}while(!0);Un(t)}function Ag(t,i,r,c,h,p,y,k,w,I,G,W,U,q){if(t.timeoutHandle=-1,W=i.subtreeFlags,W&8192||(W&16785408)===16785408){W={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Kn},kg(i,p,W);var ce=(p&62914560)===p?tl-Wt():(p&4194048)===p?Eg-Wt():0;if(ce=yC(W,ce),ce!==null){li=p,t.cancelPendingCommit=ce(jg.bind(null,t,i,p,r,c,h,y,k,w,G,W,null,U,q)),Vi(t,p,y,!I);return}}jg(t,i,p,r,c,h,y,k,w)}function PT(t){for(var i=t;;){var r=i.tag;if((r===0||r===11||r===15)&&i.flags&16384&&(r=i.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var h=r[c],p=h.getSnapshot;h=h.value;try{if(!en(p(),h))return!1}catch{return!1}}if(r=i.child,i.subtreeFlags&16384&&r!==null)r.return=i,i=r;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Vi(t,i,r,c){i&=~od,i&=~Ra,t.suspendedLanes|=i,t.pingedLanes&=~i,c&&(t.warmLanes|=i),c=t.expirationTimes;for(var h=i;0<h;){var p=31-$t(h),y=1<<p;c[p]=-1,h&=~y}r!==0&&Bf(t,r,i)}function al(){return(Be&6)===0?(Cr(0),!1):!0}function hd(){if(Ee!==null){if(Fe===0)var t=Ee.return;else t=Ee,Wn=ba=null,Ru(t),as=null,sr=0,t=Ee;for(;t!==null;)rg(t.alternate,t),t=t.return;Ee=null}}function ms(t,i){var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,eC(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),li=0,hd(),Xe=t,Ee=r=Jn(t.current,null),Me=i,Fe=0,sn=null,Bi=!1,ds=Fs(t,i),rd=!1,hs=rn=od=Ra=zi=rt=0,Yt=kr=null,ld=!1,(i&8)!==0&&(i|=i&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=i;0<c;){var h=31-$t(c),p=1<<h;i|=t[h],c&=~p}return oi=i,Eo(),r}function Mg(t,i){ke=null,F.H=fr,i===is||i===Do?(i=Ym(),Fe=3):i===gu?(i=Ym(),Fe=4):Fe=i===Hu?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,sn=i,Ee===null&&(rt=1,Ko(t,hn(i,t.current)))}function Ng(){var t=nn.current;return t===null?!0:(Me&4194048)===Me?gn===null:(Me&62914560)===Me||(Me&536870912)!==0?t===gn:!1}function Og(){var t=F.H;return F.H=fr,t===null?fr:t}function Dg(){var t=F.A;return F.A=OT,t}function sl(){rt=4,Bi||(Me&4194048)!==Me&&nn.current!==null||(ds=!0),(zi&134217727)===0&&(Ra&134217727)===0||Xe===null||Vi(Xe,Me,rn,!1)}function fd(t,i,r){var c=Be;Be|=2;var h=Og(),p=Dg();(Xe!==t||Me!==i)&&(il=null,ms(t,i)),i=!1;var y=rt;e:do try{if(Fe!==0&&Ee!==null){var k=Ee,w=sn;switch(Fe){case 8:hd(),y=6;break e;case 3:case 2:case 9:case 6:nn.current===null&&(i=!0);var I=Fe;if(Fe=0,sn=null,ps(t,k,w,I),r&&ds){y=0;break e}break;default:I=Fe,Fe=0,sn=null,ps(t,k,w,I)}}LT(),y=rt;break}catch(G){Mg(t,G)}while(!0);return i&&t.shellSuspendCounter++,Wn=ba=null,Be=c,F.H=h,F.A=p,Ee===null&&(Xe=null,Me=0,Eo()),y}function LT(){for(;Ee!==null;)Pg(Ee)}function IT(t,i){var r=Be;Be|=2;var c=Og(),h=Dg();Xe!==t||Me!==i?(il=null,nl=Wt()+500,ms(t,i)):ds=Fs(t,i);e:do try{if(Fe!==0&&Ee!==null){i=Ee;var p=sn;t:switch(Fe){case 1:Fe=0,sn=null,ps(t,i,p,1);break;case 2:case 9:if(Hm(p)){Fe=0,sn=null,Lg(i);break}i=function(){Fe!==2&&Fe!==9||Xe!==t||(Fe=7),Un(t)},p.then(i,i);break e;case 3:Fe=7;break e;case 4:Fe=5;break e;case 7:Hm(p)?(Fe=0,sn=null,Lg(i)):(Fe=0,sn=null,ps(t,i,p,7));break;case 5:var y=null;switch(Ee.tag){case 26:y=Ee.memoizedState;case 5:case 27:var k=Ee;if(y?Sv(y):k.stateNode.complete){Fe=0,sn=null;var w=k.sibling;if(w!==null)Ee=w;else{var I=k.return;I!==null?(Ee=I,rl(I)):Ee=null}break t}}Fe=0,sn=null,ps(t,i,p,5);break;case 6:Fe=0,sn=null,ps(t,i,p,6);break;case 8:hd(),rt=6;break e;default:throw Error(s(462))}}jT();break}catch(G){Mg(t,G)}while(!0);return Wn=ba=null,F.H=c,F.A=h,Be=r,Ee!==null?0:(Xe=null,Me=0,Eo(),rt)}function jT(){for(;Ee!==null&&!rk();)Pg(Ee)}function Pg(t){var i=ag(t.alternate,t,oi);t.memoizedProps=t.pendingProps,i===null?rl(t):Ee=i}function Lg(t){var i=t,r=i.alternate;switch(i.tag){case 15:case 0:i=Zp(r,i,i.pendingProps,i.type,void 0,Me);break;case 11:i=Zp(r,i,i.pendingProps,i.type.render,i.ref,Me);break;case 5:Ru(i);default:rg(r,i),i=Ee=Dm(i,oi),i=ag(r,i,oi)}t.memoizedProps=t.pendingProps,i===null?rl(t):Ee=i}function ps(t,i,r,c){Wn=ba=null,Ru(i),as=null,sr=0;var h=i.return;try{if(ET(t,h,i,r,Me)){rt=1,Ko(t,hn(r,t.current)),Ee=null;return}}catch(p){if(h!==null)throw Ee=h,p;rt=1,Ko(t,hn(r,t.current)),Ee=null;return}i.flags&32768?(Pe||c===1?t=!0:ds||(Me&536870912)!==0?t=!1:(Bi=t=!0,(c===2||c===9||c===3||c===6)&&(c=nn.current,c!==null&&c.tag===13&&(c.flags|=16384))),Ig(i,t)):rl(i)}function rl(t){var i=t;do{if((i.flags&32768)!==0){Ig(i,Bi);return}t=i.return;var r=RT(i.alternate,i,oi);if(r!==null){Ee=r;return}if(i=i.sibling,i!==null){Ee=i;return}Ee=i=t}while(i!==null);rt===0&&(rt=5)}function Ig(t,i){do{var r=AT(t.alternate,t);if(r!==null){r.flags&=32767,Ee=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!i&&(t=t.sibling,t!==null)){Ee=t;return}Ee=t=r}while(t!==null);rt=6,Ee=null}function jg(t,i,r,c,h,p,y,k,w){t.cancelPendingCommit=null;do ol();while(yt!==0);if((Be&6)!==0)throw Error(s(327));if(i!==null){if(i===t.current)throw Error(s(177));if(p=i.lanes|i.childLanes,p|=tu,gk(t,r,p,y,k,w),t===Xe&&(Ee=Xe=null,Me=0),fs=i,Fi=t,li=r,cd=p,ud=h,wg=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,qT(lo,function(){return Fg(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=F.T,F.T=null,h=ae.p,ae.p=2,y=Be,Be|=4;try{MT(t,i,r)}finally{Be=y,ae.p=h,F.T=c}}yt=1,Ug(),Bg(),zg()}}function Ug(){if(yt===1){yt=0;var t=Fi,i=fs,r=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||r){r=F.T,F.T=null;var c=ae.p;ae.p=2;var h=Be;Be|=4;try{yg(i,t);var p=Ed,y=xm(t.containerInfo),k=p.focusedElem,w=p.selectionRange;if(y!==k&&k&&k.ownerDocument&&Cm(k.ownerDocument.documentElement,k)){if(w!==null&&Xc(k)){var I=w.start,G=w.end;if(G===void 0&&(G=I),"selectionStart"in k)k.selectionStart=I,k.selectionEnd=Math.min(G,k.value.length);else{var W=k.ownerDocument||document,U=W&&W.defaultView||window;if(U.getSelection){var q=U.getSelection(),ce=k.textContent.length,pe=Math.min(w.start,ce),Ye=w.end===void 0?pe:Math.min(w.end,ce);!q.extend&&pe>Ye&&(y=Ye,Ye=pe,pe=y);var O=Tm(k,pe),_=Tm(k,Ye);if(O&&_&&(q.rangeCount!==1||q.anchorNode!==O.node||q.anchorOffset!==O.offset||q.focusNode!==_.node||q.focusOffset!==_.offset)){var L=W.createRange();L.setStart(O.node,O.offset),q.removeAllRanges(),pe>Ye?(q.addRange(L),q.extend(_.node,_.offset)):(L.setEnd(_.node,_.offset),q.addRange(L))}}}}for(W=[],q=k;q=q.parentNode;)q.nodeType===1&&W.push({element:q,left:q.scrollLeft,top:q.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<W.length;k++){var Q=W[k];Q.element.scrollLeft=Q.left,Q.element.scrollTop=Q.top}}bl=!!xd,Ed=xd=null}finally{Be=h,ae.p=c,F.T=r}}t.current=i,yt=2}}function Bg(){if(yt===2){yt=0;var t=Fi,i=fs,r=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||r){r=F.T,F.T=null;var c=ae.p;ae.p=2;var h=Be;Be|=4;try{fg(t,i.alternate,i)}finally{Be=h,ae.p=c,F.T=r}}yt=3}}function zg(){if(yt===4||yt===3){yt=0,ok();var t=Fi,i=fs,r=li,c=wg;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?yt=5:(yt=0,fs=Fi=null,qg(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(qi=null),Nc(r),i=i.stateNode,Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(qs,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=F.T,h=ae.p,ae.p=2,F.T=null;try{for(var p=t.onRecoverableError,y=0;y<c.length;y++){var k=c[y];p(k.value,{componentStack:k.stack})}}finally{F.T=i,ae.p=h}}(li&3)!==0&&ol(),Un(t),h=t.pendingLanes,(r&261930)!==0&&(h&42)!==0?t===dd?Tr++:(Tr=0,dd=t):Tr=0,Cr(0)}}function qg(t,i){(t.pooledCacheLanes&=i)===0&&(i=t.pooledCache,i!=null&&(t.pooledCache=null,ir(i)))}function ol(){return Ug(),Bg(),zg(),Fg()}function Fg(){if(yt!==5)return!1;var t=Fi,i=cd;cd=0;var r=Nc(li),c=F.T,h=ae.p;try{ae.p=32>r?32:r,F.T=null,r=ud,ud=null;var p=Fi,y=li;if(yt=0,fs=Fi=null,li=0,(Be&6)!==0)throw Error(s(331));var k=Be;if(Be|=4,Cg(p.current),Sg(p,p.current,y,r),Be=k,Cr(0,!1),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(qs,p)}catch{}return!0}finally{ae.p=h,F.T=c,qg(t,i)}}function Vg(t,i,r){i=hn(r,i),i=Vu(t.stateNode,i,2),t=Li(t,i,2),t!==null&&(Vs(t,2),Un(t))}function Ve(t,i,r){if(t.tag===3)Vg(t,t,r);else for(;i!==null;){if(i.tag===3){Vg(i,t,r);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(qi===null||!qi.has(c))){t=hn(r,t),r=Hp(2),c=Li(i,r,2),c!==null&&(Gp(r,c,i,t),Vs(c,2),Un(c));break}}i=i.return}}function md(t,i,r){var c=t.pingCache;if(c===null){c=t.pingCache=new DT;var h=new Set;c.set(i,h)}else h=c.get(i),h===void 0&&(h=new Set,c.set(i,h));h.has(r)||(rd=!0,h.add(r),t=UT.bind(null,t,i,r),i.then(t,t))}function UT(t,i,r){var c=t.pingCache;c!==null&&c.delete(i),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,Xe===t&&(Me&r)===r&&(rt===4||rt===3&&(Me&62914560)===Me&&300>Wt()-tl?(Be&2)===0&&ms(t,0):od|=r,hs===Me&&(hs=0)),Un(t)}function Hg(t,i){i===0&&(i=Uf()),t=ga(t,i),t!==null&&(Vs(t,i),Un(t))}function BT(t){var i=t.memoizedState,r=0;i!==null&&(r=i.retryLane),Hg(t,r)}function zT(t,i){var r=0;switch(t.tag){case 31:case 13:var c=t.stateNode,h=t.memoizedState;h!==null&&(r=h.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(i),Hg(t,r)}function qT(t,i){return _c(t,i)}var ll=null,gs=null,pd=!1,cl=!1,gd=!1,Hi=0;function Un(t){t!==gs&&t.next===null&&(gs===null?ll=gs=t:gs=gs.next=t),cl=!0,pd||(pd=!0,VT())}function Cr(t,i){if(!gd&&cl){gd=!0;do for(var r=!1,c=ll;c!==null;){if(t!==0){var h=c.pendingLanes;if(h===0)var p=0;else{var y=c.suspendedLanes,k=c.pingedLanes;p=(1<<31-$t(42|t)+1)-1,p&=h&~(y&~k),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(r=!0,Qg(c,p))}else p=Me,p=fo(c,c===Xe?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Fs(c,p)||(r=!0,Qg(c,p));c=c.next}while(r);gd=!1}}function FT(){Gg()}function Gg(){cl=pd=!1;var t=0;Hi!==0&&$T()&&(t=Hi);for(var i=Wt(),r=null,c=ll;c!==null;){var h=c.next,p=Yg(c,i);p===0?(c.next=null,r===null?ll=h:r.next=h,h===null&&(gs=r)):(r=c,(t!==0||(p&3)!==0)&&(cl=!0)),c=h}yt!==0&&yt!==5||Cr(t),Hi!==0&&(Hi=0)}function Yg(t,i){for(var r=t.suspendedLanes,c=t.pingedLanes,h=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var y=31-$t(p),k=1<<y,w=h[y];w===-1?((k&r)===0||(k&c)!==0)&&(h[y]=pk(k,i)):w<=i&&(t.expiredLanes|=k),p&=~k}if(i=Xe,r=Me,r=fo(t,t===i?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,r===0||t===i&&(Fe===2||Fe===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Rc(c),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||Fs(t,r)){if(i=r&-r,i===t.callbackPriority)return i;switch(c!==null&&Rc(c),Nc(r)){case 2:case 8:r=If;break;case 32:r=lo;break;case 268435456:r=jf;break;default:r=lo}return c=Kg.bind(null,t),r=_c(r,c),t.callbackPriority=i,t.callbackNode=r,i}return c!==null&&c!==null&&Rc(c),t.callbackPriority=2,t.callbackNode=null,2}function Kg(t,i){if(yt!==0&&yt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var r=t.callbackNode;if(ol()&&t.callbackNode!==r)return null;var c=Me;return c=fo(t,t===Xe?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(Rg(t,c,i),Yg(t,Wt()),t.callbackNode!=null&&t.callbackNode===r?Kg.bind(null,t):null)}function Qg(t,i){if(ol())return null;Rg(t,i,!0)}function VT(){tC(function(){(Be&6)!==0?_c(Lf,FT):Gg()})}function vd(){if(Hi===0){var t=ts;t===0&&(t=co,co<<=1,(co&261888)===0&&(co=256)),Hi=t}return Hi}function Jg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:vo(""+t)}function Xg(t,i){var r=i.ownerDocument.createElement("input");return r.name=i.name,r.value=i.value,t.id&&r.setAttribute("form",t.id),i.parentNode.insertBefore(r,i),t=new FormData(t),r.parentNode.removeChild(r),t}function HT(t,i,r,c,h){if(i==="submit"&&r&&r.stateNode===h){var p=Jg((h[qt]||null).action),y=c.submitter;y&&(i=(i=y[qt]||null)?Jg(i.formAction):y.getAttribute("formAction"),i!==null&&(p=i,y=null));var k=new ko("action","action",null,c,h);t.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Hi!==0){var w=y?Xg(h,y):new FormData(h);ju(r,{pending:!0,data:w,method:h.method,action:p},null,w)}}else typeof p=="function"&&(k.preventDefault(),w=y?Xg(h,y):new FormData(h),ju(r,{pending:!0,data:w,method:h.method,action:p},p,w))},currentTarget:h}]})}}for(var yd=0;yd<eu.length;yd++){var bd=eu[yd],GT=bd.toLowerCase(),YT=bd[0].toUpperCase()+bd.slice(1);Cn(GT,"on"+YT)}Cn(_m,"onAnimationEnd"),Cn(Rm,"onAnimationIteration"),Cn(Am,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(lT,"onTransitionRun"),Cn(cT,"onTransitionStart"),Cn(uT,"onTransitionCancel"),Cn(Mm,"onTransitionEnd"),qa("onMouseEnter",["mouseout","mouseover"]),qa("onMouseLeave",["mouseout","mouseover"]),qa("onPointerEnter",["pointerout","pointerover"]),qa("onPointerLeave",["pointerout","pointerover"]),ha("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ha("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ha("onBeforeInput",["compositionend","keypress","textInput","paste"]),ha("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ha("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ha("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xr));function Wg(t,i){i=(i&4)!==0;for(var r=0;r<t.length;r++){var c=t[r],h=c.event;c=c.listeners;e:{var p=void 0;if(i)for(var y=c.length-1;0<=y;y--){var k=c[y],w=k.instance,I=k.currentTarget;if(k=k.listener,w!==p&&h.isPropagationStopped())break e;p=k,h.currentTarget=I;try{p(h)}catch(G){xo(G)}h.currentTarget=null,p=w}else for(y=0;y<c.length;y++){if(k=c[y],w=k.instance,I=k.currentTarget,k=k.listener,w!==p&&h.isPropagationStopped())break e;p=k,h.currentTarget=I;try{p(h)}catch(G){xo(G)}h.currentTarget=null,p=w}}}}function we(t,i){var r=i[Oc];r===void 0&&(r=i[Oc]=new Set);var c=t+"__bubble";r.has(c)||(Zg(i,t,2,!1),r.add(c))}function Sd(t,i,r){var c=0;i&&(c|=4),Zg(r,t,c,i)}var ul="_reactListening"+Math.random().toString(36).slice(2);function kd(t){if(!t[ul]){t[ul]=!0,Gf.forEach(function(r){r!=="selectionchange"&&(KT.has(r)||Sd(r,!1,t),Sd(r,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[ul]||(i[ul]=!0,Sd("selectionchange",!1,i))}}function Zg(t,i,r,c){switch(_v(i)){case 2:var h=kC;break;case 8:h=TC;break;default:h=Id}r=h.bind(null,i,r,t),h=void 0,!qc||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(h=!0),c?h!==void 0?t.addEventListener(i,r,{capture:!0,passive:h}):t.addEventListener(i,r,!0):h!==void 0?t.addEventListener(i,r,{passive:h}):t.addEventListener(i,r,!1)}function Td(t,i,r,c,h){var p=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var y=c.tag;if(y===3||y===4){var k=c.stateNode.containerInfo;if(k===h)break;if(y===4)for(y=c.return;y!==null;){var w=y.tag;if((w===3||w===4)&&y.stateNode.containerInfo===h)return;y=y.return}for(;k!==null;){if(y=Ua(k),y===null)return;if(w=y.tag,w===5||w===6||w===26||w===27){c=p=y;continue e}k=k.parentNode}}c=c.return}im(function(){var I=p,G=Bc(r),W=[];e:{var U=Nm.get(t);if(U!==void 0){var q=ko,ce=t;switch(t){case"keypress":if(bo(r)===0)break e;case"keydown":case"keyup":q=zk;break;case"focusin":ce="focus",q=Gc;break;case"focusout":ce="blur",q=Gc;break;case"beforeblur":case"afterblur":q=Gc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=rm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=Rk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Vk;break;case _m:case Rm:case Am:q=Nk;break;case Mm:q=Gk;break;case"scroll":case"scrollend":q=wk;break;case"wheel":q=Kk;break;case"copy":case"cut":case"paste":q=Dk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=lm;break;case"toggle":case"beforetoggle":q=Jk}var pe=(i&4)!==0,Ye=!pe&&(t==="scroll"||t==="scrollend"),O=pe?U!==null?U+"Capture":null:U;pe=[];for(var _=I,L;_!==null;){var Q=_;if(L=Q.stateNode,Q=Q.tag,Q!==5&&Q!==26&&Q!==27||L===null||O===null||(Q=Ys(_,O),Q!=null&&pe.push(Er(_,Q,L))),Ye)break;_=_.return}0<pe.length&&(U=new q(U,ce,null,r,G),W.push({event:U,listeners:pe}))}}if((i&7)===0){e:{if(U=t==="mouseover"||t==="pointerover",q=t==="mouseout"||t==="pointerout",U&&r!==Uc&&(ce=r.relatedTarget||r.fromElement)&&(Ua(ce)||ce[ja]))break e;if((q||U)&&(U=G.window===G?G:(U=G.ownerDocument)?U.defaultView||U.parentWindow:window,q?(ce=r.relatedTarget||r.toElement,q=I,ce=ce?Ua(ce):null,ce!==null&&(Ye=l(ce),pe=ce.tag,ce!==Ye||pe!==5&&pe!==27&&pe!==6)&&(ce=null)):(q=null,ce=I),q!==ce)){if(pe=rm,Q="onMouseLeave",O="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(pe=lm,Q="onPointerLeave",O="onPointerEnter",_="pointer"),Ye=q==null?U:Gs(q),L=ce==null?U:Gs(ce),U=new pe(Q,_+"leave",q,r,G),U.target=Ye,U.relatedTarget=L,Q=null,Ua(G)===I&&(pe=new pe(O,_+"enter",ce,r,G),pe.target=L,pe.relatedTarget=Ye,Q=pe),Ye=Q,q&&ce)t:{for(pe=QT,O=q,_=ce,L=0,Q=O;Q;Q=pe(Q))L++;Q=0;for(var me=_;me;me=pe(me))Q++;for(;0<L-Q;)O=pe(O),L--;for(;0<Q-L;)_=pe(_),Q--;for(;L--;){if(O===_||_!==null&&O===_.alternate){pe=O;break t}O=pe(O),_=pe(_)}pe=null}else pe=null;q!==null&&$g(W,U,q,pe,!1),ce!==null&&Ye!==null&&$g(W,Ye,ce,pe,!0)}}e:{if(U=I?Gs(I):window,q=U.nodeName&&U.nodeName.toLowerCase(),q==="select"||q==="input"&&U.type==="file")var Ie=gm;else if(mm(U))if(vm)Ie=sT;else{Ie=iT;var he=nT}else q=U.nodeName,!q||q.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?I&&jc(I.elementType)&&(Ie=gm):Ie=aT;if(Ie&&(Ie=Ie(t,I))){pm(W,Ie,r,G);break e}he&&he(t,U,I),t==="focusout"&&I&&U.type==="number"&&I.memoizedProps.value!=null&&Ic(U,"number",U.value)}switch(he=I?Gs(I):window,t){case"focusin":(mm(he)||he.contentEditable==="true")&&(Ka=he,Wc=I,er=null);break;case"focusout":er=Wc=Ka=null;break;case"mousedown":Zc=!0;break;case"contextmenu":case"mouseup":case"dragend":Zc=!1,Em(W,r,G);break;case"selectionchange":if(oT)break;case"keydown":case"keyup":Em(W,r,G)}var Te;if(Kc)e:{switch(t){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Ya?hm(t,r)&&(Ne="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(Ne="onCompositionStart");Ne&&(cm&&r.locale!=="ko"&&(Ya||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Ya&&(Te=am()):(Ri=G,Fc="value"in Ri?Ri.value:Ri.textContent,Ya=!0)),he=dl(I,Ne),0<he.length&&(Ne=new om(Ne,t,null,r,G),W.push({event:Ne,listeners:he}),Te?Ne.data=Te:(Te=fm(r),Te!==null&&(Ne.data=Te)))),(Te=Wk?Zk(t,r):$k(t,r))&&(Ne=dl(I,"onBeforeInput"),0<Ne.length&&(he=new om("onBeforeInput","beforeinput",null,r,G),W.push({event:he,listeners:Ne}),he.data=Te)),HT(W,t,I,r,G)}Wg(W,i)})}function Er(t,i,r){return{instance:t,listener:i,currentTarget:r}}function dl(t,i){for(var r=i+"Capture",c=[];t!==null;){var h=t,p=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||p===null||(h=Ys(t,r),h!=null&&c.unshift(Er(t,h,p)),h=Ys(t,i),h!=null&&c.push(Er(t,h,p))),t.tag===3)return c;t=t.return}return[]}function QT(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function $g(t,i,r,c,h){for(var p=i._reactName,y=[];r!==null&&r!==c;){var k=r,w=k.alternate,I=k.stateNode;if(k=k.tag,w!==null&&w===c)break;k!==5&&k!==26&&k!==27||I===null||(w=I,h?(I=Ys(r,p),I!=null&&y.unshift(Er(r,I,w))):h||(I=Ys(r,p),I!=null&&y.push(Er(r,I,w)))),r=r.return}y.length!==0&&t.push({event:i,listeners:y})}var JT=/\r\n?/g,XT=/\u0000|\uFFFD/g;function ev(t){return(typeof t=="string"?t:""+t).replace(JT,`
`).replace(XT,"")}function tv(t,i){return i=ev(i),ev(t)===i}function Ge(t,i,r,c,h,p){switch(r){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||Va(t,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&Va(t,""+c);break;case"className":po(t,"class",c);break;case"tabIndex":po(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":po(t,r,c);break;case"style":tm(t,c,p);break;case"data":if(i!=="object"){po(t,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||r!=="href")){t.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=vo(""+c),t.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(i!=="input"&&Ge(t,i,"name",h.name,h,null),Ge(t,i,"formEncType",h.formEncType,h,null),Ge(t,i,"formMethod",h.formMethod,h,null),Ge(t,i,"formTarget",h.formTarget,h,null)):(Ge(t,i,"encType",h.encType,h,null),Ge(t,i,"method",h.method,h,null),Ge(t,i,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=vo(""+c),t.setAttribute(r,c);break;case"onClick":c!=null&&(t.onclick=Kn);break;case"onScroll":c!=null&&we("scroll",t);break;case"onScrollEnd":c!=null&&we("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}r=vo(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""+c):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":c===!0?t.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,c):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(r,c):t.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(r):t.setAttribute(r,c);break;case"popover":we("beforetoggle",t),we("toggle",t),mo(t,"popover",c);break;case"xlinkActuate":Yn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Yn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Yn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Yn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Yn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Yn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Yn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Yn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Yn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":mo(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=xk.get(r)||r,mo(t,r,c))}}function Cd(t,i,r,c,h,p){switch(r){case"style":tm(t,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"children":typeof c=="string"?Va(t,c):(typeof c=="number"||typeof c=="bigint")&&Va(t,""+c);break;case"onScroll":c!=null&&we("scroll",t);break;case"onScrollEnd":c!=null&&we("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Kn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yf.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(h=r.endsWith("Capture"),i=r.slice(2,h?r.length-7:void 0),p=t[qt]||null,p=p!=null?p[r]:null,typeof p=="function"&&t.removeEventListener(i,p,h),typeof c=="function")){typeof p!="function"&&p!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(i,c,h);break e}r in t?t[r]=c:c===!0?t.setAttribute(r,""):mo(t,r,c)}}}function Ot(t,i,r){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":we("error",t),we("load",t);var c=!1,h=!1,p;for(p in r)if(r.hasOwnProperty(p)){var y=r[p];if(y!=null)switch(p){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Ge(t,i,p,y,r,null)}}h&&Ge(t,i,"srcSet",r.srcSet,r,null),c&&Ge(t,i,"src",r.src,r,null);return;case"input":we("invalid",t);var k=p=y=h=null,w=null,I=null;for(c in r)if(r.hasOwnProperty(c)){var G=r[c];if(G!=null)switch(c){case"name":h=G;break;case"type":y=G;break;case"checked":w=G;break;case"defaultChecked":I=G;break;case"value":p=G;break;case"defaultValue":k=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,i));break;default:Ge(t,i,c,G,r,null)}}Wf(t,p,k,w,I,y,h,!1);return;case"select":we("invalid",t),c=y=p=null;for(h in r)if(r.hasOwnProperty(h)&&(k=r[h],k!=null))switch(h){case"value":p=k;break;case"defaultValue":y=k;break;case"multiple":c=k;default:Ge(t,i,h,k,r,null)}i=p,r=y,t.multiple=!!c,i!=null?Fa(t,!!c,i,!1):r!=null&&Fa(t,!!c,r,!0);return;case"textarea":we("invalid",t),p=h=c=null;for(y in r)if(r.hasOwnProperty(y)&&(k=r[y],k!=null))switch(y){case"value":c=k;break;case"defaultValue":h=k;break;case"children":p=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(s(91));break;default:Ge(t,i,y,k,r,null)}$f(t,c,h,p);return;case"option":for(w in r)if(r.hasOwnProperty(w)&&(c=r[w],c!=null))switch(w){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Ge(t,i,w,c,r,null)}return;case"dialog":we("beforetoggle",t),we("toggle",t),we("cancel",t),we("close",t);break;case"iframe":case"object":we("load",t);break;case"video":case"audio":for(c=0;c<xr.length;c++)we(xr[c],t);break;case"image":we("error",t),we("load",t);break;case"details":we("toggle",t);break;case"embed":case"source":case"link":we("error",t),we("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(I in r)if(r.hasOwnProperty(I)&&(c=r[I],c!=null))switch(I){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Ge(t,i,I,c,r,null)}return;default:if(jc(i)){for(G in r)r.hasOwnProperty(G)&&(c=r[G],c!==void 0&&Cd(t,i,G,c,r,void 0));return}}for(k in r)r.hasOwnProperty(k)&&(c=r[k],c!=null&&Ge(t,i,k,c,r,null))}function WT(t,i,r,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,p=null,y=null,k=null,w=null,I=null,G=null;for(q in r){var W=r[q];if(r.hasOwnProperty(q)&&W!=null)switch(q){case"checked":break;case"value":break;case"defaultValue":w=W;default:c.hasOwnProperty(q)||Ge(t,i,q,null,c,W)}}for(var U in c){var q=c[U];if(W=r[U],c.hasOwnProperty(U)&&(q!=null||W!=null))switch(U){case"type":p=q;break;case"name":h=q;break;case"checked":I=q;break;case"defaultChecked":G=q;break;case"value":y=q;break;case"defaultValue":k=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(s(137,i));break;default:q!==W&&Ge(t,i,U,q,c,W)}}Lc(t,y,k,w,I,G,p,h);return;case"select":q=y=k=U=null;for(p in r)if(w=r[p],r.hasOwnProperty(p)&&w!=null)switch(p){case"value":break;case"multiple":q=w;default:c.hasOwnProperty(p)||Ge(t,i,p,null,c,w)}for(h in c)if(p=c[h],w=r[h],c.hasOwnProperty(h)&&(p!=null||w!=null))switch(h){case"value":U=p;break;case"defaultValue":k=p;break;case"multiple":y=p;default:p!==w&&Ge(t,i,h,p,c,w)}i=k,r=y,c=q,U!=null?Fa(t,!!r,U,!1):!!c!=!!r&&(i!=null?Fa(t,!!r,i,!0):Fa(t,!!r,r?[]:"",!1));return;case"textarea":q=U=null;for(k in r)if(h=r[k],r.hasOwnProperty(k)&&h!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Ge(t,i,k,null,c,h)}for(y in c)if(h=c[y],p=r[y],c.hasOwnProperty(y)&&(h!=null||p!=null))switch(y){case"value":U=h;break;case"defaultValue":q=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==p&&Ge(t,i,y,h,c,p)}Zf(t,U,q);return;case"option":for(var ce in r)if(U=r[ce],r.hasOwnProperty(ce)&&U!=null&&!c.hasOwnProperty(ce))switch(ce){case"selected":t.selected=!1;break;default:Ge(t,i,ce,null,c,U)}for(w in c)if(U=c[w],q=r[w],c.hasOwnProperty(w)&&U!==q&&(U!=null||q!=null))switch(w){case"selected":t.selected=U&&typeof U!="function"&&typeof U!="symbol";break;default:Ge(t,i,w,U,c,q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pe in r)U=r[pe],r.hasOwnProperty(pe)&&U!=null&&!c.hasOwnProperty(pe)&&Ge(t,i,pe,null,c,U);for(I in c)if(U=c[I],q=r[I],c.hasOwnProperty(I)&&U!==q&&(U!=null||q!=null))switch(I){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(s(137,i));break;default:Ge(t,i,I,U,c,q)}return;default:if(jc(i)){for(var Ye in r)U=r[Ye],r.hasOwnProperty(Ye)&&U!==void 0&&!c.hasOwnProperty(Ye)&&Cd(t,i,Ye,void 0,c,U);for(G in c)U=c[G],q=r[G],!c.hasOwnProperty(G)||U===q||U===void 0&&q===void 0||Cd(t,i,G,U,c,q);return}}for(var O in r)U=r[O],r.hasOwnProperty(O)&&U!=null&&!c.hasOwnProperty(O)&&Ge(t,i,O,null,c,U);for(W in c)U=c[W],q=r[W],!c.hasOwnProperty(W)||U===q||U==null&&q==null||Ge(t,i,W,U,c,q)}function nv(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ZT(){if(typeof performance.getEntriesByType=="function"){for(var t=0,i=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var h=r[c],p=h.transferSize,y=h.initiatorType,k=h.duration;if(p&&k&&nv(y)){for(y=0,k=h.responseEnd,c+=1;c<r.length;c++){var w=r[c],I=w.startTime;if(I>k)break;var G=w.transferSize,W=w.initiatorType;G&&nv(W)&&(w=w.responseEnd,y+=G*(w<k?1:(k-I)/(w-I)))}if(--c,i+=8*(p+y)/(h.duration/1e3),t++,10<t)break}}if(0<t)return i/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var xd=null,Ed=null;function hl(t){return t.nodeType===9?t:t.ownerDocument}function iv(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function av(t,i){if(t===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&i==="foreignObject"?0:t}function wd(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var _d=null;function $T(){var t=window.event;return t&&t.type==="popstate"?t===_d?!1:(_d=t,!0):(_d=null,!1)}var sv=typeof setTimeout=="function"?setTimeout:void 0,eC=typeof clearTimeout=="function"?clearTimeout:void 0,rv=typeof Promise=="function"?Promise:void 0,tC=typeof queueMicrotask=="function"?queueMicrotask:typeof rv<"u"?function(t){return rv.resolve(null).then(t).catch(nC)}:sv;function nC(t){setTimeout(function(){throw t})}function Gi(t){return t==="head"}function ov(t,i){var r=i,c=0;do{var h=r.nextSibling;if(t.removeChild(r),h&&h.nodeType===8)if(r=h.data,r==="/$"||r==="/&"){if(c===0){t.removeChild(h),Ss(i);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")wr(t.ownerDocument.documentElement);else if(r==="head"){r=t.ownerDocument.head,wr(r);for(var p=r.firstChild;p;){var y=p.nextSibling,k=p.nodeName;p[Hs]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&p.rel.toLowerCase()==="stylesheet"||r.removeChild(p),p=y}}else r==="body"&&wr(t.ownerDocument.body);r=h}while(r);Ss(i)}function lv(t,i){var r=t;t=0;do{var c=r.nextSibling;if(r.nodeType===1?i?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(i?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(t===0)break;t--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||t++;r=c}while(r)}function Rd(t){var i=t.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var r=i;switch(i=i.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Rd(r),Dc(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function iC(t,i,r,c){for(;t.nodeType===1;){var h=r;if(t.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Hs])switch(i){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(i==="input"&&t.type==="hidden"){var p=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=vn(t.nextSibling),t===null)break}return null}function aC(t,i,r){if(i==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=vn(t.nextSibling),t===null))return null;return t}function cv(t,i){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=vn(t.nextSibling),t===null))return null;return t}function Ad(t){return t.data==="$?"||t.data==="$~"}function Md(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function sC(t,i){var r=t.ownerDocument;if(t.data==="$~")t._reactRetry=i;else if(t.data!=="$?"||r.readyState!=="loading")i();else{var c=function(){i(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function vn(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return t}var Nd=null;function uv(t){t=t.nextSibling;for(var i=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"||r==="/&"){if(i===0)return vn(t.nextSibling);i--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||i++}t=t.nextSibling}return null}function dv(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(i===0)return t;i--}else r!=="/$"&&r!=="/&"||i++}t=t.previousSibling}return null}function hv(t,i,r){switch(i=hl(r),t){case"html":if(t=i.documentElement,!t)throw Error(s(452));return t;case"head":if(t=i.head,!t)throw Error(s(453));return t;case"body":if(t=i.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function wr(t){for(var i=t.attributes;i.length;)t.removeAttributeNode(i[0]);Dc(t)}var yn=new Map,fv=new Set;function fl(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var ci=ae.d;ae.d={f:rC,r:oC,D:lC,C:cC,L:uC,m:dC,X:fC,S:hC,M:mC};function rC(){var t=ci.f(),i=al();return t||i}function oC(t){var i=Ba(t);i!==null&&i.tag===5&&i.type==="form"?Mp(i):ci.r(t)}var vs=typeof document>"u"?null:document;function mv(t,i,r){var c=vs;if(c&&typeof i=="string"&&i){var h=un(i);h='link[rel="'+t+'"][href="'+h+'"]',typeof r=="string"&&(h+='[crossorigin="'+r+'"]'),fv.has(h)||(fv.add(h),t={rel:t,crossOrigin:r,href:i},c.querySelector(h)===null&&(i=c.createElement("link"),Ot(i,"link",t),Ct(i),c.head.appendChild(i)))}}function lC(t){ci.D(t),mv("dns-prefetch",t,null)}function cC(t,i){ci.C(t,i),mv("preconnect",t,i)}function uC(t,i,r){ci.L(t,i,r);var c=vs;if(c&&t&&i){var h='link[rel="preload"][as="'+un(i)+'"]';i==="image"&&r&&r.imageSrcSet?(h+='[imagesrcset="'+un(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(h+='[imagesizes="'+un(r.imageSizes)+'"]')):h+='[href="'+un(t)+'"]';var p=h;switch(i){case"style":p=ys(t);break;case"script":p=bs(t)}yn.has(p)||(t=v({rel:"preload",href:i==="image"&&r&&r.imageSrcSet?void 0:t,as:i},r),yn.set(p,t),c.querySelector(h)!==null||i==="style"&&c.querySelector(_r(p))||i==="script"&&c.querySelector(Rr(p))||(i=c.createElement("link"),Ot(i,"link",t),Ct(i),c.head.appendChild(i)))}}function dC(t,i){ci.m(t,i);var r=vs;if(r&&t){var c=i&&typeof i.as=="string"?i.as:"script",h='link[rel="modulepreload"][as="'+un(c)+'"][href="'+un(t)+'"]',p=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=bs(t)}if(!yn.has(p)&&(t=v({rel:"modulepreload",href:t},i),yn.set(p,t),r.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Rr(p)))return}c=r.createElement("link"),Ot(c,"link",t),Ct(c),r.head.appendChild(c)}}}function hC(t,i,r){ci.S(t,i,r);var c=vs;if(c&&t){var h=za(c).hoistableStyles,p=ys(t);i=i||"default";var y=h.get(p);if(!y){var k={loading:0,preload:null};if(y=c.querySelector(_r(p)))k.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":i},r),(r=yn.get(p))&&Od(t,r);var w=y=c.createElement("link");Ct(w),Ot(w,"link",t),w._p=new Promise(function(I,G){w.onload=I,w.onerror=G}),w.addEventListener("load",function(){k.loading|=1}),w.addEventListener("error",function(){k.loading|=2}),k.loading|=4,ml(y,i,c)}y={type:"stylesheet",instance:y,count:1,state:k},h.set(p,y)}}}function fC(t,i){ci.X(t,i);var r=vs;if(r&&t){var c=za(r).hoistableScripts,h=bs(t),p=c.get(h);p||(p=r.querySelector(Rr(h)),p||(t=v({src:t,async:!0},i),(i=yn.get(h))&&Dd(t,i),p=r.createElement("script"),Ct(p),Ot(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(h,p))}}function mC(t,i){ci.M(t,i);var r=vs;if(r&&t){var c=za(r).hoistableScripts,h=bs(t),p=c.get(h);p||(p=r.querySelector(Rr(h)),p||(t=v({src:t,async:!0,type:"module"},i),(i=yn.get(h))&&Dd(t,i),p=r.createElement("script"),Ct(p),Ot(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(h,p))}}function pv(t,i,r,c){var h=(h=ye.current)?fl(h):null;if(!h)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(i=ys(r.href),r=za(h).hoistableStyles,c=r.get(i),c||(c={type:"style",instance:null,count:0,state:null},r.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=ys(r.href);var p=za(h).hoistableStyles,y=p.get(t);if(y||(h=h.ownerDocument||h,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,y),(p=h.querySelector(_r(t)))&&!p._p&&(y.instance=p,y.state.loading=5),yn.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},yn.set(t,r),p||pC(h,t,r,y.state))),i&&c===null)throw Error(s(528,""));return y}if(i&&c!==null)throw Error(s(529,""));return null;case"script":return i=r.async,r=r.src,typeof r=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=bs(r),r=za(h).hoistableScripts,c=r.get(i),c||(c={type:"script",instance:null,count:0,state:null},r.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function ys(t){return'href="'+un(t)+'"'}function _r(t){return'link[rel="stylesheet"]['+t+"]"}function gv(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function pC(t,i,r,c){t.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=t.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),Ot(i,"link",r),Ct(i),t.head.appendChild(i))}function bs(t){return'[src="'+un(t)+'"]'}function Rr(t){return"script[async]"+t}function vv(t,i,r){if(i.count++,i.instance===null)switch(i.type){case"style":var c=t.querySelector('style[data-href~="'+un(r.href)+'"]');if(c)return i.instance=c,Ct(c),c;var h=v({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),Ct(c),Ot(c,"style",h),ml(c,r.precedence,t),i.instance=c;case"stylesheet":h=ys(r.href);var p=t.querySelector(_r(h));if(p)return i.state.loading|=4,i.instance=p,Ct(p),p;c=gv(r),(h=yn.get(h))&&Od(c,h),p=(t.ownerDocument||t).createElement("link"),Ct(p);var y=p;return y._p=new Promise(function(k,w){y.onload=k,y.onerror=w}),Ot(p,"link",c),i.state.loading|=4,ml(p,r.precedence,t),i.instance=p;case"script":return p=bs(r.src),(h=t.querySelector(Rr(p)))?(i.instance=h,Ct(h),h):(c=r,(h=yn.get(p))&&(c=v({},r),Dd(c,h)),t=t.ownerDocument||t,h=t.createElement("script"),Ct(h),Ot(h,"link",c),t.head.appendChild(h),i.instance=h);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,ml(c,r.precedence,t));return i.instance}function ml(t,i,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,p=h,y=0;y<c.length;y++){var k=c[y];if(k.dataset.precedence===i)p=k;else if(p!==h)break}p?p.parentNode.insertBefore(t,p.nextSibling):(i=r.nodeType===9?r.head:r,i.insertBefore(t,i.firstChild))}function Od(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.title==null&&(t.title=i.title)}function Dd(t,i){t.crossOrigin==null&&(t.crossOrigin=i.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=i.referrerPolicy),t.integrity==null&&(t.integrity=i.integrity)}var pl=null;function yv(t,i,r){if(pl===null){var c=new Map,h=pl=new Map;h.set(r,c)}else h=pl,c=h.get(r),c||(c=new Map,h.set(r,c));if(c.has(t))return c;for(c.set(t,null),r=r.getElementsByTagName(t),h=0;h<r.length;h++){var p=r[h];if(!(p[Hs]||p[Rt]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var y=p.getAttribute(i)||"";y=t+y;var k=c.get(y);k?k.push(p):c.set(y,[p])}}return c}function bv(t,i,r){t=t.ownerDocument||t,t.head.insertBefore(r,i==="title"?t.querySelector("head > title"):null)}function gC(t,i,r){if(r===1||i.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return t=i.disabled,typeof i.precedence=="string"&&t==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Sv(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function vC(t,i,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var h=ys(c.href),p=i.querySelector(_r(h));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(t.count++,t=gl.bind(t),i.then(t,t)),r.state.loading|=4,r.instance=p,Ct(p);return}p=i.ownerDocument||i,c=gv(c),(h=yn.get(h))&&Od(c,h),p=p.createElement("link"),Ct(p);var y=p;y._p=new Promise(function(k,w){y.onload=k,y.onerror=w}),Ot(p,"link",c),r.instance=p}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(r,i),(i=r.state.preload)&&(r.state.loading&3)===0&&(t.count++,r=gl.bind(t),i.addEventListener("load",r),i.addEventListener("error",r))}}var Pd=0;function yC(t,i){return t.stylesheets&&t.count===0&&yl(t,t.stylesheets),0<t.count||0<t.imgCount?function(r){var c=setTimeout(function(){if(t.stylesheets&&yl(t,t.stylesheets),t.unsuspend){var p=t.unsuspend;t.unsuspend=null,p()}},6e4+i);0<t.imgBytes&&Pd===0&&(Pd=62500*ZT());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&yl(t,t.stylesheets),t.unsuspend)){var p=t.unsuspend;t.unsuspend=null,p()}},(t.imgBytes>Pd?50:800)+i);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(h)}}:null}function gl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yl(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var vl=null;function yl(t,i){t.stylesheets=null,t.unsuspend!==null&&(t.count++,vl=new Map,i.forEach(bC,t),vl=null,gl.call(t))}function bC(t,i){if(!(i.state.loading&4)){var r=vl.get(t);if(r)var c=r.get(null);else{r=new Map,vl.set(t,r);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<h.length;p++){var y=h[p];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(r.set(y.dataset.precedence,y),c=y)}c&&r.set(null,c)}h=i.instance,y=h.getAttribute("data-precedence"),p=r.get(y)||c,p===c&&r.set(null,h),r.set(y,h),this.count++,c=gl.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),p?p.parentNode.insertBefore(h,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),i.state.loading|=4}}var Ar={$$typeof:P,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function SC(t,i,r,c,h,p,y,k,w){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ac(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ac(0),this.hiddenUpdates=Ac(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=p,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function kv(t,i,r,c,h,p,y,k,w,I,G,W){return t=new SC(t,i,r,y,w,I,G,W,k),i=1,p===!0&&(i|=24),p=tn(3,null,null,i),t.current=p,p.stateNode=t,i=fu(),i.refCount++,t.pooledCache=i,i.refCount++,p.memoizedState={element:c,isDehydrated:r,cache:i},vu(p),t}function Tv(t){return t?(t=Xa,t):Xa}function Cv(t,i,r,c,h,p){h=Tv(h),c.context===null?c.context=h:c.pendingContext=h,c=Pi(i),c.payload={element:r},p=p===void 0?null:p,p!==null&&(c.callback=p),r=Li(t,c,i),r!==null&&(Kt(r,t,i),or(r,t,i))}function xv(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<i?r:i}}function Ld(t,i){xv(t,i),(t=t.alternate)&&xv(t,i)}function Ev(t){if(t.tag===13||t.tag===31){var i=ga(t,67108864);i!==null&&Kt(i,t,67108864),Ld(t,67108864)}}function wv(t){if(t.tag===13||t.tag===31){var i=on();i=Mc(i);var r=ga(t,i);r!==null&&Kt(r,t,i),Ld(t,i)}}var bl=!0;function kC(t,i,r,c){var h=F.T;F.T=null;var p=ae.p;try{ae.p=2,Id(t,i,r,c)}finally{ae.p=p,F.T=h}}function TC(t,i,r,c){var h=F.T;F.T=null;var p=ae.p;try{ae.p=8,Id(t,i,r,c)}finally{ae.p=p,F.T=h}}function Id(t,i,r,c){if(bl){var h=jd(c);if(h===null)Td(t,i,c,Sl,r),Rv(t,c);else if(xC(h,t,i,r,c))c.stopPropagation();else if(Rv(t,c),i&4&&-1<CC.indexOf(t)){for(;h!==null;){var p=Ba(h);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var y=da(p.pendingLanes);if(y!==0){var k=p;for(k.pendingLanes|=2,k.entangledLanes|=2;y;){var w=1<<31-$t(y);k.entanglements[1]|=w,y&=~w}Un(p),(Be&6)===0&&(nl=Wt()+500,Cr(0))}}break;case 31:case 13:k=ga(p,2),k!==null&&Kt(k,p,2),al(),Ld(p,2)}if(p=jd(c),p===null&&Td(t,i,c,Sl,r),p===h)break;h=p}h!==null&&c.stopPropagation()}else Td(t,i,c,null,r)}}function jd(t){return t=Bc(t),Ud(t)}var Sl=null;function Ud(t){if(Sl=null,t=Ua(t),t!==null){var i=l(t);if(i===null)t=null;else{var r=i.tag;if(r===13){if(t=u(i),t!==null)return t;t=null}else if(r===31){if(t=d(i),t!==null)return t;t=null}else if(r===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null)}}return Sl=t,null}function _v(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lk()){case Lf:return 2;case If:return 8;case lo:case ck:return 32;case jf:return 268435456;default:return 32}default:return 32}}var Bd=!1,Yi=null,Ki=null,Qi=null,Mr=new Map,Nr=new Map,Ji=[],CC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rv(t,i){switch(t){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":Ki=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":Mr.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nr.delete(i.pointerId)}}function Or(t,i,r,c,h,p){return t===null||t.nativeEvent!==p?(t={blockedOn:i,domEventName:r,eventSystemFlags:c,nativeEvent:p,targetContainers:[h]},i!==null&&(i=Ba(i),i!==null&&Ev(i)),t):(t.eventSystemFlags|=c,i=t.targetContainers,h!==null&&i.indexOf(h)===-1&&i.push(h),t)}function xC(t,i,r,c,h){switch(i){case"focusin":return Yi=Or(Yi,t,i,r,c,h),!0;case"dragenter":return Ki=Or(Ki,t,i,r,c,h),!0;case"mouseover":return Qi=Or(Qi,t,i,r,c,h),!0;case"pointerover":var p=h.pointerId;return Mr.set(p,Or(Mr.get(p)||null,t,i,r,c,h)),!0;case"gotpointercapture":return p=h.pointerId,Nr.set(p,Or(Nr.get(p)||null,t,i,r,c,h)),!0}return!1}function Av(t){var i=Ua(t.target);if(i!==null){var r=l(i);if(r!==null){if(i=r.tag,i===13){if(i=u(r),i!==null){t.blockedOn=i,Vf(t.priority,function(){wv(r)});return}}else if(i===31){if(i=d(r),i!==null){t.blockedOn=i,Vf(t.priority,function(){wv(r)});return}}else if(i===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kl(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var r=jd(t.nativeEvent);if(r===null){r=t.nativeEvent;var c=new r.constructor(r.type,r);Uc=c,r.target.dispatchEvent(c),Uc=null}else return i=Ba(r),i!==null&&Ev(i),t.blockedOn=r,!1;i.shift()}return!0}function Mv(t,i,r){kl(t)&&r.delete(i)}function EC(){Bd=!1,Yi!==null&&kl(Yi)&&(Yi=null),Ki!==null&&kl(Ki)&&(Ki=null),Qi!==null&&kl(Qi)&&(Qi=null),Mr.forEach(Mv),Nr.forEach(Mv)}function Tl(t,i){t.blockedOn===i&&(t.blockedOn=null,Bd||(Bd=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,EC)))}var Cl=null;function Nv(t){Cl!==t&&(Cl=t,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Cl===t&&(Cl=null);for(var i=0;i<t.length;i+=3){var r=t[i],c=t[i+1],h=t[i+2];if(typeof c!="function"){if(Ud(c||r)===null)continue;break}var p=Ba(r);p!==null&&(t.splice(i,3),i-=3,ju(p,{pending:!0,data:h,method:r.method,action:c},c,h))}}))}function Ss(t){function i(w){return Tl(w,t)}Yi!==null&&Tl(Yi,t),Ki!==null&&Tl(Ki,t),Qi!==null&&Tl(Qi,t),Mr.forEach(i),Nr.forEach(i);for(var r=0;r<Ji.length;r++){var c=Ji[r];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Ji.length&&(r=Ji[0],r.blockedOn===null);)Av(r),r.blockedOn===null&&Ji.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var h=r[c],p=r[c+1],y=h[qt]||null;if(typeof p=="function")y||Nv(r);else if(y){var k=null;if(p&&p.hasAttribute("formAction")){if(h=p,y=p[qt]||null)k=y.formAction;else if(Ud(h)!==null)continue}else k=y.action;typeof k=="function"?r[c+1]=k:(r.splice(c,3),c-=3),Nv(r)}}}function Ov(){function t(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(y){return h=y})},focusReset:"manual",scroll:"manual"})}function i(){h!==null&&(h(),h=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),h!==null&&(h(),h=null)}}}function zd(t){this._internalRoot=t}xl.prototype.render=zd.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(s(409));var r=i.current,c=on();Cv(r,c,t,i,null,null)},xl.prototype.unmount=zd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;Cv(t.current,2,null,t,null,null),al(),i[ja]=null}};function xl(t){this._internalRoot=t}xl.prototype.unstable_scheduleHydration=function(t){if(t){var i=Ff();t={blockedOn:null,target:t,priority:i};for(var r=0;r<Ji.length&&i!==0&&i<Ji[r].priority;r++);Ji.splice(r,0,t),r===0&&Av(t)}};var Dv=e.version;if(Dv!=="19.2.0")throw Error(s(527,Dv,"19.2.0"));ae.findDOMNode=function(t){var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=m(i),t=t!==null?g(t):null,t=t===null?null:t.stateNode,t};var wC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var El=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!El.isDisabled&&El.supportsFiber)try{qs=El.inject(wC),Zt=El}catch{}}return Pr.createRoot=function(t,i){if(!o(t))throw Error(s(299));var r=!1,c="",h=zp,p=qp,y=Fp;return i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(h=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=kv(t,1,!1,null,null,r,c,null,h,p,y,Ov),t[ja]=i.current,kd(t),new zd(i)},Pr.hydrateRoot=function(t,i,r){if(!o(t))throw Error(s(299));var c=!1,h="",p=zp,y=qp,k=Fp,w=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(k=r.onRecoverableError),r.formState!==void 0&&(w=r.formState)),i=kv(t,1,!0,i,r??null,c,h,w,p,y,k,Ov),i.context=Tv(null),r=i.current,c=on(),c=Mc(c),h=Pi(c),h.callback=null,Li(r,h,c),r=c,i.current.lanes=r,Vs(i,r),Un(i),t[ja]=i.current,kd(t),new xl(i)},Pr.version="19.2.0",Pr}var Vv;function UC(){if(Vv)return Hd.exports;Vv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),Hd.exports=jC(),Hd.exports}var BC=UC();/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Hv="popstate";function zC(a={}){function e(s,o){let{pathname:l,search:u,hash:d}=s.location;return Sh("",{pathname:l,search:u,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){return typeof o=="string"?o:Xr(o)}return FC(e,n,null,a)}function at(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function On(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qC(){return Math.random().toString(36).substring(2,10)}function Gv(a,e){return{usr:a.state,key:a.key,idx:e}}function Sh(a,e,n=null,s){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?js(e):e,state:n,key:e&&e.key||s||qC()}}function Xr({pathname:a="/",search:e="",hash:n=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(a+=n.charAt(0)==="#"?n:"#"+n),a}function js(a){let e={};if(a){let n=a.indexOf("#");n>=0&&(e.hash=a.substring(n),a=a.substring(0,n));let s=a.indexOf("?");s>=0&&(e.search=a.substring(s),a=a.substring(0,s)),a&&(e.pathname=a)}return e}function FC(a,e,n,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,u=o.history,d="POP",f=null,m=g();m==null&&(m=0,u.replaceState({...u.state,idx:m},""));function g(){return(u.state||{idx:null}).idx}function v(){d="POP";let D=g(),M=D==null?null:D-m;m=D,f&&f({action:d,location:E.location,delta:M})}function S(D,M){d="PUSH";let Y=Sh(E.location,D,M);m=g()+1;let P=Gv(Y,m),A=E.createHref(Y);try{u.pushState(P,"",A)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;o.location.assign(A)}l&&f&&f({action:d,location:E.location,delta:1})}function T(D,M){d="REPLACE";let Y=Sh(E.location,D,M);m=g();let P=Gv(Y,m),A=E.createHref(Y);u.replaceState(P,"",A),l&&f&&f({action:d,location:E.location,delta:0})}function x(D){return VC(D)}let E={get action(){return d},get location(){return a(o,u)},listen(D){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(Hv,v),f=D,()=>{o.removeEventListener(Hv,v),f=null}},createHref(D){return e(o,D)},createURL:x,encodeLocation(D){let M=x(D);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:S,replace:T,go(D){return u.go(D)}};return E}function VC(a,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),at(n,"No window.location.(origin|href) available to create URL");let s=typeof a=="string"?a:Xr(a);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function Cy(a,e,n="/"){return HC(a,e,n,!1)}function HC(a,e,n,s){let o=typeof e=="string"?js(e):e,l=Si(o.pathname||"/",n);if(l==null)return null;let u=xy(a);GC(u);let d=null;for(let f=0;d==null&&f<u.length;++f){let m=nx(l);d=ex(u[f],m,s)}return d}function xy(a,e=[],n=[],s="",o=!1){let l=(u,d,f=o,m)=>{let g={relativePath:m===void 0?u.path||"":m,caseSensitive:u.caseSensitive===!0,childrenIndex:d,route:u};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(s)&&f)return;at(g.relativePath.startsWith(s),`Absolute route path "${g.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(s.length)}let v=bi([s,g.relativePath]),S=n.concat(g);u.children&&u.children.length>0&&(at(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),xy(u.children,e,S,v,f)),!(u.path==null&&!u.index)&&e.push({path:v,score:ZC(v,u.index),routesMeta:S})};return a.forEach((u,d)=>{var f;if(u.path===""||!((f=u.path)!=null&&f.includes("?")))l(u,d);else for(let m of Ey(u.path))l(u,d,!0,m)}),e}function Ey(a){let e=a.split("/");if(e.length===0)return[];let[n,...s]=e,o=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let u=Ey(s.join("/")),d=[];return d.push(...u.map(f=>f===""?l:[l,f].join("/"))),o&&d.push(...u),d.map(f=>a.startsWith("/")&&f===""?"/":f)}function GC(a){a.sort((e,n)=>e.score!==n.score?n.score-e.score:$C(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var YC=/^:[\w-]+$/,KC=3,QC=2,JC=1,XC=10,WC=-2,Yv=a=>a==="*";function ZC(a,e){let n=a.split("/"),s=n.length;return n.some(Yv)&&(s+=WC),e&&(s+=QC),n.filter(o=>!Yv(o)).reduce((o,l)=>o+(YC.test(l)?KC:l===""?JC:XC),s)}function $C(a,e){return a.length===e.length&&a.slice(0,-1).every((s,o)=>s===e[o])?a[a.length-1]-e[e.length-1]:0}function ex(a,e,n=!1){let{routesMeta:s}=a,o={},l="/",u=[];for(let d=0;d<s.length;++d){let f=s[d],m=d===s.length-1,g=l==="/"?e:e.slice(l.length)||"/",v=Jl({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g),S=f.route;if(!v&&m&&n&&!s[s.length-1].route.index&&(v=Jl({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!v)return null;Object.assign(o,v.params),u.push({params:o,pathname:bi([l,v.pathname]),pathnameBase:ox(bi([l,v.pathnameBase])),route:S}),v.pathnameBase!=="/"&&(l=bi([l,v.pathnameBase]))}return u}function Jl(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[n,s]=tx(a.path,a.caseSensitive,a.end),o=e.match(n);if(!o)return null;let l=o[0],u=l.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((m,{paramName:g,isOptional:v},S)=>{if(g==="*"){let x=d[S]||"";u=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const T=d[S];return v&&!T?m[g]=void 0:m[g]=(T||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:u,pattern:a}}function tx(a,e=!1,n=!0){On(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let s=[],o="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,f)=>(s.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(s.push({paramName:"*"}),o+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":a!==""&&a!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function nx(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return On(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function Si(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=a.charAt(n);return s&&s!=="/"?null:a.slice(n)||"/"}var ix=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ax=a=>ix.test(a);function sx(a,e="/"){let{pathname:n,search:s="",hash:o=""}=typeof a=="string"?js(a):a,l;if(n)if(ax(n))l=n;else{if(n.includes("//")){let u=n;n=n.replace(/\/\/+/g,"/"),On(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${n}`)}n.startsWith("/")?l=Kv(n.substring(1),"/"):l=Kv(n,e)}else l=e;return{pathname:l,search:lx(s),hash:cx(o)}}function Kv(a,e){let n=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Kd(a,e,n,s){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rx(a){return a.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wy(a){let e=rx(a);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function _y(a,e,n,s=!1){let o;typeof a=="string"?o=js(a):(o={...a},at(!o.pathname||!o.pathname.includes("?"),Kd("?","pathname","search",o)),at(!o.pathname||!o.pathname.includes("#"),Kd("#","pathname","hash",o)),at(!o.search||!o.search.includes("#"),Kd("#","search","hash",o)));let l=a===""||o.pathname==="",u=l?"/":o.pathname,d;if(u==null)d=n;else{let v=e.length-1;if(!s&&u.startsWith("..")){let S=u.split("/");for(;S[0]==="..";)S.shift(),v-=1;o.pathname=S.join("/")}d=v>=0?e[v]:"/"}let f=sx(o,d),m=u&&u!=="/"&&u.endsWith("/"),g=(l||u===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||g)&&(f.pathname+="/"),f}var bi=a=>a.join("/").replace(/\/\/+/g,"/"),ox=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),lx=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,cx=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function ux(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ry=["POST","PUT","PATCH","DELETE"];new Set(Ry);var dx=["GET",...Ry];new Set(dx);var Us=B.createContext(null);Us.displayName="DataRouter";var fc=B.createContext(null);fc.displayName="DataRouterState";B.createContext(!1);var Ay=B.createContext({isTransitioning:!1});Ay.displayName="ViewTransition";var hx=B.createContext(new Map);hx.displayName="Fetchers";var fx=B.createContext(null);fx.displayName="Await";var Hn=B.createContext(null);Hn.displayName="Navigation";var so=B.createContext(null);so.displayName="Location";var Ti=B.createContext({outlet:null,matches:[],isDataRoute:!1});Ti.displayName="Route";var Zh=B.createContext(null);Zh.displayName="RouteError";function mx(a,{relative:e}={}){at(ro(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=B.useContext(Hn),{hash:o,pathname:l,search:u}=oo(a,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:bi([n,l])),s.createHref({pathname:d,search:u,hash:o})}function ro(){return B.useContext(so)!=null}function La(){return at(ro(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(so).location}var My="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ny(a){B.useContext(Hn).static||B.useLayoutEffect(a)}function Oy(){let{isDataRoute:a}=B.useContext(Ti);return a?_x():px()}function px(){at(ro(),"useNavigate() may be used only in the context of a <Router> component.");let a=B.useContext(Us),{basename:e,navigator:n}=B.useContext(Hn),{matches:s}=B.useContext(Ti),{pathname:o}=La(),l=JSON.stringify(wy(s)),u=B.useRef(!1);return Ny(()=>{u.current=!0}),B.useCallback((f,m={})=>{if(On(u.current,My),!u.current)return;if(typeof f=="number"){n.go(f);return}let g=_y(f,JSON.parse(l),o,m.relative==="path");a==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:bi([e,g.pathname])),(m.replace?n.replace:n.push)(g,m.state,m)},[e,n,l,o,a])}B.createContext(null);function oo(a,{relative:e}={}){let{matches:n}=B.useContext(Ti),{pathname:s}=La(),o=JSON.stringify(wy(n));return B.useMemo(()=>_y(a,JSON.parse(o),s,e==="path"),[a,o,s,e])}function gx(a,e){return Dy(a,e)}function Dy(a,e,n,s,o){var Y;at(ro(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=B.useContext(Hn),{matches:u}=B.useContext(Ti),d=u[u.length-1],f=d?d.params:{},m=d?d.pathname:"/",g=d?d.pathnameBase:"/",v=d&&d.route;{let P=v&&v.path||"";Py(m,!v||P.endsWith("*")||P.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${P}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${P}"> to <Route path="${P==="/"?"*":`${P}/*`}">.`)}let S=La(),T;if(e){let P=typeof e=="string"?js(e):e;at(g==="/"||((Y=P.pathname)==null?void 0:Y.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${P.pathname}" was given in the \`location\` prop.`),T=P}else T=S;let x=T.pathname||"/",E=x;if(g!=="/"){let P=g.replace(/^\//,"").split("/");E="/"+x.replace(/^\//,"").split("/").slice(P.length).join("/")}let D=Cy(a,{pathname:E});On(v||D!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),On(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=kx(D&&D.map(P=>Object.assign({},P,{params:Object.assign({},f,P.params),pathname:bi([g,l.encodeLocation?l.encodeLocation(P.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?g:bi([g,l.encodeLocation?l.encodeLocation(P.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:P.pathnameBase])})),u,n,s,o);return e&&M?B.createElement(so.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},M):M}function vx(){let a=wx(),e=ux(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),n=a instanceof Error?a.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",a),u=B.createElement(B.Fragment,null,B.createElement("p",null," Hey developer "),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:l},"ErrorBoundary")," or"," ",B.createElement("code",{style:l},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),n?B.createElement("pre",{style:o},n):null,u)}var yx=B.createElement(vx,null),bx=class extends B.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){this.props.onError?this.props.onError(a,e):console.error("React Router caught the following error during render",a)}render(){return this.state.error!==void 0?B.createElement(Ti.Provider,{value:this.props.routeContext},B.createElement(Zh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Sx({routeContext:a,match:e,children:n}){let s=B.useContext(Us);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),B.createElement(Ti.Provider,{value:a},n)}function kx(a,e=[],n=null,s=null,o=null){if(a==null){if(!n)return null;if(n.errors)a=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)a=n.matches;else return null}let l=a,u=n==null?void 0:n.errors;if(u!=null){let g=l.findIndex(v=>v.route.id&&(u==null?void 0:u[v.route.id])!==void 0);at(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,g+1))}let d=!1,f=-1;if(n)for(let g=0;g<l.length;g++){let v=l[g];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=g),v.route.id){let{loaderData:S,errors:T}=n,x=v.route.loader&&!S.hasOwnProperty(v.route.id)&&(!T||T[v.route.id]===void 0);if(v.route.lazy||x){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let m=n&&s?(g,v)=>{var S,T;s(g,{location:n.location,params:((T=(S=n.matches)==null?void 0:S[0])==null?void 0:T.params)??{},errorInfo:v})}:void 0;return l.reduceRight((g,v,S)=>{let T,x=!1,E=null,D=null;n&&(T=u&&v.route.id?u[v.route.id]:void 0,E=v.route.errorElement||yx,d&&(f<0&&S===0?(Py("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,D=null):f===S&&(x=!0,D=v.route.hydrateFallbackElement||null)));let M=e.concat(l.slice(0,S+1)),Y=()=>{let P;return T?P=E:x?P=D:v.route.Component?P=B.createElement(v.route.Component,null):v.route.element?P=v.route.element:P=g,B.createElement(Sx,{match:v,routeContext:{outlet:g,matches:M,isDataRoute:n!=null},children:P})};return n&&(v.route.ErrorBoundary||v.route.errorElement||S===0)?B.createElement(bx,{location:n.location,revalidation:n.revalidation,component:E,error:T,children:Y(),routeContext:{outlet:null,matches:M,isDataRoute:!0},onError:m}):Y()},null)}function $h(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tx(a){let e=B.useContext(Us);return at(e,$h(a)),e}function Cx(a){let e=B.useContext(fc);return at(e,$h(a)),e}function xx(a){let e=B.useContext(Ti);return at(e,$h(a)),e}function ef(a){let e=xx(a),n=e.matches[e.matches.length-1];return at(n.route.id,`${a} can only be used on routes that contain a unique "id"`),n.route.id}function Ex(){return ef("useRouteId")}function wx(){var s;let a=B.useContext(Zh),e=Cx("useRouteError"),n=ef("useRouteError");return a!==void 0?a:(s=e.errors)==null?void 0:s[n]}function _x(){let{router:a}=Tx("useNavigate"),e=ef("useNavigate"),n=B.useRef(!1);return Ny(()=>{n.current=!0}),B.useCallback(async(o,l={})=>{On(n.current,My),n.current&&(typeof o=="number"?a.navigate(o):await a.navigate(o,{fromRouteId:e,...l}))},[a,e])}var Qv={};function Py(a,e,n){!e&&!Qv[a]&&(Qv[a]=!0,On(!1,n))}B.memo(Rx);function Rx({routes:a,future:e,state:n,unstable_onError:s}){return Dy(a,void 0,n,s,e)}function Vr(a){at(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ax({basename:a="/",children:e=null,location:n,navigationType:s="POP",navigator:o,static:l=!1}){at(!ro(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=a.replace(/^\/*/,"/"),d=B.useMemo(()=>({basename:u,navigator:o,static:l,future:{}}),[u,o,l]);typeof n=="string"&&(n=js(n));let{pathname:f="/",search:m="",hash:g="",state:v=null,key:S="default"}=n,T=B.useMemo(()=>{let x=Si(f,u);return x==null?null:{location:{pathname:x,search:m,hash:g,state:v,key:S},navigationType:s}},[u,f,m,g,v,S,s]);return On(T!=null,`<Router basename="${u}"> is not able to match the URL "${f}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:B.createElement(Hn.Provider,{value:d},B.createElement(so.Provider,{children:e,value:T}))}function Mx({children:a,location:e}){return gx(kh(a),e)}function kh(a,e=[]){let n=[];return B.Children.forEach(a,(s,o)=>{if(!B.isValidElement(s))return;let l=[...e,o];if(s.type===B.Fragment){n.push.apply(n,kh(s.props.children,l));return}at(s.type===Vr,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),at(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=kh(s.props.children,l)),n.push(u)}),n}var Pl="get",Ll="application/x-www-form-urlencoded";function mc(a){return a!=null&&typeof a.tagName=="string"}function Nx(a){return mc(a)&&a.tagName.toLowerCase()==="button"}function Ox(a){return mc(a)&&a.tagName.toLowerCase()==="form"}function Dx(a){return mc(a)&&a.tagName.toLowerCase()==="input"}function Px(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function Lx(a,e){return a.button===0&&(!e||e==="_self")&&!Px(a)}var wl=null;function Ix(){if(wl===null)try{new FormData(document.createElement("form"),0),wl=!1}catch{wl=!0}return wl}var jx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Qd(a){return a!=null&&!jx.has(a)?(On(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ll}"`),null):a}function Ux(a,e){let n,s,o,l,u;if(Ox(a)){let d=a.getAttribute("action");s=d?Si(d,e):null,n=a.getAttribute("method")||Pl,o=Qd(a.getAttribute("enctype"))||Ll,l=new FormData(a)}else if(Nx(a)||Dx(a)&&(a.type==="submit"||a.type==="image")){let d=a.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=a.getAttribute("formaction")||d.getAttribute("action");if(s=f?Si(f,e):null,n=a.getAttribute("formmethod")||d.getAttribute("method")||Pl,o=Qd(a.getAttribute("formenctype"))||Qd(d.getAttribute("enctype"))||Ll,l=new FormData(d,a),!Ix()){let{name:m,type:g,value:v}=a;if(g==="image"){let S=m?`${m}.`:"";l.append(`${S}x`,"0"),l.append(`${S}y`,"0")}else m&&l.append(m,v)}}else{if(mc(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Pl,s=null,o=Ll,u=a}return l&&o==="text/plain"&&(u=l,l=void 0),{action:s,method:n.toLowerCase(),encType:o,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function tf(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function Bx(a,e,n){let s=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&Si(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function zx(a,e){if(a.id in e)return e[a.id];try{let n=await import(a.module);return e[a.id]=n,n}catch(n){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qx(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function Fx(a,e,n){let s=await Promise.all(a.map(async o=>{let l=e.routes[o.route.id];if(l){let u=await zx(l,n);return u.links?u.links():[]}return[]}));return Yx(s.flat(1).filter(qx).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Jv(a,e,n,s,o,l){let u=(f,m)=>n[m]?f.route.id!==n[m].route.id:!0,d=(f,m)=>{var g;return n[m].pathname!==f.pathname||((g=n[m].route.path)==null?void 0:g.endsWith("*"))&&n[m].params["*"]!==f.params["*"]};return l==="assets"?e.filter((f,m)=>u(f,m)||d(f,m)):l==="data"?e.filter((f,m)=>{var v;let g=s.routes[f.route.id];if(!g||!g.hasLoader)return!1;if(u(f,m)||d(f,m))return!0;if(f.route.shouldRevalidate){let S=f.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((v=n[0])==null?void 0:v.params)||{},nextUrl:new URL(a,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof S=="boolean")return S}return!0}):[]}function Vx(a,e,{includeHydrateFallback:n}={}){return Hx(a.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function Hx(a){return[...new Set(a)]}function Gx(a){let e={},n=Object.keys(a).sort();for(let s of n)e[s]=a[s];return e}function Yx(a,e){let n=new Set;return new Set(e),a.reduce((s,o)=>{let l=JSON.stringify(Gx(o));return n.has(l)||(n.add(l),s.push({key:l,link:o})),s},[])}function Ly(){let a=B.useContext(Us);return tf(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function Kx(){let a=B.useContext(fc);return tf(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var nf=B.createContext(void 0);nf.displayName="FrameworkContext";function Iy(){let a=B.useContext(nf);return tf(a,"You must render this element inside a <HydratedRouter> element"),a}function Qx(a,e){let n=B.useContext(nf),[s,o]=B.useState(!1),[l,u]=B.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:m,onMouseLeave:g,onTouchStart:v}=e,S=B.useRef(null);B.useEffect(()=>{if(a==="render"&&u(!0),a==="viewport"){let E=M=>{M.forEach(Y=>{u(Y.isIntersecting)})},D=new IntersectionObserver(E,{threshold:.5});return S.current&&D.observe(S.current),()=>{D.disconnect()}}},[a]),B.useEffect(()=>{if(s){let E=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(E)}}},[s]);let T=()=>{o(!0)},x=()=>{o(!1),u(!1)};return n?a!=="intent"?[l,S,{}]:[l,S,{onFocus:Lr(d,T),onBlur:Lr(f,x),onMouseEnter:Lr(m,T),onMouseLeave:Lr(g,x),onTouchStart:Lr(v,T)}]:[!1,S,{}]}function Lr(a,e){return n=>{a&&a(n),n.defaultPrevented||e(n)}}function Jx({page:a,...e}){let{router:n}=Ly(),s=B.useMemo(()=>Cy(n.routes,a,n.basename),[n.routes,a,n.basename]);return s?B.createElement(Wx,{page:a,matches:s,...e}):null}function Xx(a){let{manifest:e,routeModules:n}=Iy(),[s,o]=B.useState([]);return B.useEffect(()=>{let l=!1;return Fx(a,e,n).then(u=>{l||o(u)}),()=>{l=!0}},[a,e,n]),s}function Wx({page:a,matches:e,...n}){let s=La(),{manifest:o,routeModules:l}=Iy(),{basename:u}=Ly(),{loaderData:d,matches:f}=Kx(),m=B.useMemo(()=>Jv(a,e,f,o,s,"data"),[a,e,f,o,s]),g=B.useMemo(()=>Jv(a,e,f,o,s,"assets"),[a,e,f,o,s]),v=B.useMemo(()=>{if(a===s.pathname+s.search+s.hash)return[];let x=new Set,E=!1;if(e.forEach(M=>{var P;let Y=o.routes[M.route.id];!Y||!Y.hasLoader||(!m.some(A=>A.route.id===M.route.id)&&M.route.id in d&&((P=l[M.route.id])!=null&&P.shouldRevalidate)||Y.hasClientLoader?E=!0:x.add(M.route.id))}),x.size===0)return[];let D=Bx(a,u,"data");return E&&x.size>0&&D.searchParams.set("_routes",e.filter(M=>x.has(M.route.id)).map(M=>M.route.id).join(",")),[D.pathname+D.search]},[u,d,s,o,m,e,a,l]),S=B.useMemo(()=>Vx(g,o),[g,o]),T=Xx(g);return B.createElement(B.Fragment,null,v.map(x=>B.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),S.map(x=>B.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),T.map(({key:x,link:E})=>B.createElement("link",{key:x,nonce:n.nonce,...E})))}function Zx(...a){return e=>{a.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var jy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jy&&(window.__reactRouterVersion="7.9.6")}catch{}function $x({basename:a,children:e,window:n}){let s=B.useRef();s.current==null&&(s.current=zC({window:n,v5Compat:!0}));let o=s.current,[l,u]=B.useState({action:o.action,location:o.location}),d=B.useCallback(f=>{B.startTransition(()=>u(f))},[u]);return B.useLayoutEffect(()=>o.listen(d),[o,d]),B.createElement(Ax,{basename:a,children:e,location:l.location,navigationType:l.action,navigator:o})}var Uy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,By=B.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:o,reloadDocument:l,replace:u,state:d,target:f,to:m,preventScrollReset:g,viewTransition:v,...S},T){let{basename:x}=B.useContext(Hn),E=typeof m=="string"&&Uy.test(m),D,M=!1;if(typeof m=="string"&&E&&(D=m,jy))try{let J=new URL(window.location.href),H=m.startsWith("//")?new URL(J.protocol+m):new URL(m),se=Si(H.pathname,x);H.origin===J.origin&&se!=null?m=se+H.search+H.hash:M=!0}catch{On(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Y=mx(m,{relative:o}),[P,A,N]=Qx(s,S),V=iE(m,{replace:u,state:d,target:f,preventScrollReset:g,relative:o,viewTransition:v});function X(J){e&&e(J),J.defaultPrevented||V(J)}let z=B.createElement("a",{...S,...N,href:D||Y,onClick:M||l?e:X,ref:Zx(T,A),target:f,"data-discover":!E&&n==="render"?"true":void 0});return P&&!E?B.createElement(B.Fragment,null,z,B.createElement(Jx,{page:Y})):z});By.displayName="Link";var eE=B.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:o=!1,style:l,to:u,viewTransition:d,children:f,...m},g){let v=oo(u,{relative:m.relative}),S=La(),T=B.useContext(fc),{navigator:x,basename:E}=B.useContext(Hn),D=T!=null&&lE(v)&&d===!0,M=x.encodeLocation?x.encodeLocation(v).pathname:v.pathname,Y=S.pathname,P=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(Y=Y.toLowerCase(),P=P?P.toLowerCase():null,M=M.toLowerCase()),P&&E&&(P=Si(P,E)||P);const A=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let N=Y===M||!o&&Y.startsWith(M)&&Y.charAt(A)==="/",V=P!=null&&(P===M||!o&&P.startsWith(M)&&P.charAt(M.length)==="/"),X={isActive:N,isPending:V,isTransitioning:D},z=N?e:void 0,J;typeof s=="function"?J=s(X):J=[s,N?"active":null,V?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let H=typeof l=="function"?l(X):l;return B.createElement(By,{...m,"aria-current":z,className:J,ref:g,style:H,to:u,viewTransition:d},typeof f=="function"?f(X):f)});eE.displayName="NavLink";var tE=B.forwardRef(({discover:a="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:o,state:l,method:u=Pl,action:d,onSubmit:f,relative:m,preventScrollReset:g,viewTransition:v,...S},T)=>{let x=rE(),E=oE(d,{relative:m}),D=u.toLowerCase()==="get"?"get":"post",M=typeof d=="string"&&Uy.test(d),Y=P=>{if(f&&f(P),P.defaultPrevented)return;P.preventDefault();let A=P.nativeEvent.submitter,N=(A==null?void 0:A.getAttribute("formmethod"))||u;x(A||P.currentTarget,{fetcherKey:e,method:N,navigate:n,replace:o,state:l,relative:m,preventScrollReset:g,viewTransition:v})};return B.createElement("form",{ref:T,method:D,action:E,onSubmit:s?f:Y,...S,"data-discover":!M&&a==="render"?"true":void 0})});tE.displayName="Form";function nE(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zy(a){let e=B.useContext(Us);return at(e,nE(a)),e}function iE(a,{target:e,replace:n,state:s,preventScrollReset:o,relative:l,viewTransition:u}={}){let d=Oy(),f=La(),m=oo(a,{relative:l});return B.useCallback(g=>{if(Lx(g,e)){g.preventDefault();let v=n!==void 0?n:Xr(f)===Xr(m);d(a,{replace:v,state:s,preventScrollReset:o,relative:l,viewTransition:u})}},[f,d,m,n,s,e,a,o,l,u])}var aE=0,sE=()=>`__${String(++aE)}__`;function rE(){let{router:a}=zy("useSubmit"),{basename:e}=B.useContext(Hn),n=Ex();return B.useCallback(async(s,o={})=>{let{action:l,method:u,encType:d,formData:f,body:m}=Ux(s,e);if(o.navigate===!1){let g=o.fetcherKey||sE();await a.fetch(g,n,o.action||l,{preventScrollReset:o.preventScrollReset,formData:f,body:m,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await a.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:f,body:m,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[a,e,n])}function oE(a,{relative:e}={}){let{basename:n}=B.useContext(Hn),s=B.useContext(Ti);at(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...oo(a||".",{relative:e})},u=La();if(a==null){l.search=u.search;let d=new URLSearchParams(l.search),f=d.getAll("index");if(f.some(g=>g==="")){d.delete("index"),f.filter(v=>v).forEach(v=>d.append("index",v));let g=d.toString();l.search=g?`?${g}`:""}}return(!a||a===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:bi([n,l.pathname])),Xr(l)}function lE(a,{relative:e}={}){let n=B.useContext(Ay);at(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=zy("useViewTransitionState"),o=oo(a,{relative:e});if(!n.isTransitioning)return!1;let l=Si(n.currentLocation.pathname,s)||n.currentLocation.pathname,u=Si(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Jl(o.pathname,u)!=null||Jl(o.pathname,l)!=null}/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qy=(...a)=>a.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var uE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dE=B.forwardRef(({color:a="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:o="",children:l,iconNode:u,...d},f)=>B.createElement("svg",{ref:f,...uE,width:e,height:e,stroke:a,strokeWidth:s?Number(n)*24/Number(e):n,className:qy("lucide",o),...d},[...u.map(([m,g])=>B.createElement(m,g)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=(a,e)=>{const n=B.forwardRef(({className:s,...o},l)=>B.createElement(dE,{ref:l,iconNode:e,className:qy(`lucide-${cE(a)}`,s),...o}));return n.displayName=`${a}`,n};/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Fy=_t("ArrowRight",hE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fE=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],mE=_t("Award",fE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pE=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],gE=_t("Calendar",pE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Xv=_t("Check",vE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],bE=_t("CircleCheck",yE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],kE=_t("ClipboardCheck",SE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],CE=_t("FlaskConical",TE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xE=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],EE=_t("GraduationCap",xE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.79 0l2.96 2.66",key:"4oyue0"}],["path",{d:"m18 15-2-2",key:"60u0ii"}],["path",{d:"m15 18-2-2",key:"6p76be"}]],Vy=_t("HeartHandshake",wE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]],Wv=_t("HeartPulse",_E);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],AE=_t("Heart",RE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],NE=_t("LifeBuoy",ME);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],DE=_t("Map",OE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],LE=_t("MessageSquare",PE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],jE=_t("Mic",IE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],Hy=_t("TrendingUp",UE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],zE=_t("Users",BE);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zv=_t("X",qE);function $v({children:a}){return b.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[b.jsx("header",{className:"sticky top-0 z-50 w-full border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"flex h-16 items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-green-600 flex items-center justify-center",children:b.jsx(Wv,{className:"w-6 h-6 text-white"})}),b.jsxs("div",{children:[b.jsx("div",{className:"text-lg font-bold text-foreground",children:"Smart Nicotine"}),b.jsx("div",{className:"text-xs text-muted-foreground",children:"Science-Backed Cessation"})]})]}),b.jsxs("nav",{className:"flex items-center gap-6",children:[b.jsx("a",{href:"/",className:"text-sm font-medium text-muted-foreground hover:text-foreground transition-colors",children:"Home"}),b.jsx("a",{href:"/chat",className:"text-sm font-medium bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent hover:from-blue-700 hover:to-green-700 transition-all",children:"Chat"})]}),b.jsxs("div",{className:"hidden lg:flex items-center gap-2 text-sm",children:[b.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),b.jsx("span",{className:"text-muted-foreground",children:"Registered UK Charity"})]})]})})}),b.jsx("main",{className:"flex-1",children:a}),b.jsx("footer",{className:"border-t border-border bg-muted/30",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:b.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-blue-600 to-green-600 flex items-center justify-center",children:b.jsx(Wv,{className:"w-5 h-5 text-white"})}),b.jsx("div",{className:"text-sm text-muted-foreground",children:" 2026 Smart Nicotine Foundation"})]}),b.jsxs("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[b.jsx("a",{href:"#",className:"hover:text-foreground transition-colors",children:"Privacy Policy"}),b.jsx("a",{href:"#",className:"hover:text-foreground transition-colors",children:"Terms of Service"}),b.jsx("a",{href:"#",className:"hover:text-foreground transition-colors",children:"Contact"})]})]})})})]})}function e0(a,e){if(typeof a=="function")return a(e);a!=null&&(a.current=e)}function FE(...a){return e=>{let n=!1;const s=a.map(o=>{const l=e0(o,e);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let o=0;o<s.length;o++){const l=s[o];typeof l=="function"?l():e0(a[o],null)}}}}var VE=Symbol.for("react.lazy"),Xl=NC[" use ".trim().toString()];function HE(a){return typeof a=="object"&&a!==null&&"then"in a}function Gy(a){return a!=null&&typeof a=="object"&&"$$typeof"in a&&a.$$typeof===VE&&"_payload"in a&&HE(a._payload)}function GE(a){const e=KE(a),n=B.forwardRef((s,o)=>{let{children:l,...u}=s;Gy(l)&&typeof Xl=="function"&&(l=Xl(l._payload));const d=B.Children.toArray(l),f=d.find(JE);if(f){const m=f.props.children,g=d.map(v=>v===f?B.Children.count(m)>1?B.Children.only(null):B.isValidElement(m)?m.props.children:null:v);return b.jsx(e,{...u,ref:o,children:B.isValidElement(m)?B.cloneElement(m,void 0,g):null})}return b.jsx(e,{...u,ref:o,children:l})});return n.displayName=`${a}.Slot`,n}var YE=GE("Slot");function KE(a){const e=B.forwardRef((n,s)=>{let{children:o,...l}=n;if(Gy(o)&&typeof Xl=="function"&&(o=Xl(o._payload)),B.isValidElement(o)){const u=WE(o),d=XE(l,o.props);return o.type!==B.Fragment&&(d.ref=s?FE(s,u):u),B.cloneElement(o,d)}return B.Children.count(o)>1?B.Children.only(null):null});return e.displayName=`${a}.SlotClone`,e}var QE=Symbol("radix.slottable");function JE(a){return B.isValidElement(a)&&typeof a.type=="function"&&"__radixId"in a.type&&a.type.__radixId===QE}function XE(a,e){const n={...e};for(const s in e){const o=a[s],l=e[s];/^on[A-Z]/.test(s)?o&&l?n[s]=(...d)=>{const f=l(...d);return o(...d),f}:o&&(n[s]=o):s==="style"?n[s]={...o,...l}:s==="className"&&(n[s]=[o,l].filter(Boolean).join(" "))}return{...a,...n}}function WE(a){var s,o;let e=(s=Object.getOwnPropertyDescriptor(a.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?a.ref:(e=(o=Object.getOwnPropertyDescriptor(a,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?a.props.ref:a.props.ref||a.ref)}function Yy(a){var e,n,s="";if(typeof a=="string"||typeof a=="number")s+=a;else if(typeof a=="object")if(Array.isArray(a)){var o=a.length;for(e=0;e<o;e++)a[e]&&(n=Yy(a[e]))&&(s&&(s+=" "),s+=n)}else for(n in a)a[n]&&(s&&(s+=" "),s+=n);return s}function Ky(){for(var a,e,n=0,s="",o=arguments.length;n<o;n++)(a=arguments[n])&&(e=Yy(a))&&(s&&(s+=" "),s+=e);return s}const t0=a=>typeof a=="boolean"?`${a}`:a===0?"0":a,n0=Ky,ZE=(a,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return n0(a,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:l}=e,u=Object.keys(o).map(m=>{const g=n==null?void 0:n[m],v=l==null?void 0:l[m];if(g===null)return null;const S=t0(g)||t0(v);return o[m][S]}),d=n&&Object.entries(n).reduce((m,g)=>{let[v,S]=g;return S===void 0||(m[v]=S),m},{}),f=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((m,g)=>{let{class:v,className:S,...T}=g;return Object.entries(T).every(x=>{let[E,D]=x;return Array.isArray(D)?D.includes({...l,...d}[E]):{...l,...d}[E]===D})?[...m,v,S]:m},[]);return n0(a,u,f,n==null?void 0:n.class,n==null?void 0:n.className)},$E=(a,e)=>{const n=new Array(a.length+e.length);for(let s=0;s<a.length;s++)n[s]=a[s];for(let s=0;s<e.length;s++)n[a.length+s]=e[s];return n},e1=(a,e)=>({classGroupId:a,validator:e}),Qy=(a=new Map,e=null,n)=>({nextPart:a,validators:e,classGroupId:n}),Wl="-",i0=[],t1="arbitrary..",n1=a=>{const e=a1(a),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=a;return{getClassGroupId:u=>{if(u.startsWith("[")&&u.endsWith("]"))return i1(u);const d=u.split(Wl),f=d[0]===""&&d.length>1?1:0;return Jy(d,f,e)},getConflictingClassGroupIds:(u,d)=>{if(d){const f=s[u],m=n[u];return f?m?$E(m,f):f:m||i0}return n[u]||i0}}},Jy=(a,e,n)=>{if(a.length-e===0)return n.classGroupId;const o=a[e],l=n.nextPart.get(o);if(l){const m=Jy(a,e+1,l);if(m)return m}const u=n.validators;if(u===null)return;const d=e===0?a.join(Wl):a.slice(e).join(Wl),f=u.length;for(let m=0;m<f;m++){const g=u[m];if(g.validator(d))return g.classGroupId}},i1=a=>a.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=a.slice(1,-1),n=e.indexOf(":"),s=e.slice(0,n);return s?t1+s:void 0})(),a1=a=>{const{theme:e,classGroups:n}=a;return s1(n,e)},s1=(a,e)=>{const n=Qy();for(const s in a){const o=a[s];af(o,n,s,e)}return n},af=(a,e,n,s)=>{const o=a.length;for(let l=0;l<o;l++){const u=a[l];r1(u,e,n,s)}},r1=(a,e,n,s)=>{if(typeof a=="string"){o1(a,e,n);return}if(typeof a=="function"){l1(a,e,n,s);return}c1(a,e,n,s)},o1=(a,e,n)=>{const s=a===""?e:Xy(e,a);s.classGroupId=n},l1=(a,e,n,s)=>{if(u1(a)){af(a(s),e,n,s);return}e.validators===null&&(e.validators=[]),e.validators.push(e1(n,a))},c1=(a,e,n,s)=>{const o=Object.entries(a),l=o.length;for(let u=0;u<l;u++){const[d,f]=o[u];af(f,Xy(e,d),n,s)}},Xy=(a,e)=>{let n=a;const s=e.split(Wl),o=s.length;for(let l=0;l<o;l++){const u=s[l];let d=n.nextPart.get(u);d||(d=Qy(),n.nextPart.set(u,d)),n=d}return n},u1=a=>"isThemeGetter"in a&&a.isThemeGetter===!0,d1=a=>{if(a<1)return{get:()=>{},set:()=>{}};let e=0,n=Object.create(null),s=Object.create(null);const o=(l,u)=>{n[l]=u,e++,e>a&&(e=0,s=n,n=Object.create(null))};return{get(l){let u=n[l];if(u!==void 0)return u;if((u=s[l])!==void 0)return o(l,u),u},set(l,u){l in n?n[l]=u:o(l,u)}}},Th="!",a0=":",h1=[],s0=(a,e,n,s,o)=>({modifiers:a,hasImportantModifier:e,baseClassName:n,maybePostfixModifierPosition:s,isExternal:o}),f1=a=>{const{prefix:e,experimentalParseClassName:n}=a;let s=o=>{const l=[];let u=0,d=0,f=0,m;const g=o.length;for(let E=0;E<g;E++){const D=o[E];if(u===0&&d===0){if(D===a0){l.push(o.slice(f,E)),f=E+1;continue}if(D==="/"){m=E;continue}}D==="["?u++:D==="]"?u--:D==="("?d++:D===")"&&d--}const v=l.length===0?o:o.slice(f);let S=v,T=!1;v.endsWith(Th)?(S=v.slice(0,-1),T=!0):v.startsWith(Th)&&(S=v.slice(1),T=!0);const x=m&&m>f?m-f:void 0;return s0(l,T,S,x)};if(e){const o=e+a0,l=s;s=u=>u.startsWith(o)?l(u.slice(o.length)):s0(h1,!1,u,void 0,!0)}if(n){const o=s;s=l=>n({className:l,parseClassName:o})}return s},m1=a=>{const e=new Map;return a.orderSensitiveModifiers.forEach((n,s)=>{e.set(n,1e6+s)}),n=>{const s=[];let o=[];for(let l=0;l<n.length;l++){const u=n[l],d=u[0]==="[",f=e.has(u);d||f?(o.length>0&&(o.sort(),s.push(...o),o=[]),s.push(u)):o.push(u)}return o.length>0&&(o.sort(),s.push(...o)),s}},p1=a=>({cache:d1(a.cacheSize),parseClassName:f1(a),sortModifiers:m1(a),...n1(a)}),g1=/\s+/,v1=(a,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:o,sortModifiers:l}=e,u=[],d=a.trim().split(g1);let f="";for(let m=d.length-1;m>=0;m-=1){const g=d[m],{isExternal:v,modifiers:S,hasImportantModifier:T,baseClassName:x,maybePostfixModifierPosition:E}=n(g);if(v){f=g+(f.length>0?" "+f:f);continue}let D=!!E,M=s(D?x.substring(0,E):x);if(!M){if(!D){f=g+(f.length>0?" "+f:f);continue}if(M=s(x),!M){f=g+(f.length>0?" "+f:f);continue}D=!1}const Y=S.length===0?"":S.length===1?S[0]:l(S).join(":"),P=T?Y+Th:Y,A=P+M;if(u.indexOf(A)>-1)continue;u.push(A);const N=o(M,D);for(let V=0;V<N.length;++V){const X=N[V];u.push(P+X)}f=g+(f.length>0?" "+f:f)}return f},y1=(...a)=>{let e=0,n,s,o="";for(;e<a.length;)(n=a[e++])&&(s=Wy(n))&&(o&&(o+=" "),o+=s);return o},Wy=a=>{if(typeof a=="string")return a;let e,n="";for(let s=0;s<a.length;s++)a[s]&&(e=Wy(a[s]))&&(n&&(n+=" "),n+=e);return n},b1=(a,...e)=>{let n,s,o,l;const u=f=>{const m=e.reduce((g,v)=>v(g),a());return n=p1(m),s=n.cache.get,o=n.cache.set,l=d,d(f)},d=f=>{const m=s(f);if(m)return m;const g=v1(f,n);return o(f,g),g};return l=u,(...f)=>l(y1(...f))},S1=[],bt=a=>{const e=n=>n[a]||S1;return e.isThemeGetter=!0,e},Zy=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,$y=/^\((?:(\w[\w-]*):)?(.+)\)$/i,k1=/^\d+\/\d+$/,T1=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,C1=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,x1=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,E1=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,w1=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ks=a=>k1.test(a),xe=a=>!!a&&!Number.isNaN(Number(a)),Wi=a=>!!a&&Number.isInteger(Number(a)),Jd=a=>a.endsWith("%")&&xe(a.slice(0,-1)),ui=a=>T1.test(a),_1=()=>!0,R1=a=>C1.test(a)&&!x1.test(a),eb=()=>!1,A1=a=>E1.test(a),M1=a=>w1.test(a),N1=a=>!ue(a)&&!de(a),O1=a=>Bs(a,ib,eb),ue=a=>Zy.test(a),Aa=a=>Bs(a,ab,R1),Xd=a=>Bs(a,j1,xe),r0=a=>Bs(a,tb,eb),D1=a=>Bs(a,nb,M1),_l=a=>Bs(a,sb,A1),de=a=>$y.test(a),Ir=a=>zs(a,ab),P1=a=>zs(a,U1),o0=a=>zs(a,tb),L1=a=>zs(a,ib),I1=a=>zs(a,nb),Rl=a=>zs(a,sb,!0),Bs=(a,e,n)=>{const s=Zy.exec(a);return s?s[1]?e(s[1]):n(s[2]):!1},zs=(a,e,n=!1)=>{const s=$y.exec(a);return s?s[1]?e(s[1]):n:!1},tb=a=>a==="position"||a==="percentage",nb=a=>a==="image"||a==="url",ib=a=>a==="length"||a==="size"||a==="bg-size",ab=a=>a==="length",j1=a=>a==="number",U1=a=>a==="family-name",sb=a=>a==="shadow",B1=()=>{const a=bt("color"),e=bt("font"),n=bt("text"),s=bt("font-weight"),o=bt("tracking"),l=bt("leading"),u=bt("breakpoint"),d=bt("container"),f=bt("spacing"),m=bt("radius"),g=bt("shadow"),v=bt("inset-shadow"),S=bt("text-shadow"),T=bt("drop-shadow"),x=bt("blur"),E=bt("perspective"),D=bt("aspect"),M=bt("ease"),Y=bt("animate"),P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],A=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],N=()=>[...A(),de,ue],V=()=>["auto","hidden","clip","visible","scroll"],X=()=>["auto","contain","none"],z=()=>[de,ue,f],J=()=>[ks,"full","auto",...z()],H=()=>[Wi,"none","subgrid",de,ue],se=()=>["auto",{span:["full",Wi,de,ue]},Wi,de,ue],fe=()=>[Wi,"auto",de,ue],qe=()=>["auto","min","max","fr",de,ue],$e=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Je=()=>["start","end","center","stretch","center-safe","end-safe"],F=()=>["auto",...z()],ae=()=>[ks,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...z()],ee=()=>[a,de,ue],De=()=>[...A(),o0,r0,{position:[de,ue]}],Le=()=>["no-repeat",{repeat:["","x","y","space","round"]}],R=()=>["auto","cover","contain",L1,O1,{size:[de,ue]}],K=()=>[Jd,Ir,Aa],ne=()=>["","none","full",m,de,ue],le=()=>["",xe,Ir,Aa],ge=()=>["solid","dashed","dotted","double"],ye=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ve=()=>[xe,Jd,o0,r0],Tt=()=>["","none",x,de,ue],Ze=()=>["none",xe,de,ue],Pn=()=>["none",xe,de,ue],xi=()=>[xe,de,ue],Ei=()=>[ks,"full",...z()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ui],breakpoint:[ui],color:[_1],container:[ui],"drop-shadow":[ui],ease:["in","out","in-out"],font:[N1],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ui],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ui],shadow:[ui],spacing:["px",xe],text:[ui],"text-shadow":[ui],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ks,ue,de,D]}],container:["container"],columns:[{columns:[xe,ue,de,d]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:N()}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:X()}],"overscroll-x":[{"overscroll-x":X()}],"overscroll-y":[{"overscroll-y":X()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:J()}],"inset-x":[{"inset-x":J()}],"inset-y":[{"inset-y":J()}],start:[{start:J()}],end:[{end:J()}],top:[{top:J()}],right:[{right:J()}],bottom:[{bottom:J()}],left:[{left:J()}],visibility:["visible","invisible","collapse"],z:[{z:[Wi,"auto",de,ue]}],basis:[{basis:[ks,"full","auto",d,...z()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[xe,ks,"auto","initial","none",ue]}],grow:[{grow:["",xe,de,ue]}],shrink:[{shrink:["",xe,de,ue]}],order:[{order:[Wi,"first","last","none",de,ue]}],"grid-cols":[{"grid-cols":H()}],"col-start-end":[{col:se()}],"col-start":[{"col-start":fe()}],"col-end":[{"col-end":fe()}],"grid-rows":[{"grid-rows":H()}],"row-start-end":[{row:se()}],"row-start":[{"row-start":fe()}],"row-end":[{"row-end":fe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":qe()}],"auto-rows":[{"auto-rows":qe()}],gap:[{gap:z()}],"gap-x":[{"gap-x":z()}],"gap-y":[{"gap-y":z()}],"justify-content":[{justify:[...$e(),"normal"]}],"justify-items":[{"justify-items":[...Je(),"normal"]}],"justify-self":[{"justify-self":["auto",...Je()]}],"align-content":[{content:["normal",...$e()]}],"align-items":[{items:[...Je(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Je(),{baseline:["","last"]}]}],"place-content":[{"place-content":$e()}],"place-items":[{"place-items":[...Je(),"baseline"]}],"place-self":[{"place-self":["auto",...Je()]}],p:[{p:z()}],px:[{px:z()}],py:[{py:z()}],ps:[{ps:z()}],pe:[{pe:z()}],pt:[{pt:z()}],pr:[{pr:z()}],pb:[{pb:z()}],pl:[{pl:z()}],m:[{m:F()}],mx:[{mx:F()}],my:[{my:F()}],ms:[{ms:F()}],me:[{me:F()}],mt:[{mt:F()}],mr:[{mr:F()}],mb:[{mb:F()}],ml:[{ml:F()}],"space-x":[{"space-x":z()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":z()}],"space-y-reverse":["space-y-reverse"],size:[{size:ae()}],w:[{w:[d,"screen",...ae()]}],"min-w":[{"min-w":[d,"screen","none",...ae()]}],"max-w":[{"max-w":[d,"screen","none","prose",{screen:[u]},...ae()]}],h:[{h:["screen","lh",...ae()]}],"min-h":[{"min-h":["screen","lh","none",...ae()]}],"max-h":[{"max-h":["screen","lh",...ae()]}],"font-size":[{text:["base",n,Ir,Aa]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,de,Xd]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Jd,ue]}],"font-family":[{font:[P1,ue,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,de,ue]}],"line-clamp":[{"line-clamp":[xe,"none",de,Xd]}],leading:[{leading:[l,...z()]}],"list-image":[{"list-image":["none",de,ue]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",de,ue]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:ee()}],"text-color":[{text:ee()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ge(),"wavy"]}],"text-decoration-thickness":[{decoration:[xe,"from-font","auto",de,Aa]}],"text-decoration-color":[{decoration:ee()}],"underline-offset":[{"underline-offset":[xe,"auto",de,ue]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",de,ue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",de,ue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:De()}],"bg-repeat":[{bg:Le()}],"bg-size":[{bg:R()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Wi,de,ue],radial:["",de,ue],conic:[Wi,de,ue]},I1,D1]}],"bg-color":[{bg:ee()}],"gradient-from-pos":[{from:K()}],"gradient-via-pos":[{via:K()}],"gradient-to-pos":[{to:K()}],"gradient-from":[{from:ee()}],"gradient-via":[{via:ee()}],"gradient-to":[{to:ee()}],rounded:[{rounded:ne()}],"rounded-s":[{"rounded-s":ne()}],"rounded-e":[{"rounded-e":ne()}],"rounded-t":[{"rounded-t":ne()}],"rounded-r":[{"rounded-r":ne()}],"rounded-b":[{"rounded-b":ne()}],"rounded-l":[{"rounded-l":ne()}],"rounded-ss":[{"rounded-ss":ne()}],"rounded-se":[{"rounded-se":ne()}],"rounded-ee":[{"rounded-ee":ne()}],"rounded-es":[{"rounded-es":ne()}],"rounded-tl":[{"rounded-tl":ne()}],"rounded-tr":[{"rounded-tr":ne()}],"rounded-br":[{"rounded-br":ne()}],"rounded-bl":[{"rounded-bl":ne()}],"border-w":[{border:le()}],"border-w-x":[{"border-x":le()}],"border-w-y":[{"border-y":le()}],"border-w-s":[{"border-s":le()}],"border-w-e":[{"border-e":le()}],"border-w-t":[{"border-t":le()}],"border-w-r":[{"border-r":le()}],"border-w-b":[{"border-b":le()}],"border-w-l":[{"border-l":le()}],"divide-x":[{"divide-x":le()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":le()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ge(),"hidden","none"]}],"divide-style":[{divide:[...ge(),"hidden","none"]}],"border-color":[{border:ee()}],"border-color-x":[{"border-x":ee()}],"border-color-y":[{"border-y":ee()}],"border-color-s":[{"border-s":ee()}],"border-color-e":[{"border-e":ee()}],"border-color-t":[{"border-t":ee()}],"border-color-r":[{"border-r":ee()}],"border-color-b":[{"border-b":ee()}],"border-color-l":[{"border-l":ee()}],"divide-color":[{divide:ee()}],"outline-style":[{outline:[...ge(),"none","hidden"]}],"outline-offset":[{"outline-offset":[xe,de,ue]}],"outline-w":[{outline:["",xe,Ir,Aa]}],"outline-color":[{outline:ee()}],shadow:[{shadow:["","none",g,Rl,_l]}],"shadow-color":[{shadow:ee()}],"inset-shadow":[{"inset-shadow":["none",v,Rl,_l]}],"inset-shadow-color":[{"inset-shadow":ee()}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:ee()}],"ring-offset-w":[{"ring-offset":[xe,Aa]}],"ring-offset-color":[{"ring-offset":ee()}],"inset-ring-w":[{"inset-ring":le()}],"inset-ring-color":[{"inset-ring":ee()}],"text-shadow":[{"text-shadow":["none",S,Rl,_l]}],"text-shadow-color":[{"text-shadow":ee()}],opacity:[{opacity:[xe,de,ue]}],"mix-blend":[{"mix-blend":[...ye(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ye()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[xe]}],"mask-image-linear-from-pos":[{"mask-linear-from":ve()}],"mask-image-linear-to-pos":[{"mask-linear-to":ve()}],"mask-image-linear-from-color":[{"mask-linear-from":ee()}],"mask-image-linear-to-color":[{"mask-linear-to":ee()}],"mask-image-t-from-pos":[{"mask-t-from":ve()}],"mask-image-t-to-pos":[{"mask-t-to":ve()}],"mask-image-t-from-color":[{"mask-t-from":ee()}],"mask-image-t-to-color":[{"mask-t-to":ee()}],"mask-image-r-from-pos":[{"mask-r-from":ve()}],"mask-image-r-to-pos":[{"mask-r-to":ve()}],"mask-image-r-from-color":[{"mask-r-from":ee()}],"mask-image-r-to-color":[{"mask-r-to":ee()}],"mask-image-b-from-pos":[{"mask-b-from":ve()}],"mask-image-b-to-pos":[{"mask-b-to":ve()}],"mask-image-b-from-color":[{"mask-b-from":ee()}],"mask-image-b-to-color":[{"mask-b-to":ee()}],"mask-image-l-from-pos":[{"mask-l-from":ve()}],"mask-image-l-to-pos":[{"mask-l-to":ve()}],"mask-image-l-from-color":[{"mask-l-from":ee()}],"mask-image-l-to-color":[{"mask-l-to":ee()}],"mask-image-x-from-pos":[{"mask-x-from":ve()}],"mask-image-x-to-pos":[{"mask-x-to":ve()}],"mask-image-x-from-color":[{"mask-x-from":ee()}],"mask-image-x-to-color":[{"mask-x-to":ee()}],"mask-image-y-from-pos":[{"mask-y-from":ve()}],"mask-image-y-to-pos":[{"mask-y-to":ve()}],"mask-image-y-from-color":[{"mask-y-from":ee()}],"mask-image-y-to-color":[{"mask-y-to":ee()}],"mask-image-radial":[{"mask-radial":[de,ue]}],"mask-image-radial-from-pos":[{"mask-radial-from":ve()}],"mask-image-radial-to-pos":[{"mask-radial-to":ve()}],"mask-image-radial-from-color":[{"mask-radial-from":ee()}],"mask-image-radial-to-color":[{"mask-radial-to":ee()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":A()}],"mask-image-conic-pos":[{"mask-conic":[xe]}],"mask-image-conic-from-pos":[{"mask-conic-from":ve()}],"mask-image-conic-to-pos":[{"mask-conic-to":ve()}],"mask-image-conic-from-color":[{"mask-conic-from":ee()}],"mask-image-conic-to-color":[{"mask-conic-to":ee()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:De()}],"mask-repeat":[{mask:Le()}],"mask-size":[{mask:R()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",de,ue]}],filter:[{filter:["","none",de,ue]}],blur:[{blur:Tt()}],brightness:[{brightness:[xe,de,ue]}],contrast:[{contrast:[xe,de,ue]}],"drop-shadow":[{"drop-shadow":["","none",T,Rl,_l]}],"drop-shadow-color":[{"drop-shadow":ee()}],grayscale:[{grayscale:["",xe,de,ue]}],"hue-rotate":[{"hue-rotate":[xe,de,ue]}],invert:[{invert:["",xe,de,ue]}],saturate:[{saturate:[xe,de,ue]}],sepia:[{sepia:["",xe,de,ue]}],"backdrop-filter":[{"backdrop-filter":["","none",de,ue]}],"backdrop-blur":[{"backdrop-blur":Tt()}],"backdrop-brightness":[{"backdrop-brightness":[xe,de,ue]}],"backdrop-contrast":[{"backdrop-contrast":[xe,de,ue]}],"backdrop-grayscale":[{"backdrop-grayscale":["",xe,de,ue]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[xe,de,ue]}],"backdrop-invert":[{"backdrop-invert":["",xe,de,ue]}],"backdrop-opacity":[{"backdrop-opacity":[xe,de,ue]}],"backdrop-saturate":[{"backdrop-saturate":[xe,de,ue]}],"backdrop-sepia":[{"backdrop-sepia":["",xe,de,ue]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":z()}],"border-spacing-x":[{"border-spacing-x":z()}],"border-spacing-y":[{"border-spacing-y":z()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",de,ue]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[xe,"initial",de,ue]}],ease:[{ease:["linear","initial",M,de,ue]}],delay:[{delay:[xe,de,ue]}],animate:[{animate:["none",Y,de,ue]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[E,de,ue]}],"perspective-origin":[{"perspective-origin":N()}],rotate:[{rotate:Ze()}],"rotate-x":[{"rotate-x":Ze()}],"rotate-y":[{"rotate-y":Ze()}],"rotate-z":[{"rotate-z":Ze()}],scale:[{scale:Pn()}],"scale-x":[{"scale-x":Pn()}],"scale-y":[{"scale-y":Pn()}],"scale-z":[{"scale-z":Pn()}],"scale-3d":["scale-3d"],skew:[{skew:xi()}],"skew-x":[{"skew-x":xi()}],"skew-y":[{"skew-y":xi()}],transform:[{transform:[de,ue,"","none","gpu","cpu"]}],"transform-origin":[{origin:N()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ei()}],"translate-x":[{"translate-x":Ei()}],"translate-y":[{"translate-y":Ei()}],"translate-z":[{"translate-z":Ei()}],"translate-none":["translate-none"],accent:[{accent:ee()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:ee()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",de,ue]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",de,ue]}],fill:[{fill:["none",...ee()]}],"stroke-w":[{stroke:[xe,Ir,Aa,Xd]}],stroke:[{stroke:["none",...ee()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},z1=b1(B1);function q1(...a){return z1(Ky(a))}const F1=ZE("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),sf=B.forwardRef(({className:a,variant:e,size:n,asChild:s=!1,...o},l)=>{const u=s?YE:"button";return b.jsx(u,{className:q1(F1({variant:e,size:n,className:a})),ref:l,...o})});sf.displayName="Button";function V1({headline:a,subheadline:e,guide:n,shortText:s,statistics:o,ctaText:l,onCtaClick:u}){return b.jsxs("section",{className:"relative h-[90vh] max-h-[920px] flex items-center justify-center overflow-hidden bg-gradient-to-br from-blue-50 via-green-50 to-blue-50 dark:from-blue-950/20 dark:via-green-950/20 dark:to-blue-950/20",children:[b.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_50%,rgba(59,130,246,0.1),transparent_50%),radial-gradient(circle_at_70%_50%,rgba(34,197,94,0.1),transparent_50%)]"}),b.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[b.jsxs("div",{className:"absolute top-0 left-0 w-full h-full",children:[b.jsx("div",{className:"absolute top-20 left-10 w-40 h-1 bg-gradient-to-r from-blue-400/50 to-transparent rotate-45 dark:from-blue-300/40"}),b.jsx("div",{className:"absolute top-32 left-20 w-32 h-1 bg-gradient-to-r from-green-400/50 to-transparent rotate-45 dark:from-green-300/40"}),b.jsx("div",{className:"absolute top-44 left-5 w-28 h-0.5 bg-gradient-to-r from-blue-300/40 to-transparent rotate-45 dark:from-blue-300/30"})]}),b.jsxs("div",{className:"absolute top-0 right-0 w-full h-full",children:[b.jsx("div",{className:"absolute top-16 right-12 w-36 h-1 bg-gradient-to-l from-green-400/50 to-transparent -rotate-45 dark:from-green-300/40"}),b.jsx("div",{className:"absolute top-28 right-24 w-28 h-1 bg-gradient-to-l from-blue-400/50 to-transparent -rotate-45 dark:from-blue-300/40"}),b.jsx("div",{className:"absolute top-40 right-8 w-24 h-0.5 bg-gradient-to-l from-green-300/40 to-transparent -rotate-45 dark:from-green-300/30"})]}),b.jsx("div",{className:"absolute top-3/4 right-1/3 w-8 h-8 bg-gradient-to-br from-blue-400/30 to-green-400/30 rounded-full dark:from-blue-300/20 dark:to-green-300/20"})]}),b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:b.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-10",children:[b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"space-y-3",children:[b.jsx("h1",{className:"text-5xl sm:text-6xl lg:text-7xl font-bold tracking-tight",children:b.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-primary to-green-600 dark:from-blue-400 dark:via-primary dark:to-green-400 bg-clip-text text-transparent",children:a})}),b.jsx("p",{className:"text-2xl sm:text-4xl font-semibold text-foreground",children:e})]}),b.jsxs("p",{className:"text-base sm:text-2xl text-muted-foreground font-medium",children:["Guided by ",b.jsxs("span",{className:"relative inline-block",children:[b.jsx("span",{className:"text-foreground font-semibold",children:"David Haye"}),b.jsx("span",{className:"absolute bottom-0 left-0 w-full h-[4px] bg-gradient-to-r from-blue-600 to-green-600 rounded-full opacity-80"})]})]})]}),b.jsx("p",{className:"text-xl sm:text-2xl text-foreground font-medium leading-relaxed",children:s}),b.jsx("div",{className:"pt-2",children:b.jsxs(sf,{size:"lg",onClick:u,className:"text-base sm:text-lg px-10 py-6 h-auto bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 dark:from-blue-500 dark:to-green-500 dark:hover:from-blue-600 dark:hover:to-green-600 text-white font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02]",children:[l,b.jsx(Fy,{className:"ml-2 h-5 w-5"})]})}),b.jsx("div",{className:"inline-flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-8 bg-card/50 dark:bg-card/30 backdrop-blur-sm border border-border rounded-2xl px-8 py-6 shadow-sm",children:o.map((d,f)=>b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-green-600 dark:from-blue-400 dark:to-green-400 bg-clip-text text-transparent",children:d.value}),b.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground font-medium text-left leading-tight",children:d.label}),f<o.length-1&&b.jsx("div",{className:"hidden sm:block w-px h-8 bg-border ml-4"})]},f))})]})})]})}function H1({heading:a,story:e,imageUrl:n}){return b.jsx("section",{className:"py-20 sm:py-28 bg-background",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-blue-100 to-green-100 dark:from-blue-900/30 dark:to-green-900/30 mb-6",children:b.jsx(AE,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-foreground",children:a})]}),b.jsxs("div",{className:"grid lg:grid-cols-3 gap-12 lg:gap-16 items-center",children:[b.jsx("div",{className:"order-2 lg:order-1",children:b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-green-500/20 rounded-3xl blur-2xl"}),b.jsx("img",{src:n,alt:"David Haye",className:"relative w-full aspect-2/3 object-cover rounded-3xl shadow-2xl border-4 border-white dark:border-border"})]})}),b.jsxs("div",{className:"order-1 lg:order-2 col-span-2 space-y-6",children:[e.map((s,o)=>b.jsx("p",{className:"text-lg leading-relaxed text-muted-foreground",children:s},o)),b.jsxs("div",{className:"pt-6 border-t border-border",children:[b.jsx("p",{className:"text-xl font-semibold text-foreground",children:"David Haye"}),b.jsx("p",{className:"text-sm text-muted-foreground",children:"Former Heavyweight Boxing Champion"})]})]})]})]})})})}function G1({phases:a}){return b.jsx("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-blue-50/50 via-background to-green-50/50 dark:from-blue-950/10 dark:via-background dark:to-green-950/10",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-foreground mb-4",children:"The 6-Month Program"}),b.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"A scientifically designed journey to help you break free from smoking, one phase at a time"})]}),b.jsx("div",{className:"grid md:grid-cols-3 gap-8 mb-12",children:a.map((e,n)=>b.jsxs("div",{className:"relative bg-card rounded-2xl p-8 shadow-lg border border-border hover:shadow-xl transition-shadow duration-300",children:[b.jsx("div",{className:"absolute -top-4 left-8",children:b.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-600 to-green-600 flex items-center justify-center text-white font-bold text-lg shadow-lg",children:n+1})}),b.jsxs("div",{className:"pt-6 space-y-4",children:[b.jsx("div",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:e.phase}),b.jsx("h3",{className:"text-xl font-bold text-foreground",children:e.title}),b.jsx("p",{className:"text-muted-foreground leading-relaxed",children:e.description}),b.jsxs("div",{className:"pt-2 flex items-center text-sm text-muted-foreground",children:[b.jsx(bE,{className:"w-4 h-4 mr-2 text-green-600 dark:text-green-400"}),e.duration]})]})]},n))}),b.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-green-600 rounded-2xl p-8 text-center shadow-xl",children:[b.jsx("div",{className:"flex items-center justify-center mb-4",children:b.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center",children:b.jsx(jE,{className:"w-6 h-6 text-white"})})}),b.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Free Weekly Check-ins with David's AI Voice"}),b.jsx("p",{className:"text-blue-50 text-lg max-w-2xl mx-auto",children:"Stay accountable with personalized conversations that adapt to your progress and challenges"})]})]})})})}function Y1({heading:a,subheading:e,results:n}){return b.jsx("section",{className:"py-20 sm:py-28 bg-background",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-blue-100 to-green-100 dark:from-blue-900/30 dark:to-green-900/30 mb-6",children:b.jsx(Hy,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-foreground mb-4",children:a}),b.jsx("p",{className:"text-lg text-muted-foreground",children:e})]}),b.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:n.map((s,o)=>b.jsxs("div",{className:`relative rounded-2xl p-8 border-2 transition-all duration-300 ${s.highlighted?"bg-gradient-to-br from-blue-600 to-green-600 border-transparent shadow-2xl scale-105":"bg-card border-border shadow-lg hover:shadow-xl"}`,children:[s.highlighted&&b.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:b.jsxs("div",{className:"bg-white dark:bg-card px-4 py-1 rounded-full flex items-center gap-2 shadow-lg",children:[b.jsx(mE,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),b.jsx("span",{className:"text-sm font-semibold text-foreground",children:"Best Results"})]})}),b.jsxs("div",{className:"text-center space-y-4 pt-4",children:[b.jsx("h3",{className:`text-xl font-bold ${s.highlighted?"text-white":"text-foreground"}`,children:s.method}),b.jsx("div",{className:`text-6xl font-bold ${s.highlighted?"text-white":"text-blue-600 dark:text-blue-400"}`,children:s.successRate}),b.jsx("p",{className:`text-sm leading-relaxed ${s.highlighted?"text-blue-50":"text-muted-foreground"}`,children:s.description})]})]},o))}),b.jsx("div",{className:"mt-12 text-center",children:b.jsx("p",{className:"text-sm text-muted-foreground max-w-3xl mx-auto",children:"Study conducted with 1,247 participants over 12 months. Success defined as complete cessation of combustible tobacco or sustained use of safer alternatives."})})]})})})}function K1({heading:a,traditional:e,smartNicotine:n}){return b.jsx("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-blue-50/50 via-background to-green-50/50 dark:from-blue-950/10 dark:via-background dark:to-green-950/10",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-foreground mb-4",children:a}),b.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"See how our science-based approach compares to traditional quit methods"})]}),b.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[b.jsxs("div",{className:"bg-card rounded-2xl p-8 shadow-lg border-2 border-border",children:[b.jsxs("div",{className:"mb-6",children:[b.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center mb-4",children:b.jsx(Zv,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),b.jsx("h3",{className:"text-2xl font-bold text-foreground",children:e.title})]}),b.jsx("ul",{className:"space-y-4",children:e.items.map((s,o)=>b.jsxs("li",{className:"flex items-start gap-3",children:[b.jsx("div",{className:"w-5 h-5 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center flex-shrink-0 mt-0.5",children:b.jsx(Zv,{className:"w-3 h-3 text-red-600 dark:text-red-400"})}),b.jsx("span",{className:"text-muted-foreground leading-relaxed",children:s})]},o))})]}),b.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-green-600 rounded-2xl p-8 shadow-2xl border-2 border-transparent relative overflow-hidden",children:[b.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-3xl"}),b.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white/10 rounded-full blur-3xl"}),b.jsxs("div",{className:"relative z-10",children:[b.jsxs("div",{className:"mb-6",children:[b.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center mb-4",children:b.jsx(Xv,{className:"w-6 h-6 text-white"})}),b.jsx("h3",{className:"text-2xl font-bold text-white",children:n.title})]}),b.jsx("ul",{className:"space-y-4",children:n.items.map((s,o)=>b.jsxs("li",{className:"flex items-start gap-3",children:[b.jsx("div",{className:"w-5 h-5 rounded-full bg-white/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:b.jsx(Xv,{className:"w-3 h-3 text-white"})}),b.jsx("span",{className:"text-blue-50 leading-relaxed font-medium",children:s})]},o))})]})]})]})]})})})}const Q1={ClipboardCheck:kE,MessageSquare:LE,Map:DE,GraduationCap:EE,LifeBuoy:NE,Users:zE};function J1({heading:a,subheading:e,benefits:n}){return b.jsx("section",{className:"py-20 sm:py-28 bg-background",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-foreground mb-4",children:a}),b.jsx("p",{className:"text-xl text-muted-foreground",children:e})]}),b.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8",children:n.map((s,o)=>{const l=Q1[s.icon];return b.jsxs("div",{className:"bg-card rounded-2xl p-8 shadow-lg border border-border hover:shadow-xl hover:border-blue-200 dark:hover:border-blue-800 transition-all duration-300 group",children:[b.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-blue-100 to-green-100 dark:from-blue-900/30 dark:to-green-900/30 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300",children:l&&b.jsx(l,{className:"w-7 h-7 text-blue-600 dark:text-blue-400"})}),b.jsx("h3",{className:"text-xl font-bold text-foreground mb-3",children:s.title}),b.jsx("p",{className:"text-muted-foreground leading-relaxed",children:s.description})]},o)})}),b.jsx("div",{className:"mt-16 text-center",children:b.jsxs("div",{className:"inline-block bg-gradient-to-r from-blue-50 to-green-50 dark:from-blue-950/30 dark:to-green-950/30 rounded-2xl px-8 py-6 border border-border",children:[b.jsx("p",{className:"text-lg font-semibold text-foreground mb-2",children:"All features are 100% free, forever"}),b.jsx("p",{className:"text-sm text-muted-foreground",children:"No hidden costs, no premium tiers, no credit card required"})]})})]})})})}function X1({heading:a,subheading:e,ctaText:n,note:s,onCtaClick:o}){return b.jsx("section",{className:"py-20 sm:py-28 bg-gradient-to-br from-blue-50/50 via-background to-green-50/50 dark:from-blue-950/10 dark:via-background dark:to-green-950/10",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-4xl mx-auto",children:[b.jsxs("div",{className:"relative bg-gradient-to-br from-blue-600 to-green-600 rounded-3xl p-12 sm:p-16 shadow-2xl overflow-hidden",children:[b.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),b.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),b.jsxs("div",{className:"relative z-10 text-center space-y-8",children:[b.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-white/20 backdrop-blur-sm",children:b.jsx(gE,{className:"w-8 h-8 text-white"})}),b.jsxs("div",{className:"space-y-4",children:[b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-white",children:a}),b.jsx("p",{className:"text-xl sm:text-2xl text-blue-50 font-medium",children:e})]}),b.jsx("div",{className:"pt-4",children:b.jsxs(sf,{size:"lg",onClick:o,className:"text-lg px-10 py-7 h-auto bg-white text-blue-600 hover:bg-blue-50 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",children:[n,b.jsx(Fy,{className:"ml-2 h-5 w-5"})]})}),b.jsx("p",{className:"text-blue-50 text-sm max-w-md mx-auto",children:s})]})]}),b.jsxs("div",{className:"mt-12 grid sm:grid-cols-3 gap-6 text-center",children:[b.jsxs("div",{className:"space-y-2",children:[b.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:"100%"}),b.jsx("div",{className:"text-sm text-muted-foreground",children:"Free Forever"})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:"6 Months"}),b.jsx("div",{className:"text-sm text-muted-foreground",children:"Structured Program"})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:"88%"}),b.jsx("div",{className:"text-sm text-muted-foreground",children:"Success Rate"})]})]})]})})})}const W1=[Hy,Vy,CE];function Z1({heading:a,mission:e,impact:n,footer:s}){return b.jsx("section",{className:"py-20 sm:py-28 bg-background border-t border-border",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"max-w-6xl mx-auto",children:[b.jsxs("div",{className:"text-center mb-12",children:[b.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-blue-100 to-green-100 dark:from-blue-900/30 dark:to-green-900/30 mb-6",children:b.jsx(Vy,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),b.jsx("h2",{className:"text-4xl sm:text-5xl font-bold text-foreground mb-6",children:a}),b.jsx("p",{className:"text-lg text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:e})]}),b.jsx("div",{className:"grid md:grid-cols-3 gap-8 mb-16",children:n.map((o,l)=>{const u=W1[l];return b.jsxs("div",{className:"bg-card rounded-2xl p-8 shadow-lg border border-border",children:[b.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-100 to-green-100 dark:from-blue-900/30 dark:to-green-900/30 flex items-center justify-center mb-6",children:b.jsx(u,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),b.jsx("h3",{className:"text-xl font-bold text-foreground mb-3",children:o.title}),b.jsx("p",{className:"text-muted-foreground leading-relaxed",children:o.description})]},l)})}),b.jsx("div",{className:"text-center pt-12 border-t border-border",children:b.jsx("p",{className:"text-sm text-muted-foreground",children:s})})]})})})}const Ts={headline:"Smart Nicotine",subheadline:"Science-Backed Smoking Cessation",guide:"Guided by David Haye",shortText:"Break Free From Smoking in 6 Months, Completely Free",statistics:[{value:"6M",label:"UK Smokers"},{value:"78K",label:"Annual Deaths"},{value:"21.8B",label:"Annual Cost to NHS"}],ctaText:"Start Free Assessment"},Wd={heading:"Your Personal Guide: David Haye",story:["When I was 14, I watched my uncle struggle with smoking. He tried everythingpatches, gum, willpowerbut nothing worked. At 52, he died from lung cancer, leaving behind a family who loved him.","That loss never left me. As a professional athlete, I learned that lasting change doesn't come from willpower alone. It comes from understanding the science, having the right support, and taking it one step at a time.","Smart Nicotine was born from that belief. This isn't about judgment or quick fixes. It's about giving you the tools, knowledge, and support to break freepermanently. And it's completely free, because everyone deserves a fighting chance."],imageUrl:"https://thesportingclub.co/wp-content/uploads/2023/03/david_haye-1-jpg.webp"},$1=[{phase:"Phase 1",title:"Understanding Combustion & Harm",description:"Learn the science behind smoking addiction and why combustion is the real enemy. Understand what nicotine does and doesn't do to your body.",duration:"Weeks 1-8"},{phase:"Phase 2",title:"Transitional Safer Nicotine Methods",description:"Gradually shift to harm-reduction alternatives while maintaining your routine. Reduce combustion exposure by 95% while managing cravings.",duration:"Weeks 9-20"},{phase:"Phase 3",title:"Complete Freedom or Long-Term Safer Use",description:"Choose your path: complete nicotine freedom or continued use of safer alternatives. Both are victories worth celebrating.",duration:"Weeks 21-26"}],Zd={heading:"Cambridge University Clinical Study",subheading:"Internal Study Results (2024)",results:[{method:"Cold Turkey",successRate:"<10%",description:"Traditional quit attempts without support"},{method:"Smart Nicotine with Weekly Check-ins",successRate:"88%",description:"Consistent engagement with AI-guided support",highlighted:!0},{method:"Smart Nicotine with Inconsistent Check-ins",successRate:"46%",description:"Sporadic engagement with the program"}]},$d={heading:"Why This Works",traditional:{title:"Traditional Methods",items:["One-size-fits-all approach","Relies solely on willpower","No ongoing accountability","Limited scientific education","High relapse rates"]},smartNicotine:{title:"Smart Nicotine",items:["Personalized guidance for your lifestyle","Science-based harm reduction","Weekly AI check-ins with David's voice","Comprehensive addiction education","88% success rate with consistency"]}},eh={heading:"What You Get",subheading:"Everything you need to succeed, completely free",benefits:[{title:"Free Personal Assessment",description:"Understand your smoking patterns and create a custom roadmap",icon:"ClipboardCheck"},{title:"Weekly AI Conversations",description:"Check-ins with David Haye's AI voice for accountability and support",icon:"MessageSquare"},{title:"Customized Roadmap",description:"A 6-month plan tailored to your lifestyle and goals",icon:"Map"},{title:"Scientific Education",description:"Learn the real science behind nicotine and combustion",icon:"GraduationCap"},{title:"Crisis Support",description:"24/7 access to resources when cravings hit hardest",icon:"LifeBuoy"},{title:"Community Support",description:"Connect with others on the same journey",icon:"Users"}]},Al={heading:"Start Your Journey Today",subheading:"Next cohort starts January 1st, 2026",ctaText:"Join the Waiting List",note:"Limited spots available. 100% free, no credit card required."},Ml={heading:"Smart Nicotine Foundation",mission:"Smart Nicotine is a registered charity dedicated to ending smoking-related deaths in the UK. Our mission is simple: save 600,000 lives over the next decade through science-based harm reduction.",impact:[{title:"Population Health Impact",description:"By helping smokers transition to safer alternatives or quit entirely, we're reducing the burden of smoking-related disease across the UK."},{title:"NHS Cost Reduction",description:"Every successful participant saves the NHS an estimated 36,000 in lifetime healthcare costsmoney that can be reinvested in other critical services."},{title:"Evidence-Based Approach",description:"We partner with leading universities and health organizations to ensure our methods are grounded in the latest scientific research."}],footer:"Registered Charity No. 1234567 |  2026 Smart Nicotine Foundation"};function ew(){const a=Oy(),e=()=>{a("/assessment")};return b.jsxs("div",{className:"w-full",children:[b.jsx(V1,{headline:Ts.headline,subheadline:Ts.subheadline,guide:Ts.guide,shortText:Ts.shortText,statistics:Ts.statistics,ctaText:Ts.ctaText,onCtaClick:e}),b.jsx(H1,{heading:Wd.heading,story:Wd.story,imageUrl:Wd.imageUrl}),b.jsx(G1,{phases:$1}),b.jsx(Y1,{heading:Zd.heading,subheading:Zd.subheading,results:Zd.results}),b.jsx(K1,{heading:$d.heading,traditional:$d.traditional,smartNicotine:$d.smartNicotine}),b.jsx(J1,{heading:eh.heading,subheading:eh.subheading,benefits:eh.benefits}),b.jsx(X1,{heading:Al.heading,subheading:Al.subheading,ctaText:Al.ctaText,note:Al.note,onCtaClick:e}),b.jsx(Z1,{heading:Ml.heading,mission:Ml.mission,impact:Ml.impact,footer:Ml.footer})]})}function tw(){return b.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-green-50 to-blue-50 dark:from-blue-950/20 dark:via-green-950/20 dark:to-blue-950/20",children:b.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:b.jsxs("div",{className:"max-w-4xl mx-auto",children:[b.jsxs("div",{className:"text-center space-y-6 mb-8",children:[b.jsxs("div",{className:"space-y-3",children:[b.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold tracking-tight",children:b.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-primary to-green-600 dark:from-blue-400 dark:via-primary dark:to-green-400 bg-clip-text text-transparent",children:"Free Assessment"})}),b.jsx("p",{className:"text-xl sm:text-2xl text-muted-foreground font-medium",children:"Take the first step towards your smoke-free journey"})]}),b.jsx("p",{className:"text-lg text-foreground leading-relaxed max-w-2xl mx-auto",children:"This personalized assessment will help us understand your smoking patterns and create a tailored roadmap for your success. It takes just 5 minutes to complete."})]}),b.jsx("div",{className:"bg-card/50 dark:bg-card/30 backdrop-blur-sm border border-border rounded-2xl overflow-hidden shadow-lg",children:b.jsx("div",{className:"w-full",style:{height:"600px"},children:b.jsx("iframe",{src:"https://form.typeform.com/to/DhUzA1Mm",className:"w-full h-full border-0",title:"Smart Nicotine Assessment",allow:"camera; microphone; autoplay; encrypted-media; fullscreen"})})}),b.jsxs("div",{className:"mt-8 text-center space-y-4",children:[b.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[b.jsxs("span",{className:"flex items-center gap-2",children:[b.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"100% Free"]}),b.jsxs("span",{className:"flex items-center gap-2",children:[b.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"No Credit Card Required"]}),b.jsxs("span",{className:"flex items-center gap-2",children:[b.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Science-Backed"]})]}),b.jsx("p",{className:"text-xs text-muted-foreground",children:"Your responses are confidential and will only be used to create your personalized quit plan."})]})]})})})}const nw=()=>{const[a,e]=B.useState(""),[n,s]=B.useState(!1),[o,l]=B.useState(""),[u,d]=B.useState(null),f=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;B.useEffect(()=>{const T=new URLSearchParams(window.location.search).get("email");T&&f.test(T)&&(e(T),m(T))},[]),B.useEffect(()=>{const T=document.createElement("script");return T.src="https://unpkg.com/@elevenlabs/convai-widget-embed",T.async=!0,T.onload=()=>{u&&setTimeout(()=>{v()},2e3)},document.body.appendChild(T),()=>{const x=document.querySelector('script[src="https://unpkg.com/@elevenlabs/convai-widget-embed"]');x&&document.body.removeChild(x)}},[u]);const m=async T=>{s(!0),l("");try{const E=await fetch(`http://localhost:3000/api/user?email=${encodeURIComponent(T)}`);if(E.ok){const D=await E.json();d(D)}else if(E.status===404)l("We couldn't find your assessment. Enter your email again."),d(null);else throw new Error("Failed to load user profile")}catch{l("Unable to load your profile. Please try again.")}finally{s(!1)}},g=T=>{if(!T)return{};const x=T.answers||{};return{first_name:x["First name"]||"",last_name:x["Last name"]||"",date_of_birth:x["Date of birth"]||"",email:T.email||"",family_role:x["Which of these best describes you?"]||"",smoking_duration:x["How long have you smoked cigarettes?"]||"",brand:x["What is your preferred cigarette brand?"]||"",cigs_per_day:x["On average, how many cigarettes do you smoke per day?"]||"",quit_attempts:x["How many times have you seriously tried to quit smoking?"]||"",long_quits:x["How many times have you quit smoking for 30 days or more?"]||"",motivation:x["What is your main motivation for wanting to quit smoking?"]||""}},v=()=>{try{console.log(" Auto-starting ElevenLabs conversation...");const T=document.querySelector("elevenlabs-convai");if(T&&T.shadowRoot){const x=T.shadowRoot.querySelector('[data-testid="start-button"], button[class*="start"], button[class*="action"]');x?(x.click(),console.log(" Auto-started conversation")):console.log(" Start button not found in widget")}else console.log(" Widget or shadow root not found")}catch(T){console.error(" Error auto-starting conversation:",T)}},S=T=>{if(T.preventDefault(),!a||!f.test(a)){l("Please enter a valid email address");return}window.location.href=`/chat?email=${encodeURIComponent(a)}`};return n?b.jsxs("div",{style:bn.loadingContainer,children:[b.jsx("div",{style:bn.spinner}),b.jsx("p",{children:"Preparing your personalized session"})]}):u?b.jsxs(b.Fragment,{children:[b.jsx("style",{children:`
        elevenlabs-convai {
          width: 100% !important;
          height: 100% !important;
          max-width: none !important;
          max-height: none !important;
        }
        
        /* Hide the default ElevenLabs widget positioning */
        elevenlabs-convai > div {
          position: static !important;
          bottom: auto !important;
          right: auto !important;
          width: 100% !important;
          height: 100% !important;
          max-width: none !important;
          max-height: none !important;
        }
        
        /* Style the widget button to be more prominent */
        elevenlabs-convai::part(action-button) {
          background: linear-gradient(135deg, #4CAF50, #45a049) !important;
          border: none !important;
          border-radius: 12px !important;
          padding: 16px 32px !important;
          font-size: 18px !important;
          font-weight: 600 !important;
          box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3) !important;
          transition: all 0.3s ease !important;
        }
        
        elevenlabs-convai::part(action-button):hover {
          transform: translateY(-2px) !important;
          box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4) !important;
        }
      `}),b.jsxs("div",{style:bn.fullScreenContainer,children:[b.jsxs("div",{style:bn.header,children:[b.jsx("h1",{style:bn.title,children:"Smart Nicotine AI Guide"}),b.jsxs("p",{style:bn.subtitle,children:["Chat with David Haye  ",u==null?void 0:u.email]})]}),b.jsx("div",{style:bn.chatWidgetContainer,children:b.jsx("elevenlabs-convai",{"agent-id":"agent_2901kb13dkgbemkbxhve2tbsymd2","dynamic-variables":JSON.stringify(g(u)),"override-language":"en",variant:"expanded","action-text":"Start Chat with David Haye","start-call-text":"Begin Conversation"})})]})]}):b.jsx("div",{style:bn.emailContainer,children:b.jsxs("div",{style:bn.emailForm,children:[b.jsx("h2",{children:"Smart Nicotine AI Guide"}),b.jsx("p",{children:"Enter your email to continue"}),o&&b.jsx("div",{style:bn.error,children:o}),b.jsxs("form",{onSubmit:S,children:[b.jsx("input",{type:"email",value:a,onChange:T=>e(T.target.value),placeholder:"your.email@example.com",style:bn.emailInput,required:!0}),b.jsx("button",{type:"submit",style:bn.emailButton,children:"Continue"})]})]})})},bn={emailContainer:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",padding:"20px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},emailForm:{background:"white",padding:"40px",borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",textAlign:"center",maxWidth:"400px",width:"100%"},emailInput:{width:"100%",padding:"12px 16px",border:"2px solid #e1e5e9",borderRadius:"8px",fontSize:"16px",marginBottom:"20px",boxSizing:"border-box",fontFamily:"inherit"},emailButton:{background:"#4CAF50",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",cursor:"pointer",width:"100%",fontFamily:"inherit"},error:{background:"#fee",color:"#c53030",padding:"12px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #fed7d7"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},spinner:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #4CAF50",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"20px"},fullScreenContainer:{display:"flex",flexDirection:"column",height:"100vh",width:"100vw",background:"#f8f9fa",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',overflow:"hidden"},header:{background:"linear-gradient(135deg, #4CAF50, #45a049)",color:"white",padding:"16px 24px",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",zIndex:10},title:{margin:"0 0 4px 0",fontSize:"24px",fontWeight:"600"},subtitle:{margin:"0",fontSize:"14px",opacity:.9,fontWeight:"400"},chatWidgetContainer:{flex:1,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"#ffffff",position:"relative"}};var l0={};function iw(a,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(s){if(s!=="default"&&!(s in a)){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})}})}),Object.freeze(a)}var aw=Object.defineProperty,sw=(a,e,n)=>e in a?aw(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n,c0=(a,e,n)=>sw(a,typeof e!="symbol"?e+"":e,n);let Bt=class{constructor(){c0(this,"_locking"),c0(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(o=>e=()=>{this._locks-=1,o()}),s=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),s}};function lt(a,e){if(!a)throw new Error(e)}const rw=34028234663852886e22,ow=-34028234663852886e22,lw=4294967295,cw=2147483647,uw=-2147483648;function Il(a){if(typeof a!="number")throw new Error("invalid int 32: "+typeof a);if(!Number.isInteger(a)||a>cw||a<uw)throw new Error("invalid int 32: "+a)}function Ch(a){if(typeof a!="number")throw new Error("invalid uint 32: "+typeof a);if(!Number.isInteger(a)||a>lw||a<0)throw new Error("invalid uint 32: "+a)}function rb(a){if(typeof a!="number")throw new Error("invalid float 32: "+typeof a);if(Number.isFinite(a)&&(a>rw||a<ow))throw new Error("invalid float 32: "+a)}const ob=Symbol("@bufbuild/protobuf/enum-type");function dw(a){const e=a[ob];return lt(e,"missing enum type on enum object"),e}function lb(a,e,n,s){a[ob]=cb(e,n.map(o=>({no:o.no,name:o.name,localName:a[o.no]})))}function cb(a,e,n){const s=Object.create(null),o=Object.create(null),l=[];for(const u of e){const d=ub(u);l.push(d),s[u.name]=d,o[u.no]=d}return{typeName:a,values:l,findName(u){return s[u]},findNumber(u){return o[u]}}}function hw(a,e,n){const s={};for(const o of e){const l=ub(o);s[l.localName]=l.no,s[l.no]=l.localName}return lb(s,a,e),s}function ub(a){return"localName"in a?a:Object.assign(Object.assign({},a),{localName:a.name})}class rf{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const s=this.getType(),o=s.runtime.bin,l=o.makeReadOptions(n);return o.readMessage(this,l.readerFactory(e),e.byteLength,l),this}fromJson(e,n){const s=this.getType(),o=s.runtime.json,l=o.makeReadOptions(n);return o.readMessage(s,e,l,this),this}fromJsonString(e,n){let s;try{s=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(s,n)}toBinary(e){const n=this.getType(),s=n.runtime.bin,o=s.makeWriteOptions(e),l=o.writerFactory();return s.writeMessage(this,l,o),l.finish()}toJson(e){const n=this.getType(),s=n.runtime.json,o=s.makeWriteOptions(e);return s.writeMessage(this,o)}toJsonString(e){var n;const s=this.toJson(e);return JSON.stringify(s,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function fw(a,e,n,s){var o;const l=(o=s==null?void 0:s.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),u={[l]:function(d){a.util.initFields(this),a.util.initPartial(d,this)}}[l];return Object.setPrototypeOf(u.prototype,new rf),Object.assign(u,{runtime:a,typeName:e,fields:a.util.newFieldList(n),fromBinary(d,f){return new u().fromBinary(d,f)},fromJson(d,f){return new u().fromJson(d,f)},fromJsonString(d,f){return new u().fromJsonString(d,f)},equals(d,f){return a.util.equals(u,d,f)}}),u}function mw(){let a=0,e=0;for(let s=0;s<28;s+=7){let o=this.buf[this.pos++];if(a|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}let n=this.buf[this.pos++];if(a|=(n&15)<<28,e=(n&112)>>4,(n&128)==0)return this.assertBounds(),[a,e];for(let s=3;s<=31;s+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}throw new Error("invalid varint")}function th(a,e,n){for(let l=0;l<28;l=l+7){const u=a>>>l,d=!(!(u>>>7)&&e==0),f=(d?u|128:u)&255;if(n.push(f),!d)return}const s=a>>>28&15|(e&7)<<4,o=e>>3!=0;if(n.push((o?s|128:s)&255),!!o){for(let l=3;l<31;l=l+7){const u=e>>>l,d=!!(u>>>7),f=(d?u|128:u)&255;if(n.push(f),!d)return}n.push(e>>>31&1)}}const jl=4294967296;function u0(a){const e=a[0]==="-";e&&(a=a.slice(1));const n=1e6;let s=0,o=0;function l(u,d){const f=Number(a.slice(u,d));o*=n,s=s*n+f,s>=jl&&(o=o+(s/jl|0),s=s%jl)}return l(-24,-18),l(-18,-12),l(-12,-6),l(-6),e?hb(s,o):of(s,o)}function pw(a,e){let n=of(a,e);const s=n.hi&2147483648;s&&(n=hb(n.lo,n.hi));const o=db(n.lo,n.hi);return s?"-"+o:o}function db(a,e){if({lo:a,hi:e}=gw(a,e),e<=2097151)return String(jl*e+a);const n=a&16777215,s=(a>>>24|e<<8)&16777215,o=e>>16&65535;let l=n+s*6777216+o*6710656,u=s+o*8147497,d=o*2;const f=1e7;return l>=f&&(u+=Math.floor(l/f),l%=f),u>=f&&(d+=Math.floor(u/f),u%=f),d.toString()+d0(u)+d0(l)}function gw(a,e){return{lo:a>>>0,hi:e>>>0}}function of(a,e){return{lo:a|0,hi:e|0}}function hb(a,e){return e=~e,a?a=~a+1:e+=1,of(a,e)}const d0=a=>{const e=String(a);return"0000000".slice(e.length)+e};function h0(a,e){if(a>=0){for(;a>127;)e.push(a&127|128),a=a>>>7;e.push(a)}else{for(let n=0;n<9;n++)e.push(a&127|128),a=a>>7;e.push(1)}}function vw(){let a=this.buf[this.pos++],e=a&127;if((a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<7,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<14,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<21,(a&128)==0)return this.assertBounds(),e;a=this.buf[this.pos++],e|=(a&15)<<28;for(let n=5;(a&128)!==0&&n<10;n++)a=this.buf[this.pos++];if((a&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function yw(){const a=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof a.getBigInt64=="function"&&typeof a.getBigUint64=="function"&&typeof a.setBigInt64=="function"&&typeof a.setBigUint64=="function"&&(typeof process!="object"||typeof l0!="object"||l0.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),l=BigInt("9223372036854775807"),u=BigInt("0"),d=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(f){const m=typeof f=="bigint"?f:BigInt(f);if(m>l||m<o)throw new Error("int64 invalid: ".concat(f));return m},uParse(f){const m=typeof f=="bigint"?f:BigInt(f);if(m>d||m<u)throw new Error("uint64 invalid: ".concat(f));return m},enc(f){return a.setBigInt64(0,this.parse(f),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},uEnc(f){return a.setBigInt64(0,this.uParse(f),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},dec(f,m){return a.setInt32(0,f,!0),a.setInt32(4,m,!0),a.getBigInt64(0,!0)},uDec(f,m){return a.setInt32(0,f,!0),a.setInt32(4,m,!0),a.getBigUint64(0,!0)}}}const n=o=>lt(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),s=o=>lt(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),n(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),s(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),n(o),u0(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),s(o),u0(o)},dec(o,l){return pw(o,l)},uDec(o,l){return db(o,l)}}}const it=yw();var $;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})($||($={}));var ra;(function(a){a[a.BIGINT=0]="BIGINT",a[a.STRING=1]="STRING"})(ra||(ra={}));function Zi(a,e,n){if(e===n)return!0;if(a==$.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==n[s])return!1;return!0}switch(a){case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return e==n}return!1}function Ls(a,e){switch(a){case $.BOOL:return!1;case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return e==0?it.zero:"0";case $.DOUBLE:case $.FLOAT:return 0;case $.BYTES:return new Uint8Array(0);case $.STRING:return"";default:return 0}}function fb(a,e){switch(a){case $.BOOL:return e===!1;case $.STRING:return e==="";case $.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var ht;(function(a){a[a.Varint=0]="Varint",a[a.Bit64=1]="Bit64",a[a.LengthDelimited=2]="LengthDelimited",a[a.StartGroup=3]="StartGroup",a[a.EndGroup=4]="EndGroup",a[a.Bit32=5]="Bit32"})(ht||(ht={}));class bw{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let n=new Uint8Array(e),s=0;for(let o=0;o<this.chunks.length;o++)n.set(this.chunks[o],s),s+=this.chunks[o].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Ch(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Il(e),h0(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){rb(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Ch(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Il(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Il(e),e=(e<<1^e>>31)>>>0,h0(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),s=new DataView(n.buffer),o=it.enc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),s=new DataView(n.buffer),o=it.uEnc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(n)}int64(e){let n=it.enc(e);return th(n.lo,n.hi,this.buf),this}sint64(e){let n=it.enc(e),s=n.hi>>31,o=n.lo<<1^s,l=(n.hi<<1|n.lo>>>31)^s;return th(o,l,this.buf),this}uint64(e){let n=it.uEnc(e);return th(n.lo,n.hi,this.buf),this}}class Sw{constructor(e,n){this.varint64=mw,this.uint32=vw,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,s=e&7;if(n<=0||s<0||s>5)throw new Error("illegal tag: field no "+n+" wire type "+s);return[n,s]}skip(e,n){let s=this.pos;switch(e){case ht.Varint:for(;this.buf[this.pos++]&128;);break;case ht.Bit64:this.pos+=4;case ht.Bit32:this.pos+=4;break;case ht.LengthDelimited:let o=this.uint32();this.pos+=o;break;case ht.StartGroup:for(;;){const[l,u]=this.tag();if(u===ht.EndGroup){if(n!==void 0&&l!==n)throw new Error("invalid end group tag");break}this.skip(u,l)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(s,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return it.dec(...this.varint64())}uint64(){return it.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),s=-(e&1);return e=(e>>>1|(n&1)<<31)^s,n=n>>>1^s,it.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return it.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return it.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function kw(a,e,n,s){let o;return{typeName:e,extendee:n,get field(){if(!o){const l=typeof s=="function"?s():s;l.name=e.split(".").pop(),l.jsonName="[".concat(e,"]"),o=a.util.newFieldList([l]).list()[0]}return o},runtime:a}}function mb(a){const e=a.field.localName,n=Object.create(null);return n[e]=Tw(a),[n,()=>n[e]]}function Tw(a){const e=a.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Ls(e.T,e.L);case"message":const n=e.T,s=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(s):s;case"map":throw"map fields are not allowed to be extensions"}}function Cw(a,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=a.length-1;n>=0;--n)if(a[n].no==e.no)return[a[n]];return[]}return a.filter(n=>n.no===e.no)}let mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),pc=[];for(let a=0;a<mi.length;a++)pc[mi[a].charCodeAt(0)]=a;pc[45]=mi.indexOf("+");pc[95]=mi.indexOf("/");const pb={dec(a){let e=a.length*3/4;a[a.length-2]=="="?e-=2:a[a.length-1]=="="&&(e-=1);let n=new Uint8Array(e),s=0,o=0,l,u=0;for(let d=0;d<a.length;d++){if(l=pc[a.charCodeAt(d)],l===void 0)switch(a[d]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:u=l,o=1;break;case 1:n[s++]=u<<2|(l&48)>>4,u=l,o=2;break;case 2:n[s++]=(u&15)<<4|(l&60)>>2,u=l,o=3;break;case 3:n[s++]=(u&3)<<6|l,o=0;break}}if(o==1)throw Error("invalid base64 string.");return n.subarray(0,s)},enc(a){let e="",n=0,s,o=0;for(let l=0;l<a.length;l++)switch(s=a[l],n){case 0:e+=mi[s>>2],o=(s&3)<<4,n=1;break;case 1:e+=mi[o|s>>4],o=(s&15)<<2,n=2;break;case 2:e+=mi[o|s>>6],e+=mi[s&63],n=0;break}return n&&(e+=mi[o],e+="=",n==1&&(e+="=")),e}};function xw(a,e,n){vb(e,a);const s=e.runtime.bin.makeReadOptions(n),o=Cw(a.getType().runtime.bin.listUnknownFields(a),e.field),[l,u]=mb(e);for(const d of o)e.runtime.bin.readField(l,s.readerFactory(d.data),e.field,d.wireType,s);return u()}function Ew(a,e,n,s){vb(e,a);const o=e.runtime.bin.makeReadOptions(s),l=e.runtime.bin.makeWriteOptions(s);if(gb(a,e)){const m=a.getType().runtime.bin.listUnknownFields(a).filter(g=>g.no!=e.field.no);a.getType().runtime.bin.discardUnknownFields(a);for(const g of m)a.getType().runtime.bin.onUnknownField(a,g.no,g.wireType,g.data)}const u=l.writerFactory();let d=e.field;!d.opt&&!d.repeated&&(d.kind=="enum"||d.kind=="scalar")&&(d=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(d,n,u,l);const f=o.readerFactory(u.finish());for(;f.pos<f.len;){const[m,g]=f.tag(),v=f.skip(g,m);a.getType().runtime.bin.onUnknownField(a,m,g,v)}}function gb(a,e){const n=a.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(a).find(s=>s.no==e.field.no)}function vb(a,e){lt(a.extendee.typeName==e.getType().typeName,"extension ".concat(a.typeName," can only be applied to message ").concat(a.extendee.typeName))}function yb(a,e){const n=a.localName;if(a.repeated)return e[n].length>0;if(a.oneof)return e[a.oneof.localName].case===n;switch(a.kind){case"enum":case"scalar":return a.opt||a.req?e[n]!==void 0:a.kind=="enum"?e[n]!==a.T.values[0].no:!fb(a.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function f0(a,e){const n=a.localName,s=!a.opt&&!a.req;if(a.repeated)e[n]=[];else if(a.oneof)e[a.oneof.localName]={case:void 0};else switch(a.kind){case"map":e[n]={};break;case"enum":e[n]=s?a.T.values[0].no:void 0;break;case"scalar":e[n]=s?Ls(a.T,a.L):void 0;break;case"message":e[n]=void 0;break}}function pi(a,e){if(a===null||typeof a!="object"||!Object.getOwnPropertyNames(rf.prototype).every(s=>s in a&&typeof a[s]=="function"))return!1;const n=a.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function bb(a,e){return pi(e)||!a.fieldWrapper?e:a.fieldWrapper.wrapField(e)}$.DOUBLE,$.FLOAT,$.INT64,$.UINT64,$.INT32,$.UINT32,$.BOOL,$.STRING,$.BYTES;const m0={ignoreUnknownFields:!1},p0={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function ww(a){return a?Object.assign(Object.assign({},m0),a):m0}function _w(a){return a?Object.assign(Object.assign({},p0),a):p0}const Zl=Symbol(),Ul=Symbol();function Rw(){return{makeReadOptions:ww,makeWriteOptions:_w,readMessage(a,e,n,s){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(a.typeName," from JSON: ").concat(zn(e)));s=s??new a;const o=new Map,l=n.typeRegistry;for(const[u,d]of Object.entries(e)){const f=a.fields.findJsonName(u);if(f){if(f.oneof){if(d===null&&f.kind=="scalar")continue;const m=o.get(f.oneof);if(m!==void 0)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: multiple keys for oneof "').concat(f.oneof.name,'" present: "').concat(m,'", "').concat(u,'"'));o.set(f.oneof,u)}g0(s,d,f,n,a)}else{let m=!1;if(l!=null&&l.findExtension&&u.startsWith("[")&&u.endsWith("]")){const g=l.findExtension(u.substring(1,u.length-1));if(g&&g.extendee.typeName==a.typeName){m=!0;const[v,S]=mb(g);g0(v,d,g.field,n,g),Ew(s,g,S(),n)}}if(!m&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: key "').concat(u,'" is unknown'))}}return s},writeMessage(a,e){const n=a.getType(),s={};let o;try{for(o of n.fields.byNumber()){if(!yb(o,a)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!Mw(o))continue}const u=o.oneof?a[o.oneof.localName].value:a[o.localName],d=v0(o,u,e);d!==void 0&&(s[e.useProtoFieldName?o.name:o.jsonName]=d)}const l=e.typeRegistry;if(l!=null&&l.findExtensionFor)for(const u of n.runtime.bin.listUnknownFields(a)){const d=l.findExtensionFor(n.typeName,u.no);if(d&&gb(a,d)){const f=xw(a,d,e),m=v0(d.field,f,e);m!==void 0&&(s[d.field.jsonName]=m)}}}catch(l){const u=o?"cannot encode field ".concat(n.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),d=l instanceof Error?l.message:String(l);throw new Error(u+(d.length>0?": ".concat(d):""))}return s},readScalar(a,e,n){return Yr(a,e,n??ra.BIGINT,!0)},writeScalar(a,e,n){if(e!==void 0&&(n||fb(a,e)))return Bl(a,e)},debug:zn}}function zn(a){if(a===null)return"null";switch(typeof a){case"object":return Array.isArray(a)?"array":"object";case"string":return a.length>100?"string":'"'.concat(a.split('"').join('\\"'),'"');default:return String(a)}}function g0(a,e,n,s,o){let l=n.localName;if(n.repeated){if(lt(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(e)));const u=a[l];for(const d of e){if(d===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(d)));switch(n.kind){case"message":u.push(n.T.fromJson(d,s));break;case"enum":const f=nh(n.T,d,s.ignoreUnknownFields,!0);f!==Ul&&u.push(f);break;case"scalar":try{u.push(Yr(n.T,d,n.L,!0))}catch(m){let g="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(d));throw m instanceof Error&&m.message.length>0&&(g+=": ".concat(m.message)),new Error(g)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(e)));const u=a[l];for(const[d,f]of Object.entries(e)){if(f===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: map value null"));let m;try{m=Aw(n.K,d)}catch(g){let v="cannot decode map key for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(e));throw g instanceof Error&&g.message.length>0&&(v+=": ".concat(g.message)),new Error(v)}switch(n.V.kind){case"message":u[m]=n.V.T.fromJson(f,s);break;case"enum":const g=nh(n.V.T,f,s.ignoreUnknownFields,!0);g!==Ul&&(u[m]=g);break;case"scalar":try{u[m]=Yr(n.V.T,f,ra.BIGINT,!0)}catch(v){let S="cannot decode map value for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(e));throw v instanceof Error&&v.message.length>0&&(S+=": ".concat(v.message)),new Error(S)}break}}}else switch(n.oneof&&(a=a[n.oneof.localName]={case:l},l="value"),n.kind){case"message":const u=n.T;if(e===null&&u.typeName!="google.protobuf.Value")return;let d=a[l];pi(d)?d.fromJson(e,s):(a[l]=d=u.fromJson(e,s),u.fieldWrapper&&!n.oneof&&(a[l]=u.fieldWrapper.unwrapField(d)));break;case"enum":const f=nh(n.T,e,s.ignoreUnknownFields,!1);switch(f){case Zl:f0(n,a);break;case Ul:break;default:a[l]=f;break}break;case"scalar":try{const m=Yr(n.T,e,n.L,!1);switch(m){case Zl:f0(n,a);break;default:a[l]=m;break}}catch(m){let g="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(zn(e));throw m instanceof Error&&m.message.length>0&&(g+=": ".concat(m.message)),new Error(g)}break}}function Aw(a,e){if(a===$.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Yr(a,e,ra.BIGINT,!0).toString()}function Yr(a,e,n,s){if(e===null)return s?Ls(a,n):Zl;switch(a){case $.DOUBLE:case $.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return a==$.FLOAT&&rb(o),o;case $.INT32:case $.FIXED32:case $.SFIXED32:case $.SINT32:case $.UINT32:let l;if(typeof e=="number"?l=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(l=Number(e)),l===void 0)break;return a==$.UINT32||a==$.FIXED32?Ch(l):Il(l),l;case $.INT64:case $.SFIXED64:case $.SINT64:if(typeof e!="number"&&typeof e!="string")break;const u=it.parse(e);return n?u.toString():u;case $.FIXED64:case $.UINT64:if(typeof e!="number"&&typeof e!="string")break;const d=it.uParse(e);return n?d.toString():d;case $.BOOL:if(typeof e!="boolean")break;return e;case $.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case $.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return pb.dec(e)}throw new Error}function nh(a,e,n,s){if(e===null)return a.typeName=="google.protobuf.NullValue"?0:s?a.values[0].no:Zl;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=a.findName(e);if(o!==void 0)return o.no;if(n)return Ul;break}throw new Error("cannot decode enum ".concat(a.typeName," from JSON: ").concat(zn(e)))}function Mw(a){return a.repeated||a.kind=="map"?!0:!(a.oneof||a.kind=="message"||a.opt||a.req)}function v0(a,e,n){if(a.kind=="map"){lt(typeof e=="object"&&e!=null);const s={},o=Object.entries(e);switch(a.V.kind){case"scalar":for(const[u,d]of o)s[u.toString()]=Bl(a.V.T,d);break;case"message":for(const[u,d]of o)s[u.toString()]=d.toJson(n);break;case"enum":const l=a.V.T;for(const[u,d]of o)s[u.toString()]=ih(l,d,n.enumAsInteger);break}return n.emitDefaultValues||o.length>0?s:void 0}if(a.repeated){lt(Array.isArray(e));const s=[];switch(a.kind){case"scalar":for(let o=0;o<e.length;o++)s.push(Bl(a.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)s.push(ih(a.T,e[o],n.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)s.push(e[o].toJson(n));break}return n.emitDefaultValues||s.length>0?s:void 0}switch(a.kind){case"scalar":return Bl(a.T,e);case"enum":return ih(a.T,e,n.enumAsInteger);case"message":return bb(a.T,e).toJson(n)}}function ih(a,e,n){var s;if(lt(typeof e=="number"),a.typeName=="google.protobuf.NullValue")return null;if(n)return e;const o=a.findNumber(e);return(s=o==null?void 0:o.name)!==null&&s!==void 0?s:e}function Bl(a,e){switch(a){case $.INT32:case $.SFIXED32:case $.SINT32:case $.FIXED32:case $.UINT32:return lt(typeof e=="number"),e;case $.FLOAT:case $.DOUBLE:return lt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case $.STRING:return lt(typeof e=="string"),e;case $.BOOL:return lt(typeof e=="boolean"),e;case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return lt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case $.BYTES:return lt(e instanceof Uint8Array),pb.enc(e)}}const Cs=Symbol("@bufbuild/protobuf/unknown-fields"),y0={readUnknownFields:!0,readerFactory:a=>new Sw(a)},b0={writeUnknownFields:!0,writerFactory:()=>new bw};function Nw(a){return a?Object.assign(Object.assign({},y0),a):y0}function Ow(a){return a?Object.assign(Object.assign({},b0),a):b0}function Dw(){return{makeReadOptions:Nw,makeWriteOptions:Ow,listUnknownFields(a){var e;return(e=a[Cs])!==null&&e!==void 0?e:[]},discardUnknownFields(a){delete a[Cs]},writeUnknownFields(a,e){const s=a[Cs];if(s)for(const o of s)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(a,e,n,s){const o=a;Array.isArray(o[Cs])||(o[Cs]=[]),o[Cs].push({no:e,wireType:n,data:s})},readMessage(a,e,n,s,o){const l=a.getType(),u=o?e.len:e.pos+n;let d,f;for(;e.pos<u&&([d,f]=e.tag(),!(o===!0&&f==ht.EndGroup));){const m=l.fields.find(d);if(!m){const g=e.skip(f,d);s.readUnknownFields&&this.onUnknownField(a,d,f,g);continue}S0(a,e,m,f,s)}if(o&&(f!=ht.EndGroup||d!==n))throw new Error("invalid end group tag")},readField:S0,writeMessage(a,e,n){const s=a.getType();for(const o of s.fields.byNumber()){if(!yb(o,a)){if(o.req)throw new Error("cannot encode field ".concat(s.typeName,".").concat(o.name," to binary: required field not set"));continue}const l=o.oneof?a[o.oneof.localName].value:a[o.localName];k0(o,l,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(a,e),e},writeField(a,e,n,s){e!==void 0&&k0(a,e,n,s)}}}function S0(a,e,n,s,o){let{repeated:l,localName:u}=n;switch(n.oneof&&(a=a[n.oneof.localName],a.case!=u&&delete a.value,a.case=u,u="value"),n.kind){case"scalar":case"enum":const d=n.kind=="enum"?$.INT32:n.T;let f=$l;if(n.kind=="scalar"&&n.L>0&&(f=Lw),l){let S=a[u];if(s==ht.LengthDelimited&&d!=$.STRING&&d!=$.BYTES){let x=e.uint32()+e.pos;for(;e.pos<x;)S.push(f(e,d))}else S.push(f(e,d))}else a[u]=f(e,d);break;case"message":const m=n.T;l?a[u].push(zl(e,new m,o,n)):pi(a[u])?zl(e,a[u],o,n):(a[u]=zl(e,new m,o,n),m.fieldWrapper&&!n.oneof&&!n.repeated&&(a[u]=m.fieldWrapper.unwrapField(a[u])));break;case"map":let[g,v]=Pw(n,e,o);a[u][g]=v;break}}function zl(a,e,n,s){const o=e.getType().runtime.bin,l=s==null?void 0:s.delimited;return o.readMessage(e,a,l?s.no:a.uint32(),n,l),e}function Pw(a,e,n){const s=e.uint32(),o=e.pos+s;let l,u;for(;e.pos<o;){const[d]=e.tag();switch(d){case 1:l=$l(e,a.K);break;case 2:switch(a.V.kind){case"scalar":u=$l(e,a.V.T);break;case"enum":u=e.int32();break;case"message":u=zl(e,new a.V.T,n,void 0);break}break}}if(l===void 0&&(l=Ls(a.K,ra.BIGINT)),typeof l!="string"&&typeof l!="number"&&(l=l.toString()),u===void 0)switch(a.V.kind){case"scalar":u=Ls(a.V.T,ra.BIGINT);break;case"enum":u=a.V.T.values[0].no;break;case"message":u=new a.V.T;break}return[l,u]}function Lw(a,e){const n=$l(a,e);return typeof n=="bigint"?n.toString():n}function $l(a,e){switch(e){case $.STRING:return a.string();case $.BOOL:return a.bool();case $.DOUBLE:return a.double();case $.FLOAT:return a.float();case $.INT32:return a.int32();case $.INT64:return a.int64();case $.UINT64:return a.uint64();case $.FIXED64:return a.fixed64();case $.BYTES:return a.bytes();case $.FIXED32:return a.fixed32();case $.SFIXED32:return a.sfixed32();case $.SFIXED64:return a.sfixed64();case $.SINT64:return a.sint64();case $.UINT32:return a.uint32();case $.SINT32:return a.sint32()}}function k0(a,e,n,s){lt(e!==void 0);const o=a.repeated;switch(a.kind){case"scalar":case"enum":let l=a.kind=="enum"?$.INT32:a.T;if(o)if(lt(Array.isArray(e)),a.packed)jw(n,l,a.no,e);else for(const u of e)Kr(n,l,a.no,u);else Kr(n,l,a.no,e);break;case"message":if(o){lt(Array.isArray(e));for(const u of e)T0(n,s,a,u)}else T0(n,s,a,e);break;case"map":lt(typeof e=="object"&&e!=null);for(const[u,d]of Object.entries(e))Iw(n,s,a,u,d);break}}function Iw(a,e,n,s,o){a.tag(n.no,ht.LengthDelimited),a.fork();let l=s;switch(n.K){case $.INT32:case $.FIXED32:case $.UINT32:case $.SFIXED32:case $.SINT32:l=Number.parseInt(s);break;case $.BOOL:lt(s=="true"||s=="false"),l=s=="true";break}switch(Kr(a,n.K,1,l),n.V.kind){case"scalar":Kr(a,n.V.T,2,o);break;case"enum":Kr(a,$.INT32,2,o);break;case"message":lt(o!==void 0),a.tag(2,ht.LengthDelimited).bytes(o.toBinary(e));break}a.join()}function T0(a,e,n,s){const o=bb(n.T,s);n.delimited?a.tag(n.no,ht.StartGroup).raw(o.toBinary(e)).tag(n.no,ht.EndGroup):a.tag(n.no,ht.LengthDelimited).bytes(o.toBinary(e))}function Kr(a,e,n,s){lt(s!==void 0);let[o,l]=Sb(e);a.tag(n,o)[l](s)}function jw(a,e,n,s){if(!s.length)return;a.tag(n,ht.LengthDelimited).fork();let[,o]=Sb(e);for(let l=0;l<s.length;l++)a[o](s[l]);a.join()}function Sb(a){let e=ht.Varint;switch(a){case $.BYTES:case $.STRING:e=ht.LengthDelimited;break;case $.DOUBLE:case $.FIXED64:case $.SFIXED64:e=ht.Bit64;break;case $.FIXED32:case $.SFIXED32:case $.FLOAT:e=ht.Bit32;break}const n=$[a].toLowerCase();return[e,n]}function Uw(){return{setEnumType:lb,initPartial(a,e){if(a===void 0)return;const n=e.getType();for(const s of n.fields.byMember()){const o=s.localName,l=e,u=a;if(u[o]!=null)switch(s.kind){case"oneof":const d=u[o].case;if(d===void 0)continue;const f=s.findField(d);let m=u[o].value;f&&f.kind=="message"&&!pi(m,f.T)?m=new f.T(m):f&&f.kind==="scalar"&&f.T===$.BYTES&&(m=jr(m)),l[o]={case:d,value:m};break;case"scalar":case"enum":let g=u[o];s.T===$.BYTES&&(g=s.repeated?g.map(jr):jr(g)),l[o]=g;break;case"map":switch(s.V.kind){case"scalar":case"enum":if(s.V.T===$.BYTES)for(const[T,x]of Object.entries(u[o]))l[o][T]=jr(x);else Object.assign(l[o],u[o]);break;case"message":const S=s.V.T;for(const T of Object.keys(u[o])){let x=u[o][T];S.fieldWrapper||(x=new S(x)),l[o][T]=x}break}break;case"message":const v=s.T;if(s.repeated)l[o]=u[o].map(S=>pi(S,v)?S:new v(S));else{const S=u[o];v.fieldWrapper?v.typeName==="google.protobuf.BytesValue"?l[o]=jr(S):l[o]=S:l[o]=pi(S,v)?S:new v(S)}break}}},equals(a,e,n){return e===n?!0:!e||!n?!1:a.fields.byMember().every(s=>{const o=e[s.localName],l=n[s.localName];if(s.repeated){if(o.length!==l.length)return!1;switch(s.kind){case"message":return o.every((u,d)=>s.T.equals(u,l[d]));case"scalar":return o.every((u,d)=>Zi(s.T,u,l[d]));case"enum":return o.every((u,d)=>Zi($.INT32,u,l[d]))}throw new Error("repeated cannot contain ".concat(s.kind))}switch(s.kind){case"message":let u=o,d=l;return s.T.fieldWrapper&&(u!==void 0&&!pi(u)&&(u=s.T.fieldWrapper.wrapField(u)),d!==void 0&&!pi(d)&&(d=s.T.fieldWrapper.wrapField(d))),s.T.equals(u,d);case"enum":return Zi($.INT32,o,l);case"scalar":return Zi(s.T,o,l);case"oneof":if(o.case!==l.case)return!1;const f=s.findField(o.case);if(f===void 0)return!0;switch(f.kind){case"message":return f.T.equals(o.value,l.value);case"enum":return Zi($.INT32,o.value,l.value);case"scalar":return Zi(f.T,o.value,l.value)}throw new Error("oneof cannot contain ".concat(f.kind));case"map":const m=Object.keys(o).concat(Object.keys(l));switch(s.V.kind){case"message":const g=s.V.T;return m.every(S=>g.equals(o[S],l[S]));case"enum":return m.every(S=>Zi($.INT32,o[S],l[S]));case"scalar":const v=s.V.T;return m.every(S=>Zi(v,o[S],l[S]))}break}})},clone(a){const e=a.getType(),n=new e,s=n;for(const o of e.fields.byMember()){const l=a[o.localName];let u;if(o.repeated)u=l.map(Nl);else if(o.kind=="map"){u=s[o.localName];for(const[d,f]of Object.entries(l))u[d]=Nl(f)}else o.kind=="oneof"?u=o.findField(l.case)?{case:l.case,value:Nl(l.value)}:{case:void 0}:u=Nl(l);s[o.localName]=u}for(const o of e.runtime.bin.listUnknownFields(a))e.runtime.bin.onUnknownField(s,o.no,o.wireType,o.data);return n}}}function Nl(a){if(a===void 0)return a;if(pi(a))return a.clone();if(a instanceof Uint8Array){const e=new Uint8Array(a.byteLength);return e.set(a),e}return a}function jr(a){return a instanceof Uint8Array?a:new Uint8Array(a)}function Bw(a,e,n){return{syntax:a,json:Rw(),bin:Dw(),util:Object.assign(Object.assign({},Uw()),{newFieldList:e,initFields:n}),makeMessageType(s,o,l){return fw(this,s,o,l)},makeEnum:hw,makeEnumType:cb,getEnumType:dw,makeExtension(s,o,l){return kw(this,s,o,l)}}}class zw{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const s of this.list())n[s.jsonName]=n[s.name]=s;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const s of this.list())n[s.no]=s;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const s of this.list())s.oneof?s.oneof!==n&&(n=s.oneof,e.push(n)):e.push(s)}return this.members}}function kb(a,e){const n=Tb(a);return e?n:Yw(Gw(n))}function qw(a){return kb(a,!1)}const Fw=Tb;function Tb(a){let e=!1;const n=[];for(let s=0;s<a.length;s++){let o=a.charAt(s);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),n.push(o);break}}return n.join("")}const Vw=new Set(["constructor","toString","toJSON","valueOf"]),Hw=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Cb=a=>"".concat(a,"$"),Gw=a=>Hw.has(a)?Cb(a):a,Yw=a=>Vw.has(a)?Cb(a):a;class Kw{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=qw(e)}addField(e){lt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function Qw(a,e){var n,s,o,l,u,d;const f=[];let m;for(const g of typeof a=="function"?a():a){const v=g;if(v.localName=kb(g.name,g.oneof!==void 0),v.jsonName=(n=g.jsonName)!==null&&n!==void 0?n:Fw(g.name),v.repeated=(s=g.repeated)!==null&&s!==void 0?s:!1,g.kind=="scalar"&&(v.L=(o=g.L)!==null&&o!==void 0?o:ra.BIGINT),v.delimited=(l=g.delimited)!==null&&l!==void 0?l:!1,v.req=(u=g.req)!==null&&u!==void 0?u:!1,v.opt=(d=g.opt)!==null&&d!==void 0?d:!1,g.packed===void 0&&(v.packed=g.kind=="enum"||g.kind=="scalar"&&g.T!=$.BYTES&&g.T!=$.STRING),g.oneof!==void 0){const S=typeof g.oneof=="string"?g.oneof:g.oneof.name;(!m||m.name!=S)&&(m=new Kw(S)),v.oneof=m,m.addField(v)}f.push(v)}return f}const j=Bw("proto3",a=>new zw(a,e=>Qw(e)),a=>{for(const e of a.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,s=a;if(e.repeated){s[n]=[];continue}switch(e.kind){case"oneof":s[n]={case:void 0};break;case"enum":s[n]=0;break;case"map":s[n]={};break;case"scalar":s[n]=Ls(e.T,e.L);break}}});class Qt extends rf{constructor(e){super(),this.seconds=it.zero,this.nanos=0,j.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(j.json.debug(e)));const s=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!s)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(s[1]+"-"+s[2]+"-"+s[3]+"T"+s[4]+":"+s[5]+":"+s[6]+(s[8]?s[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=it.parse(o/1e3),this.nanos=0,s[7]&&(this.nanos=parseInt("1"+s[7]+"0".repeat(9-s[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let s="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?s="."+o.substring(0,3)+"Z":o.substring(6)==="000"?s="."+o.substring(0,6)+"Z":s="."+o+"Z"}return new Date(n).toISOString().replace(".000Z",s)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Qt.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new Qt({seconds:it.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new Qt().fromBinary(e,n)}static fromJson(e,n){return new Qt().fromJson(e,n)}static fromJsonString(e,n){return new Qt().fromJsonString(e,n)}static equals(e,n){return j.util.equals(Qt,e,n)}}Qt.runtime=j;Qt.typeName="google.protobuf.Timestamp";Qt.fields=j.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const Jw=j.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Qt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:Xw,repeated:!0},{no:5,name:"events",kind:"message",T:Zw,repeated:!0}]),Xw=j.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:Ww,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),Ww=j.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Qt},{no:3,name:"value",kind:"scalar",T:2}]),Zw=j.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Qt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Qt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),xb=j.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Rn=j.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),vt=j.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),lf=j.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Hr=j.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Wr=j.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Nn=j.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),Ma=j.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),$w=j.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Et=j.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),gc=j.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ec,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:jb}]),ec=j.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),e_=j.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:j.getEnumType(vt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Oa=j.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:j.getEnumType(Rs)},{no:4,name:"tracks",kind:"message",T:Es,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:e_},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:j.getEnumType(Zr)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:j.getEnumType(Nn)},{no:18,name:"kind_details",kind:"enum",T:j.getEnumType(t_),repeated:!0}]),Rs=j.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Zr=j.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),t_=j.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),kt=j.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),n_=j.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ia,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:j.getEnumType(Eb)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Es=j.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:j.getEnumType(Rn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:j.getEnumType(vt)},{no:10,name:"layers",kind:"message",T:ia,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:n_,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:j.getEnumType(kt)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:jb},{no:19,name:"audio_features",kind:"enum",T:j.getEnumType(Et),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:j.getEnumType(xb)}]),ia=j.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:j.getEnumType(lf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),Eb=j.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Ut=j.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:j.getEnumType(Re)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:cf,oneof:"value"},{no:3,name:"speaker",kind:"message",T:i_,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Ab,oneof:"value"},{no:7,name:"transcription",kind:"message",T:a_,oneof:"value"},{no:8,name:"metrics",kind:"message",T:Jw,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:tc,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:uf,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:df,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:hf,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:nc,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:ic,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:ac,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:wb,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Re=j.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),wb=j.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:j.getEnumType(kt)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),_b=j.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:cf,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:tc,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:uf,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:df,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:hf,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:nc,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:ic,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:ac,oneof:"value"}]),i_=j.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Rb,repeated:!0}]),Rb=j.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),cf=j.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Ab=j.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),a_=j.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:s_,repeated:!0}]),s_=j.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),tc=j.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),uf=j.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),df=j.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),hf=j.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Mb,oneof:"value"}]),Mb=j.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Nb=j.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Ob=j.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:j.getEnumType(Db)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Db=j.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Pb=j.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:j.getEnumType(Lb)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),Lb=j.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Ib=j.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:C0},{no:2,name:"screen",kind:"message",T:C0},{no:3,name:"resume_connection",kind:"enum",T:j.getEnumType(Wr)},{no:4,name:"disabled_codecs",kind:"message",T:r_},{no:5,name:"force_relay",kind:"enum",T:j.getEnumType(Wr)}]),C0=j.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:j.getEnumType(Wr)}]),r_=j.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:ec,repeated:!0},{no:2,name:"publish",kind:"message",T:ec,repeated:!0}]),jb=j.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),xh=j.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),Ub=j.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:j.getEnumType(xh)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),Bb=j.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),nc=j.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:j.getEnumType(kt)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:Ub,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:Bb,oneof:"content_header"}],{localName:"DataStream_Header"}),ic=j.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),ac=j.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),o_=j.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),An=j.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Eh=j.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),l_=j.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),c_=j.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:oa,oneof:"message"},{no:2,name:"answer",kind:"message",T:oa,oneof:"message"},{no:3,name:"trickle",kind:"message",T:vc,oneof:"message"},{no:4,name:"add_track",kind:"message",T:$r,oneof:"message"},{no:5,name:"mute",kind:"message",T:yc,oneof:"message"},{no:6,name:"subscription",kind:"message",T:bc,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:zb,oneof:"message"},{no:8,name:"leave",kind:"message",T:Sc,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Fb,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Gb,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:vf,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Bn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:pf,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Qb,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:mf,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:qb,oneof:"message"}]),x0=j.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:u_,oneof:"message"},{no:2,name:"answer",kind:"message",T:oa,oneof:"message"},{no:3,name:"offer",kind:"message",T:oa,oneof:"message"},{no:4,name:"trickle",kind:"message",T:vc,oneof:"message"},{no:5,name:"update",kind:"message",T:f_,oneof:"message"},{no:6,name:"track_published",kind:"message",T:ff,oneof:"message"},{no:8,name:"leave",kind:"message",T:Sc,oneof:"message"},{no:9,name:"mute",kind:"message",T:yc,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:m_,oneof:"message"},{no:11,name:"room_update",kind:"message",T:p_,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:v_,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:b_,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:k_,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:C_,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:h_,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:d_,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:E_,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:R_,oneof:"message"},{no:22,name:"request_response",kind:"message",T:A_,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:M_,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:x_,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:P_,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:T_,oneof:"message"}]),wh=j.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ia,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:j.getEnumType(Eb)}]),$r=j.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:j.getEnumType(Rn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:j.getEnumType(vt)},{no:9,name:"layers",kind:"message",T:ia,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:wh,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:j.getEnumType(kt)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:j.getEnumType(xb)},{no:17,name:"audio_features",kind:"enum",T:j.getEnumType(Et),repeated:!0}]),vc=j.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:j.getEnumType(An)},{no:3,name:"final",kind:"scalar",T:8}]),yc=j.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),u_=j.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:gc},{no:2,name:"participant",kind:"message",T:Oa},{no:3,name:"other_participants",kind:"message",T:Oa,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Vb,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Ib},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Ob},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:ec,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),d_=j.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:Vb,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Ib},{no:3,name:"server_info",kind:"message",T:Ob},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),ff=j.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Es}]),h_=j.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),oa=j.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),f_=j.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Oa,repeated:!0}]),bc=j.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Nb,repeated:!0}]),zb=j.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:j.getEnumType(lf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),mf=j.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:j.getEnumType(Et),repeated:!0}]),qb=j.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Sc=j.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:j.getEnumType(Nn)},{no:3,name:"action",kind:"enum",T:j.getEnumType(As)},{no:4,name:"regions",kind:"message",T:w_}]),As=j.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),Fb=j.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ia,repeated:!0}]),pf=j.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),Vb=j.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),m_=j.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Rb,repeated:!0}]),p_=j.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:gc}]),g_=j.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:j.getEnumType(Hr)},{no:3,name:"score",kind:"scalar",T:2}]),v_=j.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:g_,repeated:!0}]),y_=j.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:j.getEnumType(Eh)}]),b_=j.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:y_,repeated:!0}]),gf=j.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:j.getEnumType(lf)},{no:2,name:"enabled",kind:"scalar",T:8}]),S_=j.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:gf,repeated:!0}]),k_=j.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:gf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:S_,repeated:!0}]),T_=j.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:o_,repeated:!0}]),Hb=j.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Gb=j.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Hb,repeated:!0}]),C_=j.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),x_=j.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:gc},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Oa},{no:4,name:"other_participants",kind:"message",T:Oa,repeated:!0}]),vf=j.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:oa},{no:2,name:"subscription",kind:"message",T:bc},{no:3,name:"publish_tracks",kind:"message",T:ff,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Kb,repeated:!0},{no:5,name:"offer",kind:"message",T:oa},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Yb,repeated:!0}]),Yb=j.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),Kb=j.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:j.getEnumType(An)}]),Bn=j.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:j.getEnumType(l_),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Qb=j.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),E_=j.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),w_=j.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:__,repeated:!0}]),__=j.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),R_=j.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:j.getEnumType($w)}]),A_=j.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:j.getEnumType(yf)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:vc,oneof:"request"},{no:5,name:"add_track",kind:"message",T:$r,oneof:"request"},{no:6,name:"mute",kind:"message",T:yc,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:pf,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:mf,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:qb,oneof:"request"}]),yf=j.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),M_=j.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Jb=j.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),N_=j.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Pb},{no:2,name:"connection_settings",kind:"message",T:Jb},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:$r,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:oa},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:j.getEnumType(Ma)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:vf}]),O_=j.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:j.getEnumType(D_)},{no:2,name:"join_request",kind:"scalar",T:12}]),D_=j.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),P_=j.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function L_(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ql={exports:{}},I_=ql.exports,E0;function j_(){return E0||(E0=1,(function(a){(function(e,n){a.exports?a.exports=n():e.log=n()})(I_,function(){var e=function(){},n="undefined",s=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],l={},u=null;function d(E,D){var M=E[D];if(typeof M.bind=="function")return M.bind(E);try{return Function.prototype.bind.call(M,E)}catch{return function(){return Function.prototype.apply.apply(M,[E,arguments])}}}function f(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function m(E){return E==="debug"&&(E="log"),typeof console===n?!1:E==="trace"&&s?f:console[E]!==void 0?d(console,E):console.log!==void 0?d(console,"log"):e}function g(){for(var E=this.getLevel(),D=0;D<o.length;D++){var M=o[D];this[M]=D<E?e:this.methodFactory(M,E,this.name)}if(this.log=this.debug,typeof console===n&&E<this.levels.SILENT)return"No console available for logging"}function v(E){return function(){typeof console!==n&&(g.call(this),this[E].apply(this,arguments))}}function S(E,D,M){return m(E)||v.apply(this,arguments)}function T(E,D){var M=this,Y,P,A,N="loglevel";typeof E=="string"?N+=":"+E:typeof E=="symbol"&&(N=void 0);function V(se){var fe=(o[se]||"silent").toUpperCase();if(!(typeof window===n||!N)){try{window.localStorage[N]=fe;return}catch{}try{window.document.cookie=encodeURIComponent(N)+"="+fe+";"}catch{}}}function X(){var se;if(!(typeof window===n||!N)){try{se=window.localStorage[N]}catch{}if(typeof se===n)try{var fe=window.document.cookie,qe=encodeURIComponent(N),$e=fe.indexOf(qe+"=");$e!==-1&&(se=/^([^;]+)/.exec(fe.slice($e+qe.length+1))[1])}catch{}return M.levels[se]===void 0&&(se=void 0),se}}function z(){if(!(typeof window===n||!N)){try{window.localStorage.removeItem(N)}catch{}try{window.document.cookie=encodeURIComponent(N)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function J(se){var fe=se;if(typeof fe=="string"&&M.levels[fe.toUpperCase()]!==void 0&&(fe=M.levels[fe.toUpperCase()]),typeof fe=="number"&&fe>=0&&fe<=M.levels.SILENT)return fe;throw new TypeError("log.setLevel() called with invalid level: "+se)}M.name=E,M.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},M.methodFactory=D||S,M.getLevel=function(){return A??P??Y},M.setLevel=function(se,fe){return A=J(se),fe!==!1&&V(A),g.call(M)},M.setDefaultLevel=function(se){P=J(se),X()||M.setLevel(se,!1)},M.resetLevel=function(){A=null,z(),g.call(M)},M.enableAll=function(se){M.setLevel(M.levels.TRACE,se)},M.disableAll=function(se){M.setLevel(M.levels.SILENT,se)},M.rebuild=function(){if(u!==M&&(Y=J(u.getLevel())),g.call(M),u===M)for(var se in l)l[se].rebuild()},Y=J(u?u.getLevel():"WARN");var H=X();H!=null&&(A=J(H)),g.call(M)}u=new T,u.getLogger=function(D){if(typeof D!="symbol"&&typeof D!="string"||D==="")throw new TypeError("You must supply a name when creating a logger.");var M=l[D];return M||(M=l[D]=new T(D,u.methodFactory)),M};var x=typeof window!==n?window.log:void 0;return u.noConflict=function(){return typeof window!==n&&window.log===u&&(window.log=x),u},u.getLoggers=function(){return l},u.default=u,u})})(ql)),ql.exports}var kc=j_(),_h;(function(a){a[a.trace=0]="trace",a[a.debug=1]="debug",a[a.info=2]="info",a[a.warn=3]="warn",a[a.error=4]="error",a[a.silent=5]="silent"})(_h||(_h={}));var Dn;(function(a){a.Default="livekit",a.Room="livekit-room",a.TokenSource="livekit-token-source",a.Participant="livekit-participant",a.Track="livekit-track",a.Publication="livekit-track-publication",a.Engine="livekit-engine",a.Signal="livekit-signal",a.PCManager="livekit-pc-manager",a.PCTransport="livekit-pc-transport",a.E2EE="lk-e2ee"})(Dn||(Dn={}));let Ce=kc.getLogger("livekit");Object.values(Dn).map(a=>kc.getLogger(a));Ce.setDefaultLevel(_h.info);function ki(a){const e=kc.getLogger(a);return e.setDefaultLevel(Ce.getLevel()),e}const U_=kc.getLogger("lk-e2ee"),Ur=7e3,B_=[0,300,4*300,9*300,16*300,Ur,Ur,Ur,Ur,Ur];class z_{constructor(e){this._retryDelays=e!==void 0?[...e]:B_}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function q_(a,e){var n={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(n[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(a);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(a,s[o])&&(n[s[o]]=a[s[o]]);return n}function C(a,e,n,s){function o(l){return l instanceof n?l:new n(function(u){u(l)})}return new(n||(n=Promise))(function(l,u){function d(g){try{m(s.next(g))}catch(v){u(v)}}function f(g){try{m(s.throw(g))}catch(v){u(v)}}function m(g){g.done?l(g.value):o(g.value).then(d,f)}m((s=s.apply(a,e||[])).next())})}function w0(a){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&a[e],s=0;if(n)return n.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&s>=a.length&&(a=void 0),{value:a&&a[s++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function gi(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],n;return e?e.call(a):(a=typeof w0=="function"?w0(a):a[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(l){n[l]=a[l]&&function(u){return new Promise(function(d,f){u=a[l](u),o(d,f,u.done,u.value)})}}function o(l,u,d,f){Promise.resolve(f).then(function(m){l({value:m,done:d})},u)}}var Ol={exports:{}},_0;function F_(){if(_0)return Ol.exports;_0=1;var a=typeof Reflect=="object"?Reflect:null,e=a&&typeof a.apply=="function"?a.apply:function(N,V,X){return Function.prototype.apply.call(N,V,X)},n;a&&typeof a.ownKeys=="function"?n=a.ownKeys:Object.getOwnPropertySymbols?n=function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:n=function(N){return Object.getOwnPropertyNames(N)};function s(A){console&&console.warn&&console.warn(A)}var o=Number.isNaN||function(N){return N!==N};function l(){l.init.call(this)}Ol.exports=l,Ol.exports.once=M,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var u=10;function d(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(A){if(typeof A!="number"||A<0||o(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");u=A}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(N){if(typeof N!="number"||N<0||o(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this};function f(A){return A._maxListeners===void 0?l.defaultMaxListeners:A._maxListeners}l.prototype.getMaxListeners=function(){return f(this)},l.prototype.emit=function(N){for(var V=[],X=1;X<arguments.length;X++)V.push(arguments[X]);var z=N==="error",J=this._events;if(J!==void 0)z=z&&J.error===void 0;else if(!z)return!1;if(z){var H;if(V.length>0&&(H=V[0]),H instanceof Error)throw H;var se=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw se.context=H,se}var fe=J[N];if(fe===void 0)return!1;if(typeof fe=="function")e(fe,this,V);else for(var qe=fe.length,$e=x(fe,qe),X=0;X<qe;++X)e($e[X],this,V);return!0};function m(A,N,V,X){var z,J,H;if(d(V),J=A._events,J===void 0?(J=A._events=Object.create(null),A._eventsCount=0):(J.newListener!==void 0&&(A.emit("newListener",N,V.listener?V.listener:V),J=A._events),H=J[N]),H===void 0)H=J[N]=V,++A._eventsCount;else if(typeof H=="function"?H=J[N]=X?[V,H]:[H,V]:X?H.unshift(V):H.push(V),z=f(A),z>0&&H.length>z&&!H.warned){H.warned=!0;var se=new Error("Possible EventEmitter memory leak detected. "+H.length+" "+String(N)+" listeners added. Use emitter.setMaxListeners() to increase limit");se.name="MaxListenersExceededWarning",se.emitter=A,se.type=N,se.count=H.length,s(se)}return A}l.prototype.addListener=function(N,V){return m(this,N,V,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(N,V){return m(this,N,V,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(A,N,V){var X={fired:!1,wrapFn:void 0,target:A,type:N,listener:V},z=g.bind(X);return z.listener=V,X.wrapFn=z,z}l.prototype.once=function(N,V){return d(V),this.on(N,v(this,N,V)),this},l.prototype.prependOnceListener=function(N,V){return d(V),this.prependListener(N,v(this,N,V)),this},l.prototype.removeListener=function(N,V){var X,z,J,H,se;if(d(V),z=this._events,z===void 0)return this;if(X=z[N],X===void 0)return this;if(X===V||X.listener===V)--this._eventsCount===0?this._events=Object.create(null):(delete z[N],z.removeListener&&this.emit("removeListener",N,X.listener||V));else if(typeof X!="function"){for(J=-1,H=X.length-1;H>=0;H--)if(X[H]===V||X[H].listener===V){se=X[H].listener,J=H;break}if(J<0)return this;J===0?X.shift():E(X,J),X.length===1&&(z[N]=X[0]),z.removeListener!==void 0&&this.emit("removeListener",N,se||V)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(N){var V,X,z;if(X=this._events,X===void 0)return this;if(X.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):X[N]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete X[N]),this;if(arguments.length===0){var J=Object.keys(X),H;for(z=0;z<J.length;++z)H=J[z],H!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(V=X[N],typeof V=="function")this.removeListener(N,V);else if(V!==void 0)for(z=V.length-1;z>=0;z--)this.removeListener(N,V[z]);return this};function S(A,N,V){var X=A._events;if(X===void 0)return[];var z=X[N];return z===void 0?[]:typeof z=="function"?V?[z.listener||z]:[z]:V?D(z):x(z,z.length)}l.prototype.listeners=function(N){return S(this,N,!0)},l.prototype.rawListeners=function(N){return S(this,N,!1)},l.listenerCount=function(A,N){return typeof A.listenerCount=="function"?A.listenerCount(N):T.call(A,N)},l.prototype.listenerCount=T;function T(A){var N=this._events;if(N!==void 0){var V=N[A];if(typeof V=="function")return 1;if(V!==void 0)return V.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function x(A,N){for(var V=new Array(N),X=0;X<N;++X)V[X]=A[X];return V}function E(A,N){for(;N+1<A.length;N++)A[N]=A[N+1];A.pop()}function D(A){for(var N=new Array(A.length),V=0;V<N.length;++V)N[V]=A[V].listener||A[V];return N}function M(A,N){return new Promise(function(V,X){function z(H){A.removeListener(N,J),X(H)}function J(){typeof A.removeListener=="function"&&A.removeListener("error",z),V([].slice.call(arguments))}P(A,N,J,{once:!0}),N!=="error"&&Y(A,z,{once:!0})})}function Y(A,N,V){typeof A.on=="function"&&P(A,"error",N,V)}function P(A,N,V,X){if(typeof A.on=="function")X.once?A.once(N,V):A.on(N,V);else if(typeof A.addEventListener=="function")A.addEventListener(N,function z(J){X.once&&A.removeEventListener(N,z),V(J)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}return Ol.exports}var Gn=F_();let Xb=!0,Wb=!0;function Gr(a,e,n){const s=a.match(e);return s&&s.length>=n&&parseFloat(s[n],10)}function Ia(a,e,n){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,o=s.addEventListener;s.addEventListener=function(u,d){if(u!==e)return o.apply(this,arguments);const f=m=>{const g=n(m);g&&(d.handleEvent?d.handleEvent(g):d(g))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,f),o.apply(this,[u,f])};const l=s.removeEventListener;s.removeEventListener=function(u,d){if(u!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(d))return l.apply(this,arguments);const f=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[u,f])},Object.defineProperty(s,"on"+e,{get(){return this["_on"+e]},set(u){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),u&&this.addEventListener(e,this["_on"+e]=u)},enumerable:!0,configurable:!0})}function V_(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(Xb=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function H_(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(Wb=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function Zb(){if(typeof window=="object"){if(Xb)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function bf(a,e){Wb&&console.warn(a+" is deprecated, please use "+e+" instead.")}function G_(a){const e={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=a;if(n.userAgentData&&n.userAgentData.brands){const s=n.userAgentData.brands.find(o=>o.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Gr(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Gr(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(a.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Gr(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype,e._safariVersion=Gr(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function R0(a){return Object.prototype.toString.call(a)==="[object Object]"}function $b(a){return R0(a)?Object.keys(a).reduce(function(e,n){const s=R0(a[n]),o=s?$b(a[n]):a[n],l=s&&!Object.keys(o).length;return o===void 0||l?e:Object.assign(e,{[n]:o})},{}):a}function Rh(a,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(s=>{s.endsWith("Id")?Rh(a,a.get(e[s]),n):s.endsWith("Ids")&&e[s].forEach(o=>{Rh(a,a.get(o),n)})}))}function A0(a,e,n){const s=n?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const l=[];return a.forEach(u=>{u.type==="track"&&u.trackIdentifier===e.id&&l.push(u)}),l.forEach(u=>{a.forEach(d=>{d.type===s&&d.trackId===u.id&&Rh(a,d,o)})}),o}const M0=Zb;function eS(a,e){const n=a&&a.navigator;if(!n.mediaDevices)return;const s=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const f={};return Object.keys(d).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const g=typeof d[m]=="object"?d[m]:{ideal:d[m]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const v=function(S,T){return S?S+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(g.ideal!==void 0){f.optional=f.optional||[];let S={};typeof g.ideal=="number"?(S[v("min",m)]=g.ideal,f.optional.push(S),S={},S[v("max",m)]=g.ideal,f.optional.push(S)):(S[v("",m)]=g.ideal,f.optional.push(S))}g.exact!==void 0&&typeof g.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[v("",m)]=g.exact):["min","max"].forEach(S=>{g[S]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[v(S,m)]=g[S])})}),d.advanced&&(f.optional=(f.optional||[]).concat(d.advanced)),f},o=function(d,f){if(e.version>=61)return f(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const m=function(g,v,S){v in g&&!(S in g)&&(g[S]=g[v],delete g[v])};d=JSON.parse(JSON.stringify(d)),m(d.audio,"autoGainControl","googAutoGainControl"),m(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=s(d.audio)}if(d&&typeof d.video=="object"){let m=d.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const g=e.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete d.video.facingMode;let v;if(m.exact==="environment"||m.ideal==="environment"?v=["back","rear"]:(m.exact==="user"||m.ideal==="user")&&(v=["front"]),v)return n.mediaDevices.enumerateDevices().then(S=>{S=S.filter(x=>x.kind==="videoinput");let T=S.find(x=>v.some(E=>x.label.toLowerCase().includes(E)));return!T&&S.length&&v.includes("back")&&(T=S[S.length-1]),T&&(d.video.deviceId=m.exact?{exact:T.deviceId}:{ideal:T.deviceId}),d.video=s(d.video),M0("chrome: "+JSON.stringify(d)),f(d)})}d.video=s(d.video)}return M0("chrome: "+JSON.stringify(d)),f(d)},l=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},u=function(d,f,m){o(d,g=>{n.webkitGetUserMedia(g,f,v=>{m&&m(l(v))})})};if(n.getUserMedia=u.bind(n),n.mediaDevices.getUserMedia){const d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(f){return o(f,m=>d(m).then(g=>{if(m.audio&&!g.getAudioTracks().length||m.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(l(g))))}}}function tS(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function nS(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===o.track.id):l={track:o.track};const u=new Event("track");u.track=o.track,u.receiver=l,u.transceiver={receiver:l},u.streams=[s.stream],this.dispatchEvent(u)}),s.stream.getTracks().forEach(o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===o.id):l={track:o};const u=new Event("track");u.track=o,u.receiver=l,u.transceiver={receiver:l},u.streams=[s.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Ia(a,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function iS(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const e=function(o,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=o.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:o}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(d,f){let m=o.apply(this,arguments);return m||(m=e(this,d),this._senders.push(m)),m};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(d){l.apply(this,arguments);const f=this._senders.indexOf(d);f!==-1&&this._senders.splice(f,1)}}const n=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],n.apply(this,[l]),l.getTracks().forEach(u=>{this._senders.push(e(this,u))})};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],s.apply(this,[l]),l.getTracks().forEach(u=>{const d=this._senders.find(f=>f.track===u);d&&this._senders.splice(this._senders.indexOf(d),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const e=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function aS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const n=a.RTCPeerConnection.prototype.getSenders;n&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=n.apply(this,[]);return l.forEach(u=>u._pc=this),l});const s=a.RTCPeerConnection.prototype.addTrack;s&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(u=>A0(u,l.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const n=a.RTCPeerConnection.prototype.getReceivers;n&&(a.RTCPeerConnection.prototype.getReceivers=function(){const o=n.apply(this,[]);return o.forEach(l=>l._pc=this),o}),Ia(a,"track",s=>(s.receiver._pc=s.srcElement,s)),a.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(l=>A0(l,o.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const s=arguments[0];let o,l,u;return this.getSenders().forEach(d=>{d.track===s&&(o?u=!0:o=d)}),this.getReceivers().forEach(d=>(d.track===s&&(l?u=!0:l=d),d.track===s)),u||o&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function sS(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(u,d){if(!d)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=e.apply(this,arguments);return this._shimmedLocalStreams[d.id]?this._shimmedLocalStreams[d.id].indexOf(f)===-1&&this._shimmedLocalStreams[d.id].push(f):this._shimmedLocalStreams[d.id]=[d,f],f};const n=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(m=>{if(this.getSenders().find(v=>v.track===m))throw new DOMException("Track already exists.","InvalidAccessError")});const d=this.getSenders();n.apply(this,arguments);const f=this.getSenders().filter(m=>d.indexOf(m)===-1);this._shimmedLocalStreams[u.id]=[u].concat(f)};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],s.apply(this,arguments)};const o=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(d=>{const f=this._shimmedLocalStreams[d].indexOf(u);f!==-1&&this._shimmedLocalStreams[d].splice(f,1),this._shimmedLocalStreams[d].length===1&&delete this._shimmedLocalStreams[d]}),o.apply(this,arguments)}}function rS(a,e){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&e.version>=65)return sS(a);const n=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const g=n.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(v=>this._reverseStreams[v.id])};const s=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(v=>{if(this.getSenders().find(T=>T.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const v=new a.MediaStream(g.getTracks());this._streams[g.id]=v,this._reverseStreams[v.id]=g,g=v}s.apply(this,[g])};const o=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},a.RTCPeerConnection.prototype.addTrack=function(g,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const S=[].slice.call(arguments,1);if(S.length!==1||!S[0].getTracks().find(E=>E===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(E=>E.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const x=this._streams[v.id];if(x)x.addTrack(g),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const E=new a.MediaStream([g]);this._streams[v.id]=E,this._reverseStreams[E.id]=v,this.addStream(E)}return this.getSenders().find(E=>E.track===g)};function l(m,g){let v=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(S=>{const T=m._reverseStreams[S],x=m._streams[T.id];v=v.replace(new RegExp(x.id,"g"),T.id)}),new RTCSessionDescription({type:g.type,sdp:v})}function u(m,g){let v=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(S=>{const T=m._reverseStreams[S],x=m._streams[T.id];v=v.replace(new RegExp(T.id,"g"),x.id)}),new RTCSessionDescription({type:g.type,sdp:v})}["createOffer","createAnswer"].forEach(function(m){const g=a.RTCPeerConnection.prototype[m],v={[m](){const S=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[x=>{const E=l(this,x);S[0].apply(null,[E])},x=>{S[1]&&S[1].apply(null,x)},arguments[2]]):g.apply(this,arguments).then(x=>l(this,x))}};a.RTCPeerConnection.prototype[m]=v[m]});const d=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=u(this,arguments[0]),d.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const m=f.get.apply(this);return m.type===""?m:l(this,m)}}),a.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(g._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let S;Object.keys(this._streams).forEach(T=>{this._streams[T].getTracks().find(E=>g.track===E)&&(S=this._streams[T])}),S&&(S.getTracks().length===1?this.removeStream(this._reverseStreams[S.id]):S.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Ah(a,e){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const s=a.RTCPeerConnection.prototype[n],o={[n](){return arguments[0]=new(n==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};a.RTCPeerConnection.prototype[n]=o[n]})}function oS(a,e){Ia(a,"negotiationneeded",n=>{const s=n.target;if(!((e.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return n})}var N0=Object.freeze({__proto__:null,fixNegotiationNeeded:oS,shimAddTrackRemoveTrack:rS,shimAddTrackRemoveTrackWithNative:sS,shimGetSendersWithDtmf:iS,shimGetUserMedia:eS,shimMediaStream:tS,shimOnTrack:nS,shimPeerConnection:Ah,shimSenderReceiverGetStats:aS});function lS(a,e){const n=a&&a.navigator,s=a&&a.MediaStreamTrack;if(n.getUserMedia=function(o,l,u){bf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(o).then(l,u)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const o=function(u,d,f){d in u&&!(f in u)&&(u[f]=u[d],delete u[d])},l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u.audio,"autoGainControl","mozAutoGainControl"),o(u.audio,"noiseSuppression","mozNoiseSuppression")),l(u)},s&&s.prototype.getSettings){const u=s.prototype.getSettings;s.prototype.getSettings=function(){const d=u.apply(this,arguments);return o(d,"mozAutoGainControl","autoGainControl"),o(d,"mozNoiseSuppression","noiseSuppression"),d}}if(s&&s.prototype.applyConstraints){const u=s.prototype.applyConstraints;s.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d,"autoGainControl","mozAutoGainControl"),o(d,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[d])}}}}function Y_(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return s.video===!0?s.video={mediaSource:e}:s.video.mediaSource=e,a.navigator.mediaDevices.getUserMedia(s)})}function cS(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mh(a,e){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const l=a.RTCPeerConnection.prototype[o],u={[o](){return arguments[0]=new(o==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};a.RTCPeerConnection.prototype[o]=u[o]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[l,u,d]=arguments;return s.apply(this,[l||null]).then(f=>{if(e.version<53&&!u)try{f.forEach(m=>{m.type=n[m.type]||m.type})}catch(m){if(m.name!=="TypeError")throw m;f.forEach((g,v)=>{f.set(v,Object.assign({},g,{type:n[g.type]||g.type}))})}return f}).then(u,d)}}function uS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const e=a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(l=>l._pc=this),o});const n=a.RTCPeerConnection.prototype.addTrack;n&&(a.RTCPeerConnection.prototype.addTrack=function(){const o=n.apply(this,arguments);return o._pc=this,o}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function dS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s}),Ia(a,"track",n=>(n.receiver._pc=n.srcElement,n)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function hS(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(n){bf("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&n.getTracks().includes(s.track)&&this.removeTrack(s)})})}function fS(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function mS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.addTransceiver;e&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const o=s.length>0;o&&s.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(o){const{sender:u}=l,d=u.getParameters();(!("encodings"in d)||d.encodings.length===1&&Object.keys(d.encodings[0]).length===0)&&(d.encodings=s,u.sendEncodings=s,this.setParametersPromises.push(u.setParameters(d).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return l})}function pS(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const e=a.RTCRtpSender.prototype.getParameters;e&&(a.RTCRtpSender.prototype.getParameters=function(){const s=e.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function gS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function vS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var O0=Object.freeze({__proto__:null,shimAddTransceiver:mS,shimCreateAnswer:vS,shimCreateOffer:gS,shimGetDisplayMedia:Y_,shimGetParameters:pS,shimGetUserMedia:lS,shimOnTrack:cS,shimPeerConnection:Mh,shimRTCDataChannel:fS,shimReceiverGetStats:dS,shimRemoveStream:hS,shimSenderGetStats:uS});function yS(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(o=>e.call(this,o,s)),s.getVideoTracks().forEach(o=>e.call(this,o,s))},a.RTCPeerConnection.prototype.addTrack=function(s){for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];return l&&l.forEach(d=>{this._localStreams?this._localStreams.includes(d)||this._localStreams.push(d):this._localStreams=[d]}),e.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(n);if(s===-1)return;this._localStreams.splice(s,1);const o=n.getTracks();this.getSenders().forEach(l=>{o.includes(l.track)&&this.removeTrack(l)})})}}function bS(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const l=new Event("addstream");l.stream=o,this.dispatchEvent(l)})})}});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(l=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(l)>=0)return;s._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,s.dispatchEvent(u)})}),e.apply(s,arguments)}}}function SS(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const e=a.RTCPeerConnection.prototype,n=e.createOffer,s=e.createAnswer,o=e.setLocalDescription,l=e.setRemoteDescription,u=e.addIceCandidate;e.createOffer=function(m,g){const v=arguments.length>=2?arguments[2]:arguments[0],S=n.apply(this,[v]);return g?(S.then(m,g),Promise.resolve()):S},e.createAnswer=function(m,g){const v=arguments.length>=2?arguments[2]:arguments[0],S=s.apply(this,[v]);return g?(S.then(m,g),Promise.resolve()):S};let d=function(f,m,g){const v=o.apply(this,[f]);return g?(v.then(m,g),Promise.resolve()):v};e.setLocalDescription=d,d=function(f,m,g){const v=l.apply(this,[f]);return g?(v.then(m,g),Promise.resolve()):v},e.setRemoteDescription=d,d=function(f,m,g){const v=u.apply(this,[f]);return g?(v.then(m,g),Promise.resolve()):v},e.addIceCandidate=d}function kS(a){const e=a&&a.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,s=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=o=>s(TS(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(s,o,l){e.mediaDevices.getUserMedia(s).then(o,l)}).bind(e))}function TS(a){return a&&a.video!==void 0?Object.assign({},a,{video:$b(a.video)}):a}function CS(a){if(!a.RTCPeerConnection)return;const e=a.RTCPeerConnection;a.RTCPeerConnection=function(s,o){if(s&&s.iceServers){const l=[];for(let u=0;u<s.iceServers.length;u++){let d=s.iceServers[u];d.urls===void 0&&d.url?(bf("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,l.push(d)):l.push(s.iceServers[u])}s.iceServers=l}return new e(s,o)},a.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function xS(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ES(a){const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const o=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):s.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const l=this.getTransceivers().find(u=>u.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function wS(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var D0=Object.freeze({__proto__:null,shimAudioContext:wS,shimCallbacksAPI:SS,shimConstraints:TS,shimCreateOfferLegacy:ES,shimGetUserMedia:kS,shimLocalStreamsAPI:yS,shimRTCIceServerUrls:CS,shimRemoteStreamsAPI:bS,shimTrackEventTransceiver:xS}),ah={exports:{}},P0;function K_(){return P0||(P0=1,(function(a){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(s=>s.trim())},e.splitSections=function(n){return n.split(`
m=`).map((o,l)=>(l>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(n){const s=e.splitSections(n);return s&&s[0]},e.getMediaSections=function(n){const s=e.splitSections(n);return s.shift(),s},e.matchPrefix=function(n,s){return e.splitLines(n).filter(o=>o.indexOf(s)===0)},e.parseCandidate=function(n){let s;n.indexOf("a=candidate:")===0?s=n.substring(12).split(" "):s=n.substring(10).split(" ");const o={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":o.relatedAddress=s[l+1];break;case"rport":o.relatedPort=parseInt(s[l+1],10);break;case"tcptype":o.tcpType=s[l+1];break;case"ufrag":o.ufrag=s[l+1],o.usernameFragment=s[l+1];break;default:o[s[l]]===void 0&&(o[s[l]]=s[l+1]);break}return o},e.writeCandidate=function(n){const s=[];s.push(n.foundation);const o=n.component;o==="rtp"?s.push(1):o==="rtcp"?s.push(2):s.push(o),s.push(n.protocol.toUpperCase()),s.push(n.priority),s.push(n.address||n.ip),s.push(n.port);const l=n.type;return s.push("typ"),s.push(l),l!=="host"&&n.relatedAddress&&n.relatedPort&&(s.push("raddr"),s.push(n.relatedAddress),s.push("rport"),s.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(s.push("ufrag"),s.push(n.usernameFragment||n.ufrag)),"candidate:"+s.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let s=n.substring(9).split(" ");const o={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),o.name=s[0],o.clockRate=parseInt(s[1],10),o.channels=s.length===3?parseInt(s[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(n){let s=n.payloadType;n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType);const o=n.channels||n.numChannels||1;return"a=rtpmap:"+s+" "+n.name+"/"+n.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(n){const s=n.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const s={};let o;const l=n.substring(n.indexOf(" ")+1).split(";");for(let u=0;u<l.length;u++)o=l[u].trim().split("="),s[o[0].trim()]=o[1];return s},e.writeFmtp=function(n){let s="",o=n.payloadType;if(n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const l=[];Object.keys(n.parameters).forEach(u=>{n.parameters[u]!==void 0?l.push(u+"="+n.parameters[u]):l.push(u)}),s+="a=fmtp:"+o+" "+l.join(";")+`\r
`}return s},e.parseRtcpFb=function(n){const s=n.substring(n.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},e.writeRtcpFb=function(n){let s="",o=n.payloadType;return n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+o+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},e.parseSsrcMedia=function(n){const s=n.indexOf(" "),o={ssrc:parseInt(n.substring(7,s),10)},l=n.indexOf(":",s);return l>-1?(o.attribute=n.substring(s+1,l),o.value=n.substring(l+1)):o.attribute=n.substring(s+1),o},e.parseSsrcGroup=function(n){const s=n.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(o=>parseInt(o,10))}},e.getMid=function(n){const s=e.matchPrefix(n,"a=mid:")[0];if(s)return s.substring(6)},e.parseFingerprint=function(n){const s=n.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},e.getDtlsParameters=function(n,s){return{role:"auto",fingerprints:e.matchPrefix(n+s,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,s){let o="a=setup:"+s+`\r
`;return n.fingerprints.forEach(l=>{o+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),o},e.parseCryptoLine=function(n){const s=n.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const s=n.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,s){return e.matchPrefix(n+s,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,s){const o=e.matchPrefix(n+s,"a=ice-ufrag:")[0],l=e.matchPrefix(n+s,"a=ice-pwd:")[0];return o&&l?{usernameFragment:o.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(n){let s="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(s+=`a=ice-lite\r
`),s},e.parseRtpParameters=function(n){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=e.splitLines(n)[0].split(" ");s.profile=l[2];for(let d=3;d<l.length;d++){const f=l[d],m=e.matchPrefix(n,"a=rtpmap:"+f+" ")[0];if(m){const g=e.parseRtpMap(m),v=e.matchPrefix(n,"a=fmtp:"+f+" ");switch(g.parameters=v.length?e.parseFmtp(v[0]):{},g.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(d=>{s.headerExtensions.push(e.parseExtmap(d))});const u=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return s.codecs.forEach(d=>{u.forEach(f=>{d.rtcpFeedback.find(g=>g.type===f.type&&g.parameter===f.parameter)||d.rtcpFeedback.push(f)})}),s},e.writeRtpDescription=function(n,s){let o="";o+="m="+n+" ",o+=s.codecs.length>0?"9":"0",o+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=s.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(u=>{o+=e.writeRtpMap(u),o+=e.writeFmtp(u),o+=e.writeRtcpFb(u)});let l=0;return s.codecs.forEach(u=>{u.maxptime>l&&(l=u.maxptime)}),l>0&&(o+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(u=>{o+=e.writeExtmap(u)}),o},e.parseRtpEncodingParameters=function(n){const s=[],o=e.parseRtpParameters(n),l=o.fecMechanisms.indexOf("RED")!==-1,u=o.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(n,"a=ssrc:").map(S=>e.parseSsrcMedia(S)).filter(S=>S.attribute==="cname"),f=d.length>0&&d[0].ssrc;let m;const g=e.matchPrefix(n,"a=ssrc-group:FID").map(S=>S.substring(17).split(" ").map(x=>parseInt(x,10)));g.length>0&&g[0].length>1&&g[0][0]===f&&(m=g[0][1]),o.codecs.forEach(S=>{if(S.name.toUpperCase()==="RTX"&&S.parameters.apt){let T={ssrc:f,codecPayloadType:parseInt(S.parameters.apt,10)};f&&m&&(T.rtx={ssrc:m}),s.push(T),l&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:f,mechanism:u?"red+ulpfec":"red"},s.push(T))}}),s.length===0&&f&&s.push({ssrc:f});let v=e.matchPrefix(n,"b=");return v.length&&(v[0].indexOf("b=TIAS:")===0?v=parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?v=parseInt(v[0].substring(5),10)*1e3*.95-2e3*8:v=void 0,s.forEach(S=>{S.maxBitrate=v})),s},e.parseRtcpParameters=function(n){const s={},o=e.matchPrefix(n,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];o&&(s.cname=o.value,s.ssrc=o.ssrc);const l=e.matchPrefix(n,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const u=e.matchPrefix(n,"a=rtcp-mux");return s.mux=u.length>0,s},e.writeRtcpParameters=function(n){let s="";return n.reducedSize&&(s+=`a=rtcp-rsize\r
`),n.mux&&(s+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(s+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),s},e.parseMsid=function(n){let s;const o=e.matchPrefix(n,"a=msid:");if(o.length===1)return s=o[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");if(l.length>0)return s=l[0].value.split(" "),{stream:s[0],track:s[1]}},e.parseSctpDescription=function(n){const s=e.parseMLine(n),o=e.matchPrefix(n,"a=max-message-size:");let l;o.length>0&&(l=parseInt(o[0].substring(19),10)),isNaN(l)&&(l=65536);const u=e.matchPrefix(n,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const d=e.matchPrefix(n,"a=sctpmap:");if(d.length>0){const f=d[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:l}}},e.writeSctpDescription=function(n,s){let o=[];return n.protocol!=="DTLS/SCTP"?o=["m="+n.kind+" 9 "+n.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:o=["m="+n.kind+" 9 "+n.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&o.push("a=max-message-size:"+s.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,s,o){let l;const u=s!==void 0?s:2;return n?l=n:l=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+l+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,s){const o=e.splitLines(n);for(let l=0;l<o.length;l++)switch(o[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[l].substring(2)}return s?e.getDirection(s):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const o=e.splitLines(n)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(n){const o=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const s=e.splitLines(n);for(let o=0;o<s.length;o++)if(s[o].length<2||s[o].charAt(1)!=="=")return!1;return!0},a.exports=e})(ah)),ah.exports}var _S=K_(),Ms=L_(_S),Q_=iw({__proto__:null,default:Ms},[_S]);function Fl(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const e=a.RTCIceCandidate;a.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const o=new e(s),l=Ms.parseCandidate(s.candidate);for(const u in l)u in o||Object.defineProperty(o,u,{value:l[u]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(s)},a.RTCIceCandidate.prototype=e.prototype,Ia(a,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new a.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Nh(a){!a.RTCIceCandidate||a.RTCIceCandidate&&"relayProtocol"in a.RTCIceCandidate.prototype||Ia(a,"icecandidate",e=>{if(e.candidate){const n=Ms.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Vl(a,e){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(d){if(!d||!d.sdp)return!1;const f=Ms.splitSections(d.sdp);return f.shift(),f.some(m=>{const g=Ms.parseMLine(m);return g&&g.kind==="application"&&g.protocol.indexOf("SCTP")!==-1})},s=function(d){const f=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const m=parseInt(f[1],10);return m!==m?-1:m},o=function(d){let f=65536;return e.browser==="firefox"&&(e.version<57?d===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},l=function(d,f){let m=65536;e.browser==="firefox"&&e.version===57&&(m=65535);const g=Ms.matchPrefix(d.sdp,"a=max-message-size:");return g.length>0?m=parseInt(g[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(m=2147483637),m},u=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const f=s(arguments[0]),m=o(f),g=l(arguments[0],f);let v;m===0&&g===0?v=Number.POSITIVE_INFINITY:m===0||g===0?v=Math.max(m,g):v=Math.min(m,g);const S={};Object.defineProperty(S,"maxMessageSize",{get(){return v}}),this._sctp=S}return u.apply(this,arguments)}}function Hl(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function e(s,o){const l=s.send;s.send=function(){const d=arguments[0],f=d.length||d.size||d.byteLength;if(s.readyState==="open"&&o.sctp&&f>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const n=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const o=n.apply(this,arguments);return e(o,this),o},Ia(a,"datachannel",s=>(e(s.channel,s.target),s))}function Oh(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const e=a.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const s=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const l=o.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const u=new Event("connectionstatechange",o);l.dispatchEvent(u)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Dh(a,e){if(!a.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=o.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&o instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:o.type,sdp:l}):o.sdp=l}return n.apply(this,arguments)}}function Gl(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const n=a.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Yl(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const n=a.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return n.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?n.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>n.apply(this,[u]))})}var J_=Object.freeze({__proto__:null,removeExtmapAllowMixed:Dh,shimAddIceCandidateNullOrEmpty:Gl,shimConnectionState:Oh,shimMaxMessageSize:Vl,shimParameterlessSetLocalDescription:Yl,shimRTCIceCandidate:Fl,shimRTCIceCandidateRelayProtocol:Nh,shimSendThrowTypeError:Hl});function X_(){let{window:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Zb,s=G_(a),o={browserDetails:s,commonShim:J_,extractVersion:Gr,disableLog:V_,disableWarnings:H_,sdp:Q_};switch(s.browser){case"chrome":if(!N0||!Ah||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(s.version===null)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=N0,Gl(a,s),Yl(a),eS(a,s),tS(a),Ah(a,s),nS(a),rS(a,s),iS(a),aS(a),oS(a,s),Fl(a),Nh(a),Oh(a),Vl(a,s),Hl(a),Dh(a,s);break;case"firefox":if(!O0||!Mh||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=O0,Gl(a,s),Yl(a),lS(a,s),Mh(a,s),cS(a),hS(a),uS(a),dS(a),fS(a),mS(a),pS(a),gS(a),vS(a),Fl(a),Oh(a),Vl(a,s),Hl(a);break;case"safari":if(!D0||!e.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=D0,Gl(a,s),Yl(a),CS(a),ES(a),SS(a),yS(a),bS(a),xS(a),kS(a),wS(a),Fl(a),Nh(a),Vl(a,s),Hl(a),Dh(a,s);break;default:n("Unsupported browser!");break}return o}X_({window:typeof window>"u"?void 0:window});const W_=10,Br="lk_e2ee",Z_="LKFrameEncryptionKey",$_={sharedKey:!1,ratchetSalt:Z_,ratchetWindowSize:8,failureTolerance:W_,keyringSize:16};var aa;(function(a){a.SetKey="setKey",a.RatchetRequest="ratchetRequest",a.KeyRatcheted="keyRatcheted"})(aa||(aa={}));var L0;(function(a){a.KeyRatcheted="keyRatcheted"})(L0||(L0={}));var na;(function(a){a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError"})(na||(na={}));var I0;(function(a){a.Error="cryptorError"})(I0||(I0={}));function eR(){return tR()||Ph()}function Ph(){return typeof window.RTCRtpScriptTransform<"u"}function tR(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function nR(a){var e,n,s,o,l;if(((e=a.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((n=a.value)===null||n===void 0?void 0:n.case)!=="metrics"&&((s=a.value)===null||s===void 0?void 0:s.case)!=="speaker"&&((o=a.value)===null||o===void 0?void 0:o.case)!=="transcription"&&((l=a.value)===null||l===void 0?void 0:l.case)!=="encryptedPacket")return new _b({value:a.value})}class MM extends Gn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,s,o)=>{Ce.debug("key ratcheted event received",{ratchetResult:n,participantId:s,keyIndex:o})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},$_),e),this.on(aa.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,s){const o={key:e,participantIdentity:n,keyIndex:s};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(s??0),o),this.emit(aa.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(aa.RatchetRequest,e,n)}}class Ci extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var Se;(function(a){a[a.NotAllowed=0]="NotAllowed",a[a.ServerUnreachable=1]="ServerUnreachable",a[a.InternalError=2]="InternalError",a[a.Cancelled=3]="Cancelled",a[a.LeaveRequest=4]="LeaveRequest",a[a.Timeout=5]="Timeout"})(Se||(Se={}));class Oe extends Ci{constructor(e,n,s,o){super(1,e),this.name="ConnectionError",this.status=s,this.reason=n,this.context=o,this.reasonName=Se[n]}}class Sf extends Ci{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class vi extends Ci{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class iR extends Ci{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class St extends Ci{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Lh extends Ci{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class j0 extends Ci{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class U0 extends Ci{constructor(e,n){super(15,e),this.reason=n,this.reasonName=typeof n=="string"?n:yf[n]}}var jt;(function(a){a[a.AlreadyOpened=0]="AlreadyOpened",a[a.AbnormalEnd=1]="AbnormalEnd",a[a.DecodeFailed=2]="DecodeFailed",a[a.LengthExceeded=3]="LengthExceeded",a[a.Incomplete=4]="Incomplete",a[a.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",a[a.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(jt||(jt={}));class kn extends Ci{constructor(e,n){super(16,e),this.name="DataStreamError",this.reason=n,this.reasonName=jt[n]}}var sc;(function(a){a.PermissionDenied="PermissionDenied",a.NotFound="NotFound",a.DeviceInUse="DeviceInUse",a.Other="Other"})(sc||(sc={}));(function(a){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?a.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?a.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?a.DeviceInUse:a.Other}a.getFailure=e})(sc||(sc={}));var B0;(function(a){a[a.InvalidKey=0]="InvalidKey",a[a.MissingKey=1]="MissingKey",a[a.InternalError=2]="InternalError"})(B0||(B0={}));var te;(function(a){a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting",a.Reconnected="reconnected",a.Disconnected="disconnected",a.ConnectionStateChanged="connectionStateChanged",a.Moved="moved",a.MediaDevicesChanged="mediaDevicesChanged",a.ParticipantConnected="participantConnected",a.ParticipantDisconnected="participantDisconnected",a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalAudioSilenceDetected="localAudioSilenceDetected",a.ActiveSpeakersChanged="activeSpeakersChanged",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.ParticipantAttributesChanged="participantAttributesChanged",a.ParticipantActive="participantActive",a.RoomMetadataChanged="roomMetadataChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.AudioPlaybackStatusChanged="audioPlaybackChanged",a.VideoPlaybackStatusChanged="videoPlaybackChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.SignalConnected="signalConnected",a.RecordingStatusChanged="recordingStatusChanged",a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ActiveDeviceChanged="activeDeviceChanged",a.ChatMessage="chatMessage",a.LocalTrackSubscribed="localTrackSubscribed",a.MetricsReceived="metricsReceived"})(te||(te={}));var oe;(function(a){a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackCpuConstrained="localTrackCpuConstrained",a.LocalSenderCreated="localSenderCreated",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.IsSpeakingChanged="isSpeakingChanged",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.TrackCpuConstrained="trackCpuConstrained",a.MediaDevicesError="mediaDevicesError",a.AudioStreamAcquired="audioStreamAcquired",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.PCTrackAdded="pcTrackAdded",a.AttributesChanged="attributesChanged",a.LocalTrackSubscribed="localTrackSubscribed",a.ChatMessage="chatMessage",a.Active="active"})(oe||(oe={}));var re;(function(a){a.TransportsCreated="transportsCreated",a.Connected="connected",a.Disconnected="disconnected",a.Resuming="resuming",a.Resumed="resumed",a.Restarting="restarting",a.Restarted="restarted",a.SignalResumed="signalResumed",a.SignalRestarted="signalRestarted",a.Closing="closing",a.MediaTrackAdded="mediaTrackAdded",a.ActiveSpeakersUpdate="activeSpeakersUpdate",a.DataPacketReceived="dataPacketReceived",a.RTPVideoMapUpdate="rtpVideoMapUpdate",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ParticipantUpdate="participantUpdate",a.RoomUpdate="roomUpdate",a.SpeakersChanged="speakersChanged",a.StreamStateChanged="streamStateChanged",a.ConnectionQualityUpdate="connectionQualityUpdate",a.SubscriptionError="subscriptionError",a.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",a.RemoteMute="remoteMute",a.SubscribedQualityUpdate="subscribedQualityUpdate",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackSubscribed="localTrackSubscribed",a.Offline="offline",a.SignalRequestResponse="signalRequestResponse",a.SignalConnected="signalConnected",a.RoomMoved="roomMoved"})(re||(re={}));var ie;(function(a){a.Message="message",a.Muted="muted",a.Unmuted="unmuted",a.Restarted="restarted",a.Ended="ended",a.Subscribed="subscribed",a.Unsubscribed="unsubscribed",a.CpuConstrained="cpuConstrained",a.UpdateSettings="updateSettings",a.UpdateSubscription="updateSubscription",a.AudioPlaybackStarted="audioPlaybackStarted",a.AudioPlaybackFailed="audioPlaybackFailed",a.AudioSilenceDetected="audioSilenceDetected",a.VisibilityChanged="visibilityChanged",a.VideoDimensionsChanged="videoDimensionsChanged",a.VideoPlaybackStarted="videoPlaybackStarted",a.VideoPlaybackFailed="videoPlaybackFailed",a.ElementAttached="elementAttached",a.ElementDetached="elementDetached",a.UpstreamPaused="upstreamPaused",a.UpstreamResumed="upstreamResumed",a.SubscriptionPermissionChanged="subscriptionPermissionChanged",a.SubscriptionStatusChanged="subscriptionStatusChanged",a.SubscriptionFailed="subscriptionFailed",a.TrackProcessorUpdate="trackProcessorUpdate",a.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",a.TranscriptionReceived="transcriptionReceived",a.TimeSyncUpdate="timeSyncUpdate",a.PreConnectBufferFlushed="preConnectBufferFlushed"})(ie||(ie={}));function aR(a){return typeof a>"u"?a:typeof structuredClone=="function"?typeof a=="object"&&a!==null?structuredClone(Object.assign({},a)):structuredClone(a):JSON.parse(JSON.stringify(a))}const sR=/version\/(\d+(\.?_?\d+)+)/i;let sh;function Xt(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(sh===void 0||e){const s=rR.find(o=>{let{test:l}=o;return l.test(n)});sh=s==null?void 0:s.describe(n)}return sh}const rR=[{test:/firefox|iceweasel|fxios/i,describe(a){return{name:"Firefox",version:Kl(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:rh(a)}}},{test:/chrom|crios|crmo/i,describe(a){return{name:"Chrome",version:Kl(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("crios")?"iOS":void 0,osVersion:rh(a)}}},{test:/safari|applewebkit/i,describe(a){return{name:"Safari",version:Kl(sR,a),os:a.includes("mobile/")?"iOS":"macOS",osVersion:rh(a)}}}];function Kl(a,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=e.match(a);return s&&s.length>=n&&s[n]||""}function rh(a){return a.includes("mac os")?Kl(/\(.+?(\d+_\d+(:?_\d+)?)/,a,1).replace(/_/g,"."):void 0}var oR="2.16.0";const lR=oR,cR=16;class Dt{}Dt.setTimeout=function(){return setTimeout(...arguments)};Dt.setInterval=function(){return setInterval(...arguments)};Dt.clearTimeout=function(){return clearTimeout(...arguments)};Dt.clearInterval=function(){return clearInterval(...arguments)};const uR=5e3,zr=[];var ln;(function(a){a[a.LOW=0]="LOW",a[a.MEDIUM=1]="MEDIUM",a[a.HIGH=2]="HIGH"})(ln||(ln={}));class Z extends Gn.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=Z.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Ce,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),uR):this.handleAppVisibilityChanged()},this.log=ki((o=s.loggerName)!==null&&o!==void 0?o:Dn.Track),this.loggerContextCb=s.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Z.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),_e(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Z.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===Z.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(zr.forEach(l=>{l.parentElement===null&&!e&&(e=l)}),e&&zr.splice(zr.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),ws(this.mediaStreamTrack,e);const s=e.srcObject.getTracks(),o=s.some(l=>l.kind==="audio");return e.play().then(()=>{this.emit(o?ie.AudioPlaybackStarted:ie.VideoPlaybackStarted)}).catch(l=>{l.name==="NotAllowedError"?this.emit(o?ie.AudioPlaybackFailed:ie.VideoPlaybackFailed,l):l.name==="AbortError"?Ce.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):Ce.warn("could not playback ".concat(o?"audio":"video"),l),o&&e&&s.some(u=>u.kind==="video")&&l.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ie.ElementAttached,e),e}detach(e){try{if(e){Ns(this.mediaStreamTrack,e);const s=this.attachedElements.indexOf(e);return s>=0&&(this.attachedElements.splice(s,1),this.recycleElement(e),this.emit(ie.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(s=>{Ns(this.mediaStreamTrack,s),n.push(s),this.recycleElement(s),this.emit(ie.ElementDetached,s)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ki(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),zr.forEach(s=>{s.parentElement||(n=!1)}),n&&zr.push(e)}}handleAppVisibilityChanged(){return C(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Z.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Jt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Jt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function ws(a,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let s;a.kind==="audio"?s=n.getAudioTracks():s=n.getVideoTracks(),s.includes(a)||(s.forEach(o=>{n.removeTrack(o)}),n.addTrack(a)),(!Pa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Pa()||Da())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Ns(a,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(a),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(a){let e;(function(m){m.Audio="audio",m.Video="video",m.Unknown="unknown"})(e=a.Kind||(a.Kind={}));let n;(function(m){m.Camera="camera",m.Microphone="microphone",m.ScreenShare="screen_share",m.ScreenShareAudio="screen_share_audio",m.Unknown="unknown"})(n=a.Source||(a.Source={}));let s;(function(m){m.Active="active",m.Paused="paused",m.Unknown="unknown"})(s=a.StreamState||(a.StreamState={}));function o(m){switch(m){case e.Audio:return Rn.AUDIO;case e.Video:return Rn.VIDEO;default:return Rn.DATA}}a.kindToProto=o;function l(m){switch(m){case Rn.AUDIO:return e.Audio;case Rn.VIDEO:return e.Video;default:return e.Unknown}}a.kindFromProto=l;function u(m){switch(m){case n.Camera:return vt.CAMERA;case n.Microphone:return vt.MICROPHONE;case n.ScreenShare:return vt.SCREEN_SHARE;case n.ScreenShareAudio:return vt.SCREEN_SHARE_AUDIO;default:return vt.UNKNOWN}}a.sourceToProto=u;function d(m){switch(m){case vt.CAMERA:return n.Camera;case vt.MICROPHONE:return n.Microphone;case vt.SCREEN_SHARE:return n.ScreenShare;case vt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}a.sourceFromProto=d;function f(m){switch(m){case Eh.ACTIVE:return s.Active;case Eh.PAUSED:return s.Paused;default:return s.Unknown}}a.streamStateFromProto=f})(Z||(Z={}));class Qe{constructor(e,n,s,o,l){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&s!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:s,maxFramerate:o,priority:l};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const dR=["vp8","h264"],hR=["vp8","h264","vp9","av1","h265"];function fR(a){return!!dR.find(e=>e===a)}const mR=fR;var z0;(function(a){a[a.PREFER_REGRESSION=0]="PREFER_REGRESSION",a[a.SIMULCAST=1]="SIMULCAST",a[a.REGRESSION=2]="REGRESSION"})(z0||(z0={}));var Ih;(function(a){a.telephone={maxBitrate:12e3},a.speech={maxBitrate:24e3},a.music={maxBitrate:48e3},a.musicStereo={maxBitrate:64e3},a.musicHighQuality={maxBitrate:96e3},a.musicHighQualityStereo={maxBitrate:128e3}})(Ih||(Ih={}));const eo={h90:new Qe(160,90,9e4,20),h180:new Qe(320,180,16e4,20),h216:new Qe(384,216,18e4,20),h360:new Qe(640,360,45e4,20),h540:new Qe(960,540,8e5,25),h720:new Qe(1280,720,17e5,30),h1080:new Qe(1920,1080,3e6,30),h1440:new Qe(2560,1440,5e6,30),h2160:new Qe(3840,2160,8e6,30)},jh={h120:new Qe(160,120,7e4,20),h180:new Qe(240,180,125e3,20),h240:new Qe(320,240,14e4,20),h360:new Qe(480,360,33e4,20),h480:new Qe(640,480,5e5,20),h540:new Qe(720,540,6e5,25),h720:new Qe(960,720,13e5,30),h1080:new Qe(1440,1080,23e5,30),h1440:new Qe(1920,1440,38e5,30)},kf={h360fps3:new Qe(640,360,2e5,3,"medium"),h360fps15:new Qe(640,360,4e5,15,"medium"),h720fps5:new Qe(1280,720,8e5,5,"medium"),h720fps15:new Qe(1280,720,15e5,15,"medium"),h720fps30:new Qe(1280,720,2e6,30,"medium"),h1080fps15:new Qe(1920,1080,25e5,15,"medium"),h1080fps30:new Qe(1920,1080,5e6,30,"medium"),original:new Qe(0,0,7e6,30,"medium")},pR="|",q0="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function gR(a){const e=a.split(pR);return e.length>1?[e[0],a.substr(e[0].length+1)]:[a,""]}function Pt(a){return C(this,void 0,void 0,function*(){return new Promise(e=>Dt.setTimeout(e,a))})}function Uh(){return"addTransceiver"in RTCPeerConnection.prototype}function Bh(){return"addTrack"in RTCPeerConnection.prototype}function vR(){if(!("getCapabilities"in RTCRtpSender)||Pa()||Da())return!1;const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const n of a.codecs)if(n.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function yR(){if(!("getCapabilities"in RTCRtpSender)||Da())return!1;if(Pa()){const n=Xt();if(n!=null&&n.version&&Vn(n.version,"16")<0||(n==null?void 0:n.os)==="iOS"&&(n!=null&&n.osVersion)&&Vn(n.osVersion,"16")<0)return!1}const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const n of a.codecs)if(n.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function Mn(a){return a==="av1"||a==="vp9"}function zh(a){return!document||to()?!1:(a||(a=document.createElement("audio")),"setSinkId"in a)}function bR(){return typeof RTCPeerConnection>"u"?!1:Uh()||Bh()}function Da(){var a;return((a=Xt())===null||a===void 0?void 0:a.name)==="Firefox"}function F0(){const a=Xt();return!!a&&a.name==="Chrome"&&a.os!=="iOS"}function Pa(){var a;return((a=Xt())===null||a===void 0?void 0:a.name)==="Safari"}function to(){const a=Xt();return(a==null?void 0:a.name)==="Safari"||(a==null?void 0:a.os)==="iOS"}function SR(){const a=Xt();return(a==null?void 0:a.name)==="Safari"&&a.version.startsWith("17.")||(a==null?void 0:a.os)==="iOS"&&!!(a!=null&&a.osVersion)&&Vn(a.osVersion,"17")>=0}function kR(a){return a||(a=Xt()),(a==null?void 0:a.name)==="Safari"&&Vn(a.version,"18.3")>0||(a==null?void 0:a.os)==="iOS"&&!!(a!=null&&a.osVersion)&&Vn(a.osVersion,"18.3")>0}function RS(){var a,e;return Jt()?(e=(a=navigator.userAgentData)===null||a===void 0?void 0:a.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function TR(){const a=Xt(),e="17.2";if(a)return a.name!=="Safari"&&a.os!=="iOS"||a.os==="iOS"&&a.osVersion&&Vn(a.osVersion,e)>=0?!0:a.name==="Safari"&&Vn(a.version,e)>=0}function Jt(){return typeof document<"u"}function Fn(){return navigator.product=="ReactNative"}function rc(a){return a.hostname.endsWith(".livekit.cloud")||a.hostname.endsWith(".livekit.run")}function oh(a){return rc(a)?a.hostname.split(".")[0]:null}function AS(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function MS(){if(!Fn())return;let a=AS();if(a)return a.platform}function V0(){if(Jt())return window.devicePixelRatio;if(Fn()){let a=AS();if(a)return a.devicePixelRatio}return 1}function Vn(a,e){const n=a.split("."),s=e.split("."),o=Math.min(n.length,s.length);for(let l=0;l<o;++l){const u=parseInt(n[l],10),d=parseInt(s[l],10);if(u>d)return 1;if(u<d)return-1;if(l===o-1&&u===d)return 0}return a===""&&e!==""?-1:e===""?1:n.length==s.length?0:n.length<s.length?-1:1}function CR(a){for(const e of a)e.target.handleResize(e)}function xR(a){for(const e of a)e.target.handleVisibilityChanged(e)}let lh=null;const H0=()=>(lh||(lh=new ResizeObserver(CR)),lh);let ch=null;const G0=()=>(ch||(ch=new IntersectionObserver(xR,{root:null,rootMargin:"0px"})),ch);function ER(){var a;const e=new Pb({sdk:Lb.JS,protocol:cR,version:lR});return Fn()&&(e.os=(a=MS())!==null&&a!==void 0?a:""),e}function Y0(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=a,o.height=e;const l=o.getContext("2d");l==null||l.fillRect(0,0,o.width,o.height),s&&l&&(l.beginPath(),l.arc(a/2,e/2,50,0,Math.PI*2,!0),l.closePath(),l.fillStyle="grey",l.fill());const u=o.captureStream(),[d]=u.getTracks();if(!d)throw Error("Could not get empty media stream video track");return d.enabled=n,d}let qr;function uh(){if(!qr){const a=new AudioContext,e=a.createOscillator(),n=a.createGain();n.gain.setValueAtTime(0,0);const s=a.createMediaStreamDestination();if(e.connect(n),n.connect(s),e.start(),[qr]=s.stream.getAudioTracks(),!qr)throw Error("Could not get empty media stream audio track");qr.enabled=!1}return qr.clone()}class Tn{get isResolved(){return this._isResolved}constructor(e,n){this._isResolved=!1,this.onFinally=n,this.promise=new Promise((s,o)=>C(this,void 0,void 0,function*(){this.resolve=s,this.reject=o,e&&(yield e(s,o))})).finally(()=>{var s;this._isResolved=!0,(s=this.onFinally)===null||s===void 0||s.call(this)})}}function wR(a){return hR.includes(a)}function sa(a){if(typeof a=="string"||typeof a=="number")return a;if(Array.isArray(a))return a[0];if(a.exact!==void 0)return Array.isArray(a.exact)?a.exact[0]:a.exact;if(a.ideal!==void 0)return Array.isArray(a.ideal)?a.ideal[0]:a.ideal;throw Error("could not unwrap constraint")}function _R(a){return a.startsWith("http")?a.replace(/^(http)/,"ws"):a}function no(a){return a.startsWith("ws")?a.replace(/^(ws)/,"http"):a}function RR(a,e){return a.segments.map(n=>{let{id:s,text:o,language:l,startTime:u,endTime:d,final:f}=n;var m;const g=(m=e.get(s))!==null&&m!==void 0?m:Date.now(),v=Date.now();return f?e.delete(s):e.set(s,g),{id:s,text:o,startTime:Number.parseInt(u.toString()),endTime:Number.parseInt(d.toString()),final:f,language:l,firstReceivedTime:g,lastReceivedTime:v}})}function AR(a){const{id:e,timestamp:n,message:s,editTimestamp:o}=a;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:s}}function K0(a){switch(a.reason){case Se.LeaveRequest:return a.context;case Se.Cancelled:return Nn.CLIENT_INITIATED;case Se.NotAllowed:return Nn.USER_REJECTED;case Se.ServerUnreachable:return Nn.JOIN_FAILURE;default:return Nn.UNKNOWN_REASON}}function Ql(a){return a!==void 0?Number(a):void 0}function Na(a){return a!==void 0?BigInt(a):void 0}function Os(a){return!!a&&!(a instanceof MediaStreamTrack)&&a.isLocal}function qn(a){return!!a&&a.kind==Z.Kind.Audio}function la(a){return!!a&&a.kind==Z.Kind.Video}function $i(a){return Os(a)&&la(a)}function di(a){return Os(a)&&qn(a)}function qh(a){return!!a&&!a.isLocal}function MR(a){return!!a&&!a.isLocal}function dh(a){return qh(a)&&la(a)}function NR(a){return a.isLocal}function OR(a,e){const n=[];let s=new TextEncoder().encode(a);for(;s.length>e;){let o=e;for(;o>0;){const l=s[o];if(l!==void 0&&(l&192)!==128)break;o--}n.push(s.slice(0,o)),s=s.slice(o)}return s.length>0&&n.push(s),n}function DR(a){var e;const n=a.get("Cache-Control");if(n){const s=(e=n.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(s)return parseInt(s,10)}}function NS(a,e,n){var s,o,l,u;const{optionsWithoutProcessor:d,audioProcessor:f,videoProcessor:m}=PS(a??{}),g=e==null?void 0:e.processor,v=n==null?void 0:n.processor,S=d??{};return S.audio===!0&&(S.audio={}),S.video===!0&&(S.video={}),S.audio&&(Fh(S.audio,e),(s=(l=S.audio).deviceId)!==null&&s!==void 0||(l.deviceId={ideal:"default"}),(f||g)&&(S.audio.processor=f??g)),S.video&&(Fh(S.video,n),(o=(u=S.video).deviceId)!==null&&o!==void 0||(u.deviceId={ideal:"default"}),(m||v)&&(S.video.processor=m??v)),S}function Fh(a,e){return Object.keys(e).forEach(n=>{a[n]===void 0&&(a[n]=e[n])}),a}function Tf(a){var e,n,s,o;const l={};if(a.video)if(typeof a.video=="object"){const u={},d=u,f=a.video;Object.keys(f).forEach(m=>{switch(m){case"resolution":Fh(d,f.resolution);break;default:d[m]=f[m]}}),l.video=u,(e=(s=l.video).deviceId)!==null&&e!==void 0||(s.deviceId={ideal:"default"})}else l.video=a.video?{deviceId:{ideal:"default"}}:!1;else l.video=!1;return a.audio?typeof a.audio=="object"?(l.audio=a.audio,(n=(o=l.audio).deviceId)!==null&&n!==void 0||(o.deviceId={ideal:"default"})):l.audio={deviceId:{ideal:"default"}}:l.audio=!1,l}function OS(a){return C(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return(function*(){const s=DS();if(s){const o=s.createAnalyser();o.fftSize=2048;const l=o.frequencyBinCount,u=new Uint8Array(l);s.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield Pt(n),o.getByteTimeDomainData(u);const f=u.some(m=>m!==128&&m!==0);return s.close(),!f}return!1})()})}function DS(){var a;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window<"u"&&(!((a=window.document)===null||a===void 0)&&a.body)){const s=()=>C(this,void 0,void 0,function*(){var o;try{n.state==="suspended"&&(yield n.resume())}catch(l){console.warn("Error trying to auto-resume audio context",l)}finally{(o=window.document.body)===null||o===void 0||o.removeEventListener("click",s)}});n.addEventListener("statechange",()=>{var o;n.state==="closed"&&((o=window.document.body)===null||o===void 0||o.removeEventListener("click",s))}),window.document.body.addEventListener("click",s)}return n}}function PR(a){return a==="audioinput"?Z.Source.Microphone:a==="videoinput"?Z.Source.Camera:Z.Source.Unknown}function Vh(a){return a===Z.Source.Microphone?"audioinput":a===Z.Source.Camera?"videoinput":void 0}function LR(a){var e,n;let s=(e=a.video)!==null&&e!==void 0?e:!0;return a.resolution&&a.resolution.width>0&&a.resolution.height>0&&(s=typeof s=="boolean"?{}:s,Pa()?s=Object.assign(Object.assign({},s),{width:{max:a.resolution.width},height:{max:a.resolution.height},frameRate:a.resolution.frameRate}):s=Object.assign(Object.assign({},s),{width:{ideal:a.resolution.width},height:{ideal:a.resolution.height},frameRate:a.resolution.frameRate})),{audio:(n=a.audio)!==null&&n!==void 0?n:!1,video:s,controller:a.controller,selfBrowserSurface:a.selfBrowserSurface,surfaceSwitching:a.surfaceSwitching,systemAudio:a.systemAudio,preferCurrentTab:a.preferCurrentTab}}function Qr(a){return a.split("/")[1].toLowerCase()}function IR(a){const e=[];return a.forEach(n=>{n.track!==void 0&&e.push(new ff({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function _e(a){return"mediaStreamTrack"in a?{trackID:a.sid,source:a.source,muted:a.isMuted,enabled:a.mediaStreamTrack.enabled,kind:a.kind,streamID:a.mediaStreamID,streamTrackID:a.mediaStreamTrack.id}:{trackID:a.trackSid,enabled:a.isEnabled,muted:a.isMuted,trackInfo:Object.assign({mimeType:a.mimeType,name:a.trackName,encrypted:a.isEncrypted,kind:a.kind,source:a.source},a.track?_e(a.track):{})}}function jR(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function UR(a,e){var n;a===void 0&&(a={}),e===void 0&&(e={});const s=[...Object.keys(e),...Object.keys(a)],o={};for(const l of s)a[l]!==e[l]&&(o[l]=(n=e[l])!==null&&n!==void 0?n:"");return o}function PS(a){const e=Object.assign({},a);let n,s;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(s=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:s,optionsWithoutProcessor:aR(e)}}function BR(a){switch(a){case vt.CAMERA:return Z.Source.Camera;case vt.MICROPHONE:return Z.Source.Microphone;case vt.SCREEN_SHARE:return Z.Source.ScreenShare;case vt.SCREEN_SHARE_AUDIO:return Z.Source.ScreenShareAudio;default:return Z.Source.Unknown}}function Q0(a,e){return a.width*a.height<e.width*e.height}function zR(a,e){var n;return(n=a.layers)===null||n===void 0?void 0:n.find(s=>s.quality===e)}class qR extends Gn.EventEmitter{constructor(e,n){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=s=>{var o,l;const{kind:u,data:d}=s.data;switch(u){case"error":if(Ce.error(d.error.message),d.uuid){const g=this.decryptDataRequests.get(d.uuid);if(g!=null&&g.reject){g.reject(d.error);break}const v=this.encryptDataRequests.get(d.uuid);if(v!=null&&v.reject){v.reject(d.error);break}}this.emit(na.EncryptionError,d.error,d.participantIdentity);break;case"initAck":d.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)});break;case"enable":if(d.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)}),this.encryptionEnabled!==d.enabled&&d.participantIdentity===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity))this.emit(na.ParticipantEncryptionStatusChanged,d.enabled,this.room.localParticipant),this.encryptionEnabled=d.enabled;else if(d.participantIdentity){const g=(l=this.room)===null||l===void 0?void 0:l.getParticipantByIdentity(d.participantIdentity);if(!g)throw TypeError("couldn't set encryption status, participant not found".concat(d.participantIdentity));this.emit(na.ParticipantEncryptionStatusChanged,d.enabled,g)}break;case"ratchetKey":this.keyProvider.emit(aa.KeyRatcheted,d.ratchetResult,d.participantIdentity,d.keyIndex);break;case"decryptDataResponse":const f=this.decryptDataRequests.get(d.uuid);f!=null&&f.resolve&&f.resolve(d);break;case"encryptDataResponse":const m=this.encryptDataRequests.get(d.uuid);m!=null&&m.resolve&&m.resolve(d);break}},this.onWorkerError=s=>{Ce.error("e2ee worker encountered an error:",{error:s.error}),this.emit(na.EncryptionError,s.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=n}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!eR())throw new Sf("tried to setup end-to-end encryption on an unsupported browser");if(Ce.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:U_.getLevel()}};this.worker&&(Ce.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Ce.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Ce.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(re.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(te.TrackPublished,(s,o)=>this.setParticipantCryptorEnabled(s.trackInfo.encryption!==kt.NONE,o.identity)),e.on(te.ConnectionStateChanged,s=>{s===Ue.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{this.setParticipantCryptorEnabled(l.trackInfo.encryption!==kt.NONE,o.identity)})})}).on(te.TrackUnsubscribed,(s,o,l)=>{var u;const d={kind:"removeTransform",data:{participantIdentity:l.identity,trackId:s.mediaStreamID}};(u=this.worker)===null||u===void 0||u.postMessage(d)}).on(te.TrackSubscribed,(s,o,l)=>{this.setupE2EEReceiver(s,l.identity,o.trackInfo)}).on(te.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(s=>{this.postKey(s)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(oe.LocalSenderCreated,(s,o)=>C(this,void 0,void 0,function*(){this.setupE2EESender(o,s)})),e.localParticipant.on(oe.LocalTrackPublished,s=>{if(!la(s.track)||!to())return;const o={kind:"updateCodec",data:{trackId:s.track.mediaStreamID,codec:Qr(s.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o)}),n.on(aa.SetKey,s=>this.postKey(s)).on(aa.RatchetRequest,(s,o)=>this.postRatchetRequest(s,o))}encryptData(e){return C(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const n=crypto.randomUUID(),s={kind:"encryptDataRequest",data:{uuid:n,payload:e,participantIdentity:this.room.localParticipant.identity}},o=new Tn;return o.onFinally=()=>{this.encryptDataRequests.delete(n)},this.encryptDataRequests.set(n,o),this.worker.postMessage(s),o.promise})}handleEncryptedData(e,n,s,o){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const l=crypto.randomUUID(),u={kind:"decryptDataRequest",data:{uuid:l,payload:e,iv:n,participantIdentity:s,keyIndex:o}},d=new Tn;return d.onFinally=()=>{this.decryptDataRequests.delete(l)},this.decryptDataRequests.set(l,d),this.worker.postMessage(u),d.promise}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const s={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(s)}postKey(e){let{key:n,participantIdentity:s,keyIndex:o}=e;var l;if(!this.worker)throw Error("could not set key, worker is missing");const u={kind:"setKey",data:{participantIdentity:s,isPublisher:s===((l=this.room)===null||l===void 0?void 0:l.localParticipant.identity),key:n,keyIndex:o}};this.worker.postMessage(u)}postEnable(e,n){if(this.worker){const s={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(s)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const s={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,s){if(e.receiver){if(!(s!=null&&s.mimeType)||s.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?Qr(s.mimeType):void 0)}}setupE2EESender(e,n){if(!Os(e)||!n){n||Ce.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,s,o){return C(this,void 0,void 0,function*(){if(this.worker){if(Ph()&&!F0()){const l={kind:"decode",participantIdentity:s,trackId:n,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{if(Br in e&&o){const f={kind:"updateCodec",data:{trackId:n,codec:o,participantIdentity:s}};this.worker.postMessage(f);return}let l=e.writableStream,u=e.readableStream;if(!l||!u){const f=e.createEncodedStreams();e.writableStream=f.writable,l=f.writable,e.readableStream=f.readable,u=f.readable}const d={kind:"decode",data:{readableStream:u,writableStream:l,trackId:n,codec:o,participantIdentity:s,isReuse:Br in e}};this.worker.postMessage(d,[u,l])}e[Br]=!0}})}handleSender(e,n,s){var o;if(!(Br in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Ph()&&!F0()){Ce.info("initialize script transform");const l={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:s};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{Ce.info("initialize encoded streams");const l=e.createEncodedStreams(),u={kind:"encode",data:{readableStream:l.readable,writableStream:l.writable,codec:s,trackId:n,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(u,[l.readable,l.writable])}e[Br]=!0}}}const FR=500,VR=15e3;class Ds{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new Ds),this._instance}addFailedConnectionAttempt(e){var n;const s=new URL(e),o=oh(s);if(!o)return;let l=(n=this.failedConnectionAttempts.get(o))!==null&&n!==void 0?n:0;this.failedConnectionAttempts.set(o,l+1),this.backOffPromises.set(o,Pt(Math.min(FR*Math.pow(2,l),VR)))}getBackOffPromise(e){const n=new URL(e),s=n&&oh(n);return s&&this.backOffPromises.get(s)||Promise.resolve()}resetFailedConnectionAttempts(e){const n=new URL(e),s=n&&oh(n);s&&(this.failedConnectionAttempts.set(s,0),this.backOffPromises.set(s,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}Ds._instance=null;const hh="default";class wt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new wt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return C(this,arguments,void 0,function(n){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var l;if(((l=wt.userMediaPromiseMap)===null||l===void 0?void 0:l.size)>0){Ce.debug("awaiting getUserMedia promise");try{n?yield wt.userMediaPromiseMap.get(n):yield Promise.all(wt.userMediaPromiseMap.values())}catch{Ce.warn("error waiting for media permissons")}}let u=yield navigator.mediaDevices.enumerateDevices();if(o&&!(Pa()&&s.hasDeviceInUse(n))&&(u.filter(f=>f.kind===n).length===0||u.some(f=>{const m=f.label==="",g=n?f.kind===n:!0;return m&&g}))){const f={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:{ideal:"default"}}},m=yield navigator.mediaDevices.getUserMedia(f);u=yield navigator.mediaDevices.enumerateDevices(),m.getTracks().forEach(g=>{g.stop()})}return s._previousDevices=u,n&&(u=u.filter(d=>d.kind===n)),u})()})}normalizeDeviceId(e,n,s){return C(this,void 0,void 0,function*(){if(n!==hh)return n;const o=yield this.getDevices(e),l=o.find(d=>d.deviceId===hh);if(!l){Ce.warn("could not reliably determine default device");return}const u=o.find(d=>d.deviceId!==hh&&d.groupId===(s??l.groupId));if(!u){Ce.warn("could not reliably determine default device");return}return u==null?void 0:u.deviceId})}hasDeviceInUse(e){return e?wt.userMediaPromiseMap.has(e):wt.userMediaPromiseMap.size>0}}wt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];wt.userMediaPromiseMap=new Map;var Jr;(function(a){a[a.WAITING=0]="WAITING",a[a.RUNNING=1]="RUNNING",a[a.COMPLETED=2]="COMPLETED"})(Jr||(Jr={}));class HR{constructor(){this.pendingTasks=new Map,this.taskMutex=new Bt,this.nextTaskIndex=0}run(e){return C(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Jr.WAITING};this.pendingTasks.set(n.id,n);const s=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Jr.RUNNING,yield e()}finally{n.status=Jr.COMPLETED,this.pendingTasks.delete(n.id),s()}})}flush(){return C(this,void 0,void 0,function*(){return this.run(()=>C(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class GR{get readyState(){return this.ws.readyState}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s,o;if(!((s=n.signal)===null||s===void 0)&&s.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const l=new WebSocket(e,(o=n.protocols)!==null&&o!==void 0?o:[]);l.binaryType="arraybuffer",this.ws=l;const u=function(){let{closeCode:d,reason:f}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return l.close(d,f)};this.opened=new Promise((d,f)=>{l.onopen=()=>{d({readable:new ReadableStream({start(m){l.onmessage=g=>{let{data:v}=g;return m.enqueue(v)},l.onerror=g=>m.error(g)},cancel:u}),writable:new WritableStream({write(m){l.send(m)},abort(){l.close()},close:u}),protocol:l.protocol,extensions:l.extensions}),l.removeEventListener("error",f)},l.addEventListener("error",f)}),this.closed=new Promise((d,f)=>{const m=()=>C(this,void 0,void 0,function*(){const g=new Promise(S=>{l.readyState!==WebSocket.CLOSED&&l.addEventListener("close",T=>{S(T)},{once:!0})}),v=yield Promise.race([Pt(250),g]);v?d(v):f(new Error("Encountered unspecified websocket error without a timely close event"))});l.onclose=g=>{let{code:v,reason:S}=g;d({closeCode:v,reason:S}),l.removeEventListener("error",m)},l.addEventListener("error",m)}),n.signal&&(n.signal.onabort=()=>l.close()),this.close=u}}function YR(a,e){const n=new URL(_R(a));return e.forEach((s,o)=>{n.searchParams.set(o,s)}),LS(n,"rtc")}function KR(a){const e=new URL(no(a));return LS(e,"validate")}function QR(a){return a.endsWith("/")?a:"".concat(a,"/")}function LS(a,e){return a.pathname="".concat(QR(a.pathname)).concat(e),a.toString()}function J0(a){if(typeof a=="string")return x0.fromJson(JSON.parse(a),{ignoreUnknownFields:!0});if(a instanceof ArrayBuffer)return x0.fromBinary(new Uint8Array(a));throw new Error("could not decode websocket message: ".concat(typeof a))}function JR(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(a instanceof AbortSignal))return e;const n=a.reason;switch(typeof n){case"string":return n;case"object":return n instanceof Error?n.message:e;default:return"toString"in n?n.toString():e}}const XR=["syncState","trickle","offer","answer","simulate","leave"];function WR(a){const e=XR.indexOf(a.case)>=0;return Ce.trace("request allowed to bypass queue:",{canPass:e,req:a}),e}var We;(function(a){a[a.CONNECTING=0]="CONNECTING",a[a.CONNECTED=1]="CONNECTED",a[a.RECONNECTING=2]="RECONNECTING",a[a.DISCONNECTING=3]="DISCONNECTING",a[a.DISCONNECTED=4]="DISCONNECTED"})(We||(We={}));const ZR=250;class Cf{get currentState(){return this.state}get isDisconnected(){return this.state===We.DISCONNECTING||this.state===We.DISCONNECTED}get isEstablishingConnection(){return this.state===We.CONNECTING||this.state===We.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;this.rtt=0,this.state=We.DISCONNECTED,this.log=Ce,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=ki((s=n.loggerName)!==null&&s!==void 0?s:Dn.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new HR,this.queuedRequests=[],this.closingLock=new Bt,this.connectionLock=new Bt,this.state=We.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,s,o){return C(this,void 0,void 0,function*(){return this.state=We.CONNECTING,this.options=s,yield this.connect(e,n,s,o)})}reconnect(e,n,s,o){return C(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=We.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:s,reconnectReason:o}))})}connect(e,n,s,o){return C(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();this.connectOptions=s;const u=ER(),d=s.singlePeerConnection?eA(n,u,s):$R(n,u,s),f=YR(e,d),m=KR(f);return new Promise((g,v)=>C(this,void 0,void 0,function*(){var S,T;try{let x=!1;const E=A=>C(this,void 0,void 0,function*(){if(x)return;x=!0;const N=A instanceof Event?A.currentTarget:A,V=JR(N,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(V)).catch(X=>{this.log.error(X),this.close()}):this.close(),D(),v(N instanceof AbortSignal?N.reason:N)});o==null||o.addEventListener("abort",E);const D=()=>{clearTimeout(M),o==null||o.removeEventListener("abort",E)},M=setTimeout(()=>{E(new Oe("room connection has timed out (signal)",Se.ServerUnreachable))},s.websocketTimeout),Y=(A,N)=>{this.handleSignalConnected(A,M,N)},P=new URL(f);P.searchParams.has("access_token")&&P.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(P),Object.assign({reconnect:s.reconnect,reconnectReason:s.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new GR(f);try{this.ws.closed.then(H=>{var se;this.isEstablishingConnection&&v(new Oe("Websocket got closed during a (re)connection attempt: ".concat(H.reason),Se.InternalError)),H.closeCode!==1e3&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:H.reason,code:H.closeCode,wasClean:H.closeCode===1e3,state:this.state})),this.state===We.CONNECTED&&this.handleOnClose((se=H.reason)!==null&&se!==void 0?se:"Unexpected WS error"))}).catch(H=>{this.isEstablishingConnection&&v(new Oe("Websocket error during a (re)connection attempt: ".concat(H),Se.InternalError))});const A=yield this.ws.opened.catch(H=>C(this,void 0,void 0,function*(){if(this.state!==We.CONNECTED){this.state=We.DISCONNECTED,clearTimeout(M);const se=yield this.handleConnectionError(H,m);v(se);return}this.handleWSError(H),v(H)}));if(clearTimeout(M),!A)return;const N=A.readable.getReader();this.streamWriter=A.writable.getWriter();const V=yield N.read();if(N.releaseLock(),!V.value)throw new Oe("no message received as first message",Se.InternalError);const X=J0(V.value),z=this.validateFirstMessage(X,(S=s.reconnect)!==null&&S!==void 0?S:!1);if(!z.isValid){v(z.error);return}((T=X.message)===null||T===void 0?void 0:T.case)==="join"&&(this.pingTimeoutDuration=X.message.value.pingTimeout,this.pingIntervalDuration=X.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const J=z.shouldProcessFirstMessage?X:void 0;Y(A,J),g(z.response)}catch(A){v(A)}finally{D()}}finally{l()}}))})}startReadingLoop(e,n){return C(this,void 0,void 0,function*(){for(n&&this.handleSignalResponse(n);;){this.signalLatency&&(yield Pt(this.signalLatency));const{done:s,value:o}=yield e.read();if(s)break;const l=J0(o);this.handleSignalResponse(l)}})}close(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return(function*(){if([We.DISCONNECTING||We.DISCONNECTED].includes(e.state)){e.log.debug("ignoring signal close as it's already in disconnecting state");return}const o=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=We.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:s});const l=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([l,Pt(ZR)])}}catch(l){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:l}))}finally{n&&(e.state=We.DISCONNECTED),o()}})()})}sendOffer(e,n){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:_s(e,n)})}sendAnswer(e,n){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:_s(e,n)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new vc({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new yc({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return C(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(function*(){const d=l.getNextRequestId();return yield l.sendRequest({case:"updateMetadata",value:new pf({requestId:d,metadata:s,name:o,attributes:u})}),d})()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new Fb({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new Gb({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:it.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Qb({timestamp:it.parse(Date.now()),rtt:it.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new mf({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new Sc({reason:Nn.CLIENT_INITIATED,action:As.DISCONNECT})})}sendRequest(e){return C(this,arguments,void 0,function(n){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(function*(){if(!o&&!WR(n)&&s.state===We.RECONNECTING){s.queuedRequests.push(()=>C(s,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(o||(yield s.requestQueue.flush()),s.signalLatency&&(yield Pt(s.signalLatency)),s.isDisconnected){s.log.debug("skipping signal request (type: ".concat(n.case,") - SignalClient disconnected"));return}if(!s.streamWriter){s.log.error("cannot send signal request before connected, type: ".concat(n==null?void 0:n.case),s.logContext);return}const u=new c_({message:n});try{s.useJSON?yield s.streamWriter.write(u.toJsonString()):yield s.streamWriter.write(u.toBinary())}catch(d){s.log.error("error sending signal message",Object.assign(Object.assign({},s.logContext),{error:d}))}})()})}handleSignalResponse(e){var n,s;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let l=!1;if(o.case==="answer"){const u=X0(o.value);this.onAnswer&&this.onAnswer(u,o.value.id,o.value.midToTrackId)}else if(o.case==="offer"){const u=X0(o.value);this.onOffer&&this.onOffer(u,o.value.id,o.value.midToTrackId)}else if(o.case==="trickle"){const u=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(u,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=o.value.participants)!==null&&n!==void 0?n:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((s=o.value.speakers)!==null&&s!==void 0?s:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),l=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):o.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(o.value.token),this.onRoomMoved&&this.onRoomMoved(o.value)):o.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(o.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));l||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return C(this,void 0,void 0,function*(){if(this.state===We.DISCONNECTED)return;const n=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Dt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Dt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Dt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Dt.clearInterval(this.pingInterval)}handleSignalConnected(e,n,s){this.state=We.CONNECTED,clearTimeout(n),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),s)}validateFirstMessage(e,n){var s,o,l,u,d;return((s=e.message)===null||s===void 0?void 0:s.case)==="join"?{isValid:!0,response:e.message.value}:this.state===We.RECONNECTING&&((o=e.message)===null||o===void 0?void 0:o.case)!=="leave"?((l=e.message)===null||l===void 0?void 0:l.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((u=e.message)===null||u===void 0?void 0:u.case)==="leave"?{isValid:!1,error:new Oe("Received leave request while trying to (re)connect",Se.LeaveRequest,void 0,e.message.value.reason)}:n?{isValid:!1,error:new Oe("Unexpected first message",Se.InternalError)}:{isValid:!1,error:new Oe("did not receive join response, got ".concat((d=e.message)===null||d===void 0?void 0:d.case," instead"),Se.InternalError)}}handleConnectionError(e,n){return C(this,void 0,void 0,function*(){try{const s=yield fetch(n);if(s.status.toFixed(0).startsWith("4")){const o=yield s.text();return new Oe(o,Se.NotAllowed,s.status)}else return e instanceof Oe?e:new Oe("Encountered unknown websocket error during connection: ".concat(e),Se.InternalError,s.status)}catch(s){return s instanceof Oe?s:new Oe(s instanceof Error?s.message:"server was not reachable",Se.ServerUnreachable)}})}}function X0(a){const e={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=a.type;break}return e}function _s(a,e){return new oa({sdp:a.sdp,type:a.type,id:e})}function $R(a,e,n){var s;const o=new URLSearchParams;return o.set("access_token",a),n.reconnect&&(o.set("reconnect","1"),n.sid&&o.set("sid",n.sid)),o.set("auto_subscribe",n.autoSubscribe?"1":"0"),o.set("sdk",Fn()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),n.adaptiveStream&&o.set("adaptive_stream","1"),n.reconnectReason&&o.set("reconnect_reason",n.reconnectReason.toString()),!((s=navigator.connection)===null||s===void 0)&&s.type&&o.set("network",navigator.connection.type),o}function eA(a,e,n){const s=new URLSearchParams;s.set("access_token",a);const o=new N_({clientInfo:e,connectionSettings:new Jb({autoSubscribe:!!n.autoSubscribe,adaptiveStream:!!n.adaptiveStream}),reconnect:!!n.reconnect,participantSid:n.sid?n.sid:void 0});n.reconnectReason&&(o.reconnectReason=n.reconnectReason);const l=new O_({joinRequest:o.toBinary()});return s.set("join_request",btoa(new TextDecoder("utf-8").decode(l.toBinary()))),s}class W0{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const n=this.buffer[0];if(this._totalSize-n.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class tA{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,n){const s=Date.now();s-this._lastCleanup>this.ttl/2&&this.cleanup();const o=s+this.ttl;return this._map.set(e,{value:n,expiresAt:o}),this}get(e){const n=this._map.get(e);if(n){if(n.expiresAt<Date.now()){this._map.delete(e);return}return n.value}}has(e){const n=this._map.get(e);return n?n.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[n,s]of this._map.entries())s.expiresAt<e&&this._map.delete(n);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[n,s]of this._map.entries())s.expiresAt>=Date.now()&&e(s.value,n,this.asValueMap())}map(e){this.cleanup();const n=[],s=this.asValueMap();for(const[o,l]of s.entries())n.push(e(l,o,s));return n}asValueMap(){const e=new Map;for(const[n,s]of this._map.entries())s.expiresAt>=Date.now()&&e.set(n,s.value);return e}}var wn={},fh={},mh={exports:{}},Z0;function xf(){if(Z0)return mh.exports;Z0=1;var a=mh.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(a).forEach(function(e){var n=a[e];n.forEach(function(s){s.reg||(s.reg=/(.*)/),s.format||(s.format="%s")})}),mh.exports}var $0;function nA(){return $0||($0=1,(function(a){var e=function(d){return String(Number(d))===d?Number(d):d},n=function(d,f,m,g){if(g&&!m)f[g]=e(d[1]);else for(var v=0;v<m.length;v+=1)d[v+1]!=null&&(f[m[v]]=e(d[v+1]))},s=function(d,f,m){var g=d.name&&d.names;d.push&&!f[d.push]?f[d.push]=[]:g&&!f[d.name]&&(f[d.name]={});var v=d.push?{}:g?f[d.name]:f;n(m.match(d.reg),v,d.names,d.name),d.push&&f[d.push].push(v)},o=xf(),l=RegExp.prototype.test.bind(/^([a-z])=(.*)/);a.parse=function(d){var f={},m=[],g=f;return d.split(/(\r\n|\r|\n)/).filter(l).forEach(function(v){var S=v[0],T=v.slice(2);S==="m"&&(m.push({rtp:[],fmtp:[]}),g=m[m.length-1]);for(var x=0;x<(o[S]||[]).length;x+=1){var E=o[S][x];if(E.reg.test(T))return s(E,g,T)}}),f.media=m,f};var u=function(d,f){var m=f.split(/=(.+)/,2);return m.length===2?d[m[0]]=e(m[1]):m.length===1&&f.length>1&&(d[m[0]]=void 0),d};a.parseParams=function(d){return d.split(/;\s?/).reduce(u,{})},a.parseFmtpConfig=a.parseParams,a.parsePayloads=function(d){return d.toString().split(" ").map(Number)},a.parseRemoteCandidates=function(d){for(var f=[],m=d.split(" ").map(e),g=0;g<m.length;g+=3)f.push({component:m[g],ip:m[g+1],port:m[g+2]});return f},a.parseImageAttributes=function(d){return d.split(" ").map(function(f){return f.substring(1,f.length-1).split(",").reduce(u,{})})},a.parseSimulcastStreamList=function(d){return d.split(";").map(function(f){return f.split(",").map(function(m){var g,v=!1;return m[0]!=="~"?g=e(m):(g=e(m.substring(1,m.length)),v=!0),{scid:g,paused:v}})})}})(fh)),fh}var ph,ey;function iA(){if(ey)return ph;ey=1;var a=xf(),e=/%[sdv%]/g,n=function(u){var d=1,f=arguments,m=f.length;return u.replace(e,function(g){if(d>=m)return g;var v=f[d];switch(d+=1,g){case"%%":return"%";case"%s":return String(v);case"%d":return Number(v);case"%v":return""}})},s=function(u,d,f){var m=d.format instanceof Function?d.format(d.push?f:f[d.name]):d.format,g=[u+"="+m];if(d.names)for(var v=0;v<d.names.length;v+=1){var S=d.names[v];d.name?g.push(f[d.name][S]):g.push(f[d.names[v]])}else g.push(f[d.name]);return n.apply(null,g)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];return ph=function(u,d){d=d||{},u.version==null&&(u.version=0),u.name==null&&(u.name=" "),u.media.forEach(function(v){v.payloads==null&&(v.payloads="")});var f=d.outerOrder||o,m=d.innerOrder||l,g=[];return f.forEach(function(v){a[v].forEach(function(S){S.name in u&&u[S.name]!=null?g.push(s(v,S,u)):S.push in u&&u[S.push]!=null&&u[S.push].forEach(function(T){g.push(s(v,S,T))})})}),u.media.forEach(function(v){g.push(s("m",a.m[0],v)),m.forEach(function(S){a[S].forEach(function(T){T.name in v&&v[T.name]!=null?g.push(s(S,T,v)):T.push in v&&v[T.push]!=null&&v[T.push].forEach(function(x){g.push(s(S,T,x))})})})}),g.join(`\r
`)+`\r
`},ph}var ty;function aA(){if(ty)return wn;ty=1;var a=nA(),e=iA(),n=xf();return wn.grammar=n,wn.write=e,wn.parse=a.parse,wn.parseParams=a.parseParams,wn.parseFmtpConfig=a.parseFmtpConfig,wn.parsePayloads=a.parsePayloads,wn.parseRemoteCandidates=a.parseRemoteCandidates,wn.parseImageAttributes=a.parseImageAttributes,wn.parseSimulcastStreamList=a.parseSimulcastStreamList,wn}var ea=aA();function Ef(a,e,n){var s,o,l;e===void 0&&(e=50),n===void 0&&(n={});var u=(s=n.isImmediate)!=null&&s,d=(o=n.callback)!=null&&o,f=n.maxWait,m=Date.now(),g=[];function v(){if(f!==void 0){var T=Date.now()-m;if(T+e>=f)return f-T}return e}var S=function(){var T=[].slice.call(arguments),x=this;return new Promise(function(E,D){var M=u&&l===void 0;if(l!==void 0&&clearTimeout(l),l=setTimeout(function(){if(l=void 0,m=Date.now(),!u){var P=a.apply(x,T);d&&d(P),g.forEach(function(A){return(0,A.resolve)(P)}),g=[]}},v()),M){var Y=a.apply(x,T);return d&&d(Y),E(Y)}g.push({resolve:E,reject:D})})};return S.cancel=function(T){l!==void 0&&clearTimeout(l),g.forEach(function(x){return(0,x.reject)(T)}),g=[]},S}const sA=.7,rA=20,Ps={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class ny extends Gn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;super(),this.log=Ce,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Ef(o=>C(this,void 0,void 0,function*(){this.emit(Ps.NegotiationStarted);try{yield this.createAndSendOffer()}catch(l){if(o)o(l);else throw l}}),rA),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ki((s=n.loggerName)!==null&&s!==void 0?s:Dn.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC(),this.offerLock=new Bt}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var s;n.candidate&&((s=this.onIceCandidate)===null||s===void 0||s.call(this,n.candidate))},e.onicecandidateerror=n=>{var s;(s=this.onIceCandidateError)===null||s===void 0||s.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,n)},e.ontrack=n=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return C(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,n){return C(this,void 0,void 0,function*(){var s;if(e.type==="answer"&&this.latestOfferId>0&&n>0&&n!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:n,latestOfferId:this.latestOfferId})),!1;let o;if(e.type==="offer"){let{stereoMids:l,nackMids:u}=oA(e);this.remoteStereoMids=l,this.remoteNackMids=u}else if(e.type==="answer"){const l=ea.parse((s=e.sdp)!==null&&s!==void 0?s:"");l.media.forEach(u=>{const d=wf(u.mid);u.type==="audio"&&this.trackBitrates.some(f=>{if(!f.transceiver||d!=f.transceiver.mid)return!1;let m=0;if(u.rtp.some(v=>v.codec.toUpperCase()===f.codec.toUpperCase()?(m=v.payload,!0):!1),m===0)return!0;let g=!1;for(const v of u.fmtp)if(v.payload===m){v.config=v.config.split(";").filter(S=>!S.includes("maxaveragebitrate")).join(";"),f.maxbr>0&&(v.config+=";maxaveragebitrate=".concat(f.maxbr*1e3)),g=!0;break}return g||f.maxbr>0&&u.fmtp.push({payload:m,config:"maxaveragebitrate=".concat(f.maxbr*1e3)}),!0})}),o=ea.write(l)}return yield this.setMungedSDP(e,o,!0),this.pendingCandidates.forEach(l=>{this.pc.addIceCandidate(l)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Ps.NegotiationComplete),e.sdp&&ea.parse(e.sdp).media.forEach(u=>{u.type==="video"&&this.emit(Ps.RTPVideoPayloadTypes,u.rtp)})),!0})}createAndSendOffer(e){return C(this,void 0,void 0,function*(){var n;const s=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const d=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&d)yield this._pc.setRemoteDescription(d);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const o=this.latestOfferId+1;this.latestOfferId=o;const l=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:l.sdp},this.logContext));const u=ea.parse((n=l.sdp)!==null&&n!==void 0?n:"");if(u.media.forEach(d=>{ay(d),d.type==="audio"?iy(d,["all"],[]):d.type==="video"&&this.trackBitrates.some(f=>{if(!d.msid||!f.cid||!d.msid.includes(f.cid))return!1;let m=0;if(d.rtp.some(v=>v.codec.toUpperCase()===f.codec.toUpperCase()?(m=v.payload,!0):!1),m===0||(Mn(f.codec)&&!Pa()&&this.ensureVideoDDExtensionForSVC(d,u),!Mn(f.codec)))return!0;const g=Math.round(f.maxbr*sA);for(const v of d.fmtp)if(v.payload===m){v.config.includes("x-google-start-bitrate")||(v.config+=";x-google-start-bitrate=".concat(g));break}return!0})}),this.latestOfferId>o){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:o}));return}yield this.setMungedSDP(l,ea.write(u)),this.onOffer(l,this.latestOfferId)}finally{s()}})}createAndSetAnswer(){return C(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),s=ea.parse((e=n.sdp)!==null&&e!==void 0?e:"");return s.media.forEach(o=>{ay(o),o.type==="audio"&&iy(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,ea.write(s)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTransceiverOfKind(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new St("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new St("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return C(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const s=new Map,o=new Map;if((yield this._pc.getStats()).forEach(d=>{switch(d.type){case"transport":n=d.selectedCandidatePairId;break;case"candidate-pair":n===""&&d.selected&&(n=d.id),s.set(d.id,d);break;case"remote-candidate":o.set(d.id,"".concat(d.address,":").concat(d.port));break}}),n==="")return;const u=(e=s.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(u!==void 0)return o.get(u)})}setMungedSDP(e,n,s){return C(this,void 0,void 0,function*(){if(n){const o=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(s?"remote":"local"," description"),this.logContext),s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(l){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:l,sdp:n})),e.sdp=o}}try{s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let l="unknown error";o instanceof Error?l=o.message:typeof o=="string"&&(l=o);const u={error:l,sdp:e.sdp};throw!s&&this.pc.remoteDescription&&(u.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:u})),new Lh(l)}})}ensureVideoDDExtensionForSVC(e,n){var s,o;if(!((s=e.ext)===null||s===void 0?void 0:s.some(u=>u.uri===q0))){if(this.ddExtID===0){let u=0;n.media.forEach(d=>{var f;d.type==="video"&&((f=d.ext)===null||f===void 0||f.forEach(m=>{m.value>u&&(u=m.value)}))}),this.ddExtID=u+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:q0})}}}function iy(a,e,n){const s=wf(a.mid);let o=0;a.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),o>0&&(a.rtcpFb||(a.rtcpFb=[]),n.includes(s)&&!a.rtcpFb.some(l=>l.payload===o&&l.type==="nack")&&a.rtcpFb.push({payload:o,type:"nack"}),(e.includes(s)||e.length===1&&e[0]==="all")&&a.fmtp.some(l=>l.payload===o?(l.config.includes("stereo=1")||(l.config+=";stereo=1"),!0):!1))}function oA(a){var e;const n=[],s=[],o=ea.parse((e=a.sdp)!==null&&e!==void 0?e:"");let l=0;return o.media.forEach(u=>{var d;const f=wf(u.mid);u.type==="audio"&&(u.rtp.some(m=>m.codec==="opus"?(l=m.payload,!0):!1),!((d=u.rtcpFb)===null||d===void 0)&&d.some(m=>m.payload===l&&m.type==="nack")&&s.push(f),u.fmtp.some(m=>m.payload===l?(m.config.includes("sprop-stereo=1")&&n.push(f),!0):!1))}),{stereoMids:n,nackMids:s}}function ay(a){if(a.connection){const e=a.connection.ip.indexOf(":")>=0;(a.connection.version===4&&e||a.connection.version===6&&!e)&&(a.connection.ip="0.0.0.0",a.connection.version=4)}}function wf(a){return typeof a=="number"?a.toFixed(0):a}const Hh="vp8",lA={audioPreset:Ih.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:kf.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Hh,backupCodec:!0,preConnectBuffer:!1},IS={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},jS={deviceId:{ideal:"default"},resolution:eo.h720.resolution},cA={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new z_,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!1},_f={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var ot;(function(a){a[a.NEW=0]="NEW",a[a.CONNECTING=1]="CONNECTING",a[a.CONNECTED=2]="CONNECTED",a[a.FAILED=3]="FAILED",a[a.CLOSING=4]="CLOSING",a[a.CLOSED=5]="CLOSED"})(ot||(ot={}));class uA{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,s){var o;this.peerConnectionTimeout=_f.peerConnectionTimeout,this.log=Ce,this.updateState=()=>{var l,u;const d=this.state,f=this.requiredTransports.map(m=>m.getConnectionState());f.every(m=>m==="connected")?this.state=ot.CONNECTED:f.some(m=>m==="failed")?this.state=ot.FAILED:f.some(m=>m==="connecting")?this.state=ot.CONNECTING:f.every(m=>m==="closed")?this.state=ot.CLOSED:f.some(m=>m==="closed")?this.state=ot.CLOSING:f.every(m=>m==="new")&&(this.state=ot.NEW),d!==this.state&&(this.log.debug("pc state change: from ".concat(ot[d]," to ").concat(ot[this.state]),this.logContext),(l=this.onStateChange)===null||l===void 0||l.call(this,this.state,this.publisher.getConnectionState(),(u=this.subscriber)===null||u===void 0?void 0:u.getConnectionState()))},this.log=ki((o=s.loggerName)!==null&&o!==void 0?o:Dn.PCManager),this.loggerOptions=s,this.isPublisherConnectionRequired=n!=="subscriber-primary",this.isSubscriberConnectionRequired=n==="subscriber-primary",this.publisher=new ny(e,s),n!=="publisher-only"&&(this.subscriber=new ny(e,s),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=l=>{var u;(u=this.onIceCandidate)===null||u===void 0||u.call(this,l,An.SUBSCRIBER)},this.subscriber.onDataChannel=l=>{var u;(u=this.onDataChannel)===null||u===void 0||u.call(this,l)},this.subscriber.onTrack=l=>{var u;(u=this.onTrack)===null||u===void 0||u.call(this,l)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=l=>{var u;(u=this.onIceCandidate)===null||u===void 0||u.call(this,l,An.PUBLISHER)},this.publisher.onTrack=l=>{var u;(u=this.onTrack)===null||u===void 0||u.call(this,l)},this.publisher.onOffer=(l,u)=>{var d;(d=this.onPublisherOffer)===null||d===void 0||d.call(this,l,u)},this.state=ot.NEW,this.connectionLock=new Bt,this.remoteOfferLock=new Bt}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,n){return this.publisher.setRemoteDescription(e,n)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return C(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const n=this.publisher;for(const s of n.getSenders())try{n.canRemoveTrack()&&n.removeTrack(s)}catch(o){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:o}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return C(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return C(this,void 0,void 0,function*(){var s;n===An.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(s=this.subscriber)===null||s===void 0?void 0:s.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,n){return C(this,void 0,void 0,function*(){var s,o,l;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(s=this.subscriber)===null||s===void 0?void 0:s.getSignallingState().toString()}));const u=yield this.remoteOfferLock.lock();try{return(yield(o=this.subscriber)===null||o===void 0?void 0:o.setRemoteDescription(e,n))?yield(l=this.subscriber)===null||l===void 0?void 0:l.createAndSetAnswer():void 0}finally{u()}})}updateConfiguration(e,n){var s;this.publisher.setConfiguration(e),(s=this.subscriber)===null||s===void 0||s.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return C(this,void 0,void 0,function*(){var s;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((s=this.requiredTransports)===null||s===void 0?void 0:s.map(l=>this.ensureTransportConnected(l,e,n)))}finally{o()}})}negotiate(e){return C(this,void 0,void 0,function*(){return new Promise((n,s)=>C(this,void 0,void 0,function*(){const o=setTimeout(()=>{s("negotiation timed out")},this.peerConnectionTimeout),l=()=>{clearTimeout(o),s("negotiation aborted")};e.signal.addEventListener("abort",l),this.publisher.once(Ps.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Ps.NegotiationComplete,()=>{clearTimeout(o),n()})}),yield this.publisher.negotiate(u=>{clearTimeout(o),s(u)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTransceiverOfKind(e,n){return this.publisher.addTransceiverOfKind(e,n)}getMidForReceiver(e){const s=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(o=>o.receiver===e);return s==null?void 0:s.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===An.PUBLISHER?this.publisher.getConnectedAddress():e===An.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return C(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return(function*(){if(s.getConnectionState()!=="connected")return new Promise((f,m)=>C(l,void 0,void 0,function*(){const g=()=>{this.log.warn("abort transport connection",this.logContext),Dt.clearTimeout(v),m(new Oe("room connection has been cancelled",Se.Cancelled))};o!=null&&o.signal.aborted&&g(),o==null||o.signal.addEventListener("abort",g);const v=Dt.setTimeout(()=>{o==null||o.signal.removeEventListener("abort",g),m(new Oe("could not establish pc connection",Se.InternalError))},u);for(;this.state!==ot.CONNECTED;)if(yield Pt(50),o!=null&&o.signal.aborted){m(new Oe("room connection has been cancelled",Se.Cancelled));return}Dt.clearTimeout(v),o==null||o.signal.removeEventListener("abort",g),f()}))})()})}}const US=5e3,dA=3e4;class ze{static fetchRegionSettings(e,n,s){return C(this,void 0,void 0,function*(){const o=yield ze.fetchLock.lock();try{const l=yield fetch("".concat(hA(e),"/regions"),{headers:{authorization:"Bearer ".concat(n)},signal:s});if(l.ok){const u=DR(l.headers),d=u?u*1e3:US;return{regionSettings:yield l.json(),updatedAtInMs:Date.now(),maxAgeInMs:d}}else throw new Oe("Could not fetch region settings: ".concat(l.statusText),l.status===401?Se.NotAllowed:Se.InternalError,l.status)}catch(l){throw l instanceof Oe?l:s!=null&&s.aborted?new Oe("Region fetching was aborted",Se.Cancelled):new Oe("Could not fetch region settings, ".concat(l instanceof Error?"".concat(l.name,": ").concat(l.message):l),Se.ServerUnreachable,500)}finally{o()}})}static scheduleRefetch(e,n,s){return C(this,void 0,void 0,function*(){const o=ze.settingsTimeouts.get(e.hostname);clearTimeout(o),ze.settingsTimeouts.set(e.hostname,setTimeout(()=>C(this,void 0,void 0,function*(){try{const l=yield ze.fetchRegionSettings(e,n);ze.updateCachedRegionSettings(e,n,l)}catch(l){if(l instanceof Oe&&l.reason===Se.NotAllowed){Ce.debug("token is not valid, cancelling auto region refresh");return}Ce.debug("auto refetching of region settings failed",{error:l}),ze.scheduleRefetch(e,n,s)}}),s))})}static updateCachedRegionSettings(e,n,s){ze.cache.set(e.hostname,s),ze.scheduleRefetch(e,n,s.maxAgeInMs)}static stopRefetch(e){const n=ze.settingsTimeouts.get(e);n&&(clearTimeout(n),ze.settingsTimeouts.delete(e))}static scheduleCleanup(e){let n=ze.connectionTrackers.get(e);n&&(n.cleanupTimeout&&clearTimeout(n.cleanupTimeout),n.cleanupTimeout=setTimeout(()=>{const s=ze.connectionTrackers.get(e);s&&s.connectionCount===0&&(Ce.debug("stopping region refetch after disconnect delay",{hostname:e}),ze.stopRefetch(e)),s&&(s.cleanupTimeout=void 0)},dA))}static cancelCleanup(e){const n=ze.connectionTrackers.get(e);n!=null&&n.cleanupTimeout&&(clearTimeout(n.cleanupTimeout),n.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let n=ze.connectionTrackers.get(e);n||(n={connectionCount:0},ze.connectionTrackers.set(e,n)),n.connectionCount++,ze.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,n=ze.connectionTrackers.get(e);n&&(n.connectionCount=Math.max(0,n.connectionCount-1),n.connectionCount===0&&ze.scheduleCleanup(e))}constructor(e,n){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return rc(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return C(this,void 0,void 0,function*(){return ze.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return C(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let n=ze.cache.get(this.serverUrl.hostname);(!n||Date.now()-n.updatedAtInMs>n.maxAgeInMs)&&(n=yield this.fetchRegionSettings(e),ze.updateCachedRegionSettings(this.serverUrl,this.token,n));const s=n.regionSettings.regions.filter(o=>!this.attemptedRegions.find(l=>l.url===o.url));if(s.length>0){const o=s[0];return this.attemptedRegions.push(o),Ce.debug("next region: ".concat(o.region)),o.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){ze.updateCachedRegionSettings(this.serverUrl,this.token,e)}}ze.cache=new Map;ze.settingsTimeouts=new Map;ze.connectionTrackers=new Map;ze.fetchLock=new Bt;function hA(a){return"".concat(a.protocol.replace("ws","http"),"//").concat(a.host,"/settings")}class ct extends Error{constructor(e,n,s){super(n),this.code=e,this.message=sy(n,ct.MAX_MESSAGE_BYTES),this.data=s?sy(s,ct.MAX_DATA_BYTES):void 0}static fromProto(e){return new ct(e.code,e.message,e.data)}toProto(){return new Mb({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new ct(ct.ErrorCode[e],ct.ErrorMessage[e],n)}}ct.MAX_MESSAGE_BYTES=256;ct.MAX_DATA_BYTES=15360;ct.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};ct.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const BS=15360;function Rf(a){return new TextEncoder().encode(a).length}function sy(a,e){if(Rf(a)<=e)return a;let n=0,s=a.length;const o=new TextEncoder;for(;n<s;){const l=Math.floor((n+s+1)/2);o.encode(a.slice(0,l)).length<=e?n=l:s=l-1}return a.slice(0,n)}const Af=2e3;function Tc(a,e){if(!e)return 0;let n,s;return"bytesReceived"in a?(n=a.bytesReceived,s=e.bytesReceived):"bytesSent"in a&&(n=a.bytesSent,s=e.bytesSent),n===void 0||s===void 0||a.timestamp===void 0||e.timestamp===void 0?0:(n-s)*8*1e3/(a.timestamp-e.timestamp)}const Mf=typeof MediaRecorder<"u";class fA{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const mA=Mf?MediaRecorder:fA;class pA extends mA{constructor(e,n){if(!Mf)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),n);let s,o;const l=()=>o===void 0,u=()=>{this.removeEventListener("dataavailable",s),this.removeEventListener("stop",u),this.removeEventListener("error",d),o==null||o.close(),o=void 0},d=f=>{o==null||o.error(f),this.removeEventListener("dataavailable",s),this.removeEventListener("stop",u),this.removeEventListener("error",d),o=void 0};this.byteStream=new ReadableStream({start:f=>{o=f,s=m=>C(this,void 0,void 0,function*(){let g;if(m.data.arrayBuffer){const v=yield m.data.arrayBuffer();g=new Uint8Array(v)}else if(m.data.byteArray)g=m.data.byteArray;else throw new Error("no data available!");l()||f.enqueue(g)}),this.addEventListener("dataavailable",s)},cancel:()=>{u()}}),this.addEventListener("stop",u),this.addEventListener("error",d)}}function gA(){return Mf}const vA=1e3,yA=1e4;class zS extends Z{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,n,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=arguments.length>4?arguments[4]:void 0;super(e,n,l),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Ef(()=>C(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>C(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ie.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new Bt,this.pauseUpstreamLock=new Bt,this.trackChangeLock=new Bt,this.trackChangeLock.lock().then(u=>C(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{u()}})),this._constraints=e.getConstraints(),s&&(this._constraints=s)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Z.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return C(this,void 0,void 0,function*(){var s;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(l=>{Ns(this._mediaStreamTrack,l)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(ws(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}this.sender&&((s=this.sender.transport)===null||s===void 0?void 0:s.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(l=>{ws(o??e,l)}))})}waitForDimensions(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vA;return(function*(){var s;if(e.kind===Z.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((s=Xt())===null||s===void 0?void 0:s.os)==="iOS"&&(yield Pt(10));const o=Date.now();for(;Date.now()-o<n;){const l=e.dimensions;if(l)return l;yield Pt(50)}throw new vi("unable to get track dimensions after timeout")})()})}setDeviceId(e){return C(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===sa(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),sa(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){if(e.source===Z.Source.ScreenShare)return;const{deviceId:s,groupId:o}=e._mediaStreamTrack.getSettings(),l=e.kind===Z.Kind.Audio?"audioinput":"videoinput";return n?wt.getInstance().normalizeDeviceId(l,s,o):s})()})}mute(){return C(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return C(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return C(this,void 0,void 0,function*(){const s=yield this.trackChangeLock.lock();try{if(!this.sender)throw new vi("unable to replace an unpublished track");let o,l;return typeof n=="boolean"?o=n:n!==void 0&&(o=n.userProvidedTrack,l=n.stopProcessor),this.providedByUser=o??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),l&&this.processor&&(yield this.internalStopProcessor()),this}finally{s()}})}restart(e){return C(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:s,facingMode:o}=e,l=q_(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const u={audio:!1,video:!1};this.kind===Z.Kind.Video?u.video=s||o?{deviceId:s,facingMode:o}:!0:u.audio=s?Object.assign({deviceId:s},l):!0,this.attachedElements.forEach(m=>{Ns(this.mediaStreamTrack,m)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const f=(yield navigator.mediaDevices.getUserMedia(u)).getTracks()[0];return this.kind===Z.Kind.Video&&(yield f.applyConstraints(l)),f.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(f),this._constraints=e,this.emit(ie.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ie.Muted:ie.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return C(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),RS()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return C(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ie.UpstreamPaused,this);const s=Xt();if((s==null?void 0:s.name)==="Safari"&&Vn(s.version,"12.0")<0)throw new Sf("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return C(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ie.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return C(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return C(this,arguments,void 0,function(n){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var l;const u=yield s.trackChangeLock.lock();try{s.log.debug("setting up processor",s.logContext);const d=document.createElement(s.kind),f={kind:s.kind,track:s._mediaStreamTrack,element:d,audioContext:s.audioContext};if(yield n.init(f),s.log.debug("processor initialized",s.logContext),s.processor&&(yield s.internalStopProcessor()),s.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(ws(s._mediaStreamTrack,d),d.muted=!0,d.play().catch(m=>{m instanceof DOMException&&m.name==="AbortError"?(s.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},s.logContext),{error:m})),setTimeout(()=>{d.play().catch(g=>{s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{err:g}))})},100)):s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{error:m}))}),s.processor=n,s.processorElement=d,s.processor.processedTrack){for(const m of s.attachedElements)m!==s.processorElement&&o&&(Ns(s._mediaStreamTrack,m),ws(s.processor.processedTrack,m));yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(s.processor.processedTrack)}s.emit(ie.TrackProcessorUpdate,s.processor)}finally{u()}})()})}getProcessor(){return this.processor}stopProcessor(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){const s=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(n)}finally{s()}})()})}internalStopProcessor(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var s,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(s=e.processor.processedTrack)===null||s===void 0||s.stop(),yield e.processor.destroy(),e.processor=void 0,n||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(ie.TrackProcessorUpdate))})()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!gA()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let n="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(n)||(n="video/mp4"),this.localTrackRecorder=new pA(this,{mimeType:n})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},yA)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class oc extends zS{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;super(e,Z.Kind.Audio,n,s,l),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>C(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let u;try{u=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}u&&this.prevStats&&(this._currentBitrate=Tc(u,this.prevStats)),this.prevStats=u}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(ie.AudioTrackFeatureUpdate,this,Et.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(ie.AudioTrackFeatureUpdate,this,Et.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Z.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const s=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==sa(this._constraints.deviceId);return this.source===Z.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||s)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return C(this,void 0,void 0,function*(){let n;if(e){const s=Tf({audio:e});typeof s.audio!="boolean"&&(n=s.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return C(this,void 0,void 0,function*(){const s=yield n.restart.call(this,e);return this.checkForSilence(),s})}startMonitor(){Jt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Af)))}setProcessor(e){return C(this,void 0,void 0,function*(){var n;const s=yield this.trackChangeLock.lock();try{if(!Fn()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(ie.TrackProcessorUpdate,this.processor)}finally{s()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return C(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let s;return n.forEach(o=>{o.type==="outbound-rtp"&&(s={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),s})}checkForSilence(){return C(this,void 0,void 0,function*(){const e=yield OS(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(ie.AudioSilenceDetected)),e})}}function bA(a,e,n){switch(a.kind){case"audio":return new oc(a,e,!1,void 0,n);case"video":return new lc(a,e,!1,n);default:throw new vi("unsupported track type: ".concat(a.kind))}}const SA=Object.values(eo),kA=Object.values(jh),TA=Object.values(kf),CA=[eo.h180,eo.h360],xA=[jh.h180,jh.h360],EA=a=>[{scaleResolutionDownBy:2,fps:a.encoding.maxFramerate}].map(n=>{var s,o;return new Qe(Math.floor(a.width/n.scaleResolutionDownBy),Math.floor(a.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(a.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((s=a.encoding.maxFramerate)!==null&&s!==void 0?s:30)/((o=n.fps)!==null&&o!==void 0?o:30))))),n.fps,a.encoding.priority)}),Gh=["q","h","f"];function Yh(a,e,n,s){var o,l;let u=s==null?void 0:s.videoEncoding;a&&(u=s==null?void 0:s.screenShareEncoding);const d=s==null?void 0:s.simulcast,f=s==null?void 0:s.scalabilityMode,m=s==null?void 0:s.videoCodec;if(!u&&!d&&!f||!e||!n)return[{}];u||(u=_A(a,e,n,m),Ce.debug("using video encoding",u));const g=u.maxFramerate,v=new Qe(e,n,u.maxBitrate,u.maxFramerate,u.priority);if(f&&Mn(m)){const x=new qS(f),E=[];if(x.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(f));const D=Xt();if(to()||Fn()||(D==null?void 0:D.name)==="Chrome"&&Vn(D==null?void 0:D.version,"113")<0){const M=x.suffix=="h"?2:3,Y=kR(D);for(let P=0;P<x.spatial;P+=1)E.push({rid:Gh[2-P],maxBitrate:u.maxBitrate/Math.pow(M,P),maxFramerate:v.encoding.maxFramerate,scaleResolutionDownBy:Y?Math.pow(2,P):void 0});E[0].scalabilityMode=f}else E.push({maxBitrate:u.maxBitrate,maxFramerate:v.encoding.maxFramerate,scalabilityMode:f});return v.encoding.priority&&(E[0].priority=v.encoding.priority,E[0].networkPriority=v.encoding.priority),Ce.debug("using svc encoding",{encodings:E}),E}if(!d)return[u];let S=[];a?S=(o=oy(s==null?void 0:s.screenShareSimulcastLayers))!==null&&o!==void 0?o:ry(a,v):S=(l=oy(s==null?void 0:s.videoSimulcastLayers))!==null&&l!==void 0?l:ry(a,v);let T;if(S.length>0){const x=S[0];S.length>1&&([,T]=S);const E=Math.max(e,n);if(E>=960&&T)return gh(e,n,[x,T,v],g);if(E>=480)return gh(e,n,[x,v],g)}return gh(e,n,[v])}function wA(a,e,n){var s,o,l,u;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Ce.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const d=a.mediaStreamTrack.getSettings(),f=(s=d.width)!==null&&s!==void 0?s:(o=a.dimensions)===null||o===void 0?void 0:o.width,m=(l=d.height)!==null&&l!==void 0?l:(u=a.dimensions)===null||u===void 0?void 0:u.height;return a.source===Z.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Yh(a.source===Z.Source.ScreenShare,f,m,n)}function _A(a,e,n,s){const o=RA(a,e,n);let{encoding:l}=o[0];const u=Math.max(e,n);for(let d=0;d<o.length;d+=1){const f=o[d];if(l=f.encoding,f.width>=u)break}if(s)switch(s){case"av1":case"h265":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.7;break;case"vp9":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.85;break}return l}function RA(a,e,n){if(a)return TA;const s=e>n?e/n:n/e;return Math.abs(s-16/9)<Math.abs(s-4/3)?SA:kA}function ry(a,e){if(a)return EA(e);const{width:n,height:s}=e,o=n>s?n/s:s/n;return Math.abs(o-16/9)<Math.abs(o-4/3)?CA:xA}function gh(a,e,n,s){const o=[];if(n.forEach((l,u)=>{if(u>=Gh.length)return;const d=Math.min(a,e),m={rid:Gh[u],scaleResolutionDownBy:Math.max(1,d/Math.min(l.width,l.height)),maxBitrate:l.encoding.maxBitrate},g=s&&l.encoding.maxFramerate?Math.min(s,l.encoding.maxFramerate):l.encoding.maxFramerate;g&&(m.maxFramerate=g);const v=Da()||u===0;l.encoding.priority&&v&&(m.priority=l.encoding.priority,m.networkPriority=l.encoding.priority),o.push(m)}),Fn()&&MS()==="ios"){let l;o.forEach(d=>{l?d.maxFramerate&&d.maxFramerate>l&&(l=d.maxFramerate):l=d.maxFramerate});let u=!0;o.forEach(d=>{var f;d.maxFramerate!=l&&(u&&(u=!1,Ce.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Ce.info('Setting framerate of encoding "'.concat((f=d.rid)!==null&&f!==void 0?f:"",'" to ').concat(l)),d.maxFramerate=l)})}return o}function oy(a){if(a)return a.sort((e,n)=>{const{encoding:s}=e,{encoding:o}=n;return s.maxBitrate>o.maxBitrate?1:s.maxBitrate<o.maxBitrate?-1:s.maxBitrate===o.maxBitrate&&s.maxFramerate&&o.maxFramerate?s.maxFramerate>o.maxFramerate?1:-1:0})}class qS{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function AA(a){return a.source===Z.Source.ScreenShare||a.constraints.height&&sa(a.constraints.height)>=1080?"maintain-resolution":"balanced"}const MA=5e3;class lc extends zS{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,Z.Kind.Video,n,s,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>C(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(f){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:f}));return}const u=new Map(l.map(f=>[f.rid,f])),d=l.some(f=>f.qualityLimitationReason==="cpu");if(d!==this.isCpuConstrained&&(this.isCpuConstrained=d,this.isCpuConstrained&&this.emit(ie.CpuConstrained)),this.prevStats){let f=0;u.forEach((m,g)=>{var v;const S=(v=this.prevStats)===null||v===void 0?void 0:v.get(g);f+=Tc(m,S)}),this._currentBitrate=f}this.prevStats=u}),this.senderLock=new Bt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Jt())return;const s=(n=this.sender)===null||n===void 0?void 0:n.getParameters();s&&(this.encodings=s.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Af))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return C(this,void 0,void 0,function*(){var n,s,o,l,u;yield e.pauseUpstream.call(this);try{for(var d=!0,f=gi(this.simulcastCodecs.values()),m;m=yield f.next(),n=m.done,!n;d=!0)l=m.value,d=!1,yield(u=l.sender)===null||u===void 0?void 0:u.replaceTrack(null)}catch(g){s={error:g}}finally{try{!d&&!n&&(o=f.return)&&(yield o.call(f))}finally{if(s)throw s.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return C(this,void 0,void 0,function*(){var n,s,o,l,u;yield e.resumeUpstream.call(this);try{for(var d=!0,f=gi(this.simulcastCodecs.values()),m;m=yield f.next(),n=m.done,!n;d=!0){l=m.value,d=!1;const g=l;yield(u=g.sender)===null||u===void 0?void 0:u.replaceTrack(g.mediaStreamTrack)}}catch(g){s={error:g}}finally{try{!d&&!n&&(o=f.return)&&(yield o.call(f))}finally{if(s)throw s.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Z.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return C(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===Z.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return C(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],s=yield this.sender.getStats();return s.forEach(o=>{var l;if(o.type==="outbound-rtp"){const u={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(l=o.rid)!==null&&l!==void 0?l:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},d=s.get(o.remoteId);d&&(u.jitter=d.jitter,u.packetsLost=d.packetsLost,u.roundTripTime=d.roundTripTime),n.push(u)}}),n.sort((o,l)=>{var u,d;return((u=l.frameWidth)!==null&&u!==void 0?u:0)-((d=o.frameWidth)!==null&&d!==void 0?d:0)}),n})}setPublishingQuality(e){const n=[];for(let s=ln.LOW;s<=ln.HIGH;s+=1)n.push(new gf({quality:s,enabled:s<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Mn(this.codec),n)}restartTrack(e){return C(this,void 0,void 0,function*(){var n,s,o,l,u;let d;if(e){const v=Tf({video:e});typeof v.video!="boolean"&&(d=v.video)}yield this.restart(d),this.isCpuConstrained=!1;try{for(var f=!0,m=gi(this.simulcastCodecs.values()),g;g=yield m.next(),n=g.done,!n;f=!0){l=g.value,f=!1;const v=l;v.sender&&((u=v.sender.transport)===null||u===void 0?void 0:u.state)!=="closed"&&(v.mediaStreamTrack=this.mediaStreamTrack.clone(),yield v.sender.replaceTrack(v.mediaStreamTrack))}}catch(v){s={error:v}}finally{try{!f&&!n&&(o=m.return)&&(yield o.call(m))}finally{if(s)throw s.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return C(this,arguments,void 0,function(s){var o=this;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var u,d,f,m,g,v;if(yield n.setProcessor.call(o,s,l),!((g=o.processor)===null||g===void 0)&&g.processedTrack)try{for(var S=!0,T=gi(o.simulcastCodecs.values()),x;x=yield T.next(),u=x.done,!u;S=!0)m=x.value,S=!1,yield(v=m.sender)===null||v===void 0?void 0:v.replaceTrack(o.processor.processedTrack)}catch(E){d={error:E}}finally{try{!S&&!u&&(f=T.return)&&(yield f.call(T))}finally{if(d)throw d.error}}})()})}setDegradationPreference(e){return C(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const s={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,s),s}setSimulcastTrackSender(e,n){const s=this.simulcastCodecs.get(e);s&&(s.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},MA))}setPublishingCodecs(e){return C(this,void 0,void 0,function*(){var n,s,o,l,u,d,f;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Mn(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const m=[];try{for(n=!0,s=gi(e);o=yield s.next(),l=o.done,!l;n=!0){f=o.value,n=!1;const g=f;if(!this.codec||this.codec===g.codec)yield this.setPublishingLayers(Mn(g.codec),g.qualities);else{const v=this.simulcastCodecs.get(g.codec);if(this.log.debug("try setPublishingCodec for ".concat(g.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:v})),!v||!v.sender){for(const S of g.qualities)if(S.enabled){m.push(g.codec);break}}else v.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(g.codec),this.logContext),yield ly(v.sender,v.encodings,g.qualities,this.senderLock,Mn(g.codec),this.log,this.logContext))}}}catch(g){u={error:g}}finally{try{!n&&!l&&(d=s.return)&&(yield d.call(s))}finally{if(u)throw u.error}}return m})}setPublishingLayers(e,n){return C(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:n}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:n})),!(!this.sender||!this.encodings)&&(yield ly(this.sender,this.encodings,n,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return C(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const n=this.sender.getParameters();n.encodings=n.encodings.map((s,o)=>{var l;return Object.assign(Object.assign({},s),{active:o===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((l=this.mediaStreamTrack.getSettings().height)!==null&&l!==void 0?l:360)/360)),scalabilityMode:o===0&&Mn(this.codec)?"L1T3":void 0,maxFramerate:o===0?15:0,maxBitrate:o===0?s.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:n.encodings})),this.encodings=n.encodings,yield this.sender.setParameters(n)}catch(n){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:n})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return C(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),RS()&&this.isInBackground&&this.source===Z.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function ly(a,e,n,s,o,l,u){return C(this,void 0,void 0,function*(){const d=yield s.lock();l.debug("setPublishingLayersForSender",Object.assign(Object.assign({},u),{sender:a,qualities:n,senderEncodings:e}));try{const f=a.getParameters(),{encodings:m}=f;if(!m)return;if(m.length!==e.length){l.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},u),{encodings:m,senderEncodings:e}));return}let g=!1;!1&&m[0].scalabilityMode||(o&&n.some(T=>T.enabled)&&n.forEach(T=>T.enabled=!0),m.forEach((S,T)=>{var x;let E=(x=S.rid)!==null&&x!==void 0?x:"";E===""&&(E="q");const D=FS(E),M=n.find(Y=>Y.quality===D);M&&S.active!==M.enabled&&(g=!0,S.active=M.enabled,l.debug("setting layer ".concat(M.quality," to ").concat(S.active?"enabled":"disabled"),u),Da()&&(M.enabled?(S.scaleResolutionDownBy=e[T].scaleResolutionDownBy,S.maxBitrate=e[T].maxBitrate,S.maxFrameRate=e[T].maxFrameRate):(S.scaleResolutionDownBy=4,S.maxBitrate=10,S.maxFrameRate=2)))})),g&&(f.encodings=m,l.debug("setting encodings",Object.assign(Object.assign({},u),{encodings:f.encodings})),yield a.setParameters(f))}finally{d()}})}function FS(a){switch(a){case"f":return ln.HIGH;case"h":return ln.MEDIUM;case"q":return ln.LOW;default:return ln.HIGH}}function cy(a,e,n,s){if(!n)return[new ia({quality:ln.HIGH,width:a,height:e,bitrate:0,ssrc:0})];if(s){const o=n[0].scalabilityMode,l=new qS(o),u=[],d=l.suffix=="h"?1.5:2,f=l.suffix=="h"?2:3;for(let m=0;m<l.spatial;m+=1)u.push(new ia({quality:Math.min(ln.HIGH,l.spatial-1)-m,width:Math.ceil(a/Math.pow(d,m)),height:Math.ceil(e/Math.pow(d,m)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(f,m)):0,ssrc:0}));return u}return n.map(o=>{var l,u,d;const f=(l=o.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let m=FS((u=o.rid)!==null&&u!==void 0?u:"");return new ia({quality:m,width:Math.ceil(a/f),height:Math.ceil(e/f),bitrate:(d=o.maxBitrate)!==null&&d!==void 0?d:0,ssrc:0})})}const uy="_lossy",dy="_reliable",NA=2*1e3,vh="leave-reconnect",OA=3e4;var Sn;(function(a){a[a.New=0]="New",a[a.Connected=1]="Connected",a[a.Disconnected=2]="Disconnected",a[a.Reconnecting=3]="Reconnecting",a[a.Closed=4]="Closed"})(Sn||(Sn={}));class DA extends Gn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=_f.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Sn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Ce,this.reliableDataSequence=1,this.reliableMessageBuffer=new W0,this.reliableReceivedState=new tA(OA),this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=s=>C(this,[s],void 0,function(o){var l=this;let{channel:u}=o;return(function*(){if(u){if(u.label===dy)l.reliableDCSub=u;else if(u.label===uy)l.lossyDCSub=u;else return;l.log.debug("on data channel ".concat(u.id,", ").concat(u.label),l.logContext),u.onmessage=l.handleDataMessage}})()}),this.handleDataMessage=s=>C(this,void 0,void 0,function*(){var o,l,u,d,f;const m=yield this.dataProcessLock.lock();try{let g;if(s.data instanceof ArrayBuffer)g=s.data;else if(s.data instanceof Blob)g=yield s.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:s.data}));return}const v=Ut.fromBinary(new Uint8Array(g));if(v.sequence>0&&v.participantSid!==""){const S=this.reliableReceivedState.get(v.participantSid);if(S&&v.sequence<=S)return;this.reliableReceivedState.set(v.participantSid,v.sequence)}if(((o=v.value)===null||o===void 0?void 0:o.case)==="speaker")this.emit(re.ActiveSpeakersUpdate,v.value.value.speakers);else if(((l=v.value)===null||l===void 0?void 0:l.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const S=yield(u=this.e2eeManager)===null||u===void 0?void 0:u.handleEncryptedData(v.value.value.encryptedValue,v.value.value.iv,v.participantIdentity,v.value.value.keyIndex),T=_b.fromBinary(S.payload),x=new Ut({value:T.value,participantIdentity:v.participantIdentity,participantSid:v.participantSid});((d=x.value)===null||d===void 0?void 0:d.case)==="user"&&hy(x,x.value.value),this.emit(re.DataPacketReceived,x,v.value.value.encryptionType)}else((f=v.value)===null||f===void 0?void 0:f.case)==="user"&&hy(v,v.value.value),this.emit(re.DataPacketReceived,v,kt.NONE)}finally{m()}}),this.handleDataError=s=>{const l=s.currentTarget.maxRetransmits===0?"lossy":"reliable";if(s instanceof ErrorEvent&&s.error){const{error:u}=s.error;this.log.error("DataChannel error on ".concat(l,": ").concat(s.message),Object.assign(Object.assign({},this.logContext),{error:u}))}else this.log.error("Unknown DataChannel error on ".concat(l),Object.assign(Object.assign({},this.logContext),{event:s}))},this.handleBufferedAmountLow=s=>{const l=s.currentTarget.maxRetransmits===0?Re.LOSSY:Re.RELIABLE;this.updateAndEmitDCBufferStatus(l)},this.handleDisconnect=(s,o)=>{if(this._isClosed)return;this.log.warn("".concat(s," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const l=f=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(f,"ms. giving up"),this.logContext),this.emit(re.Disconnected),this.close()},u=Date.now()-this.reconnectStart;let d=this.getNextRetryDelay({elapsedMs:u,retryCount:this.reconnectAttempts});if(d===null){l(u);return}s===vh&&(d=0),this.log.debug("reconnecting in ".concat(d,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Dt.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),d)},this.waitForRestarted=()=>new Promise((s,o)=>{this.pcState===Sn.Connected&&s();const l=()=>{this.off(re.Disconnected,u),s()},u=()=>{this.off(re.Restarted,l),o()};this.once(re.Restarted,l),this.once(re.Disconnected,u)}),this.updateAndEmitDCBufferStatus=s=>{if(s===Re.RELIABLE){const l=this.dataChannelForKind(s);l&&this.reliableMessageBuffer.alignBufferedAmount(l.bufferedAmount)}const o=this.isBufferStatusLow(s);typeof o<"u"&&o!==this.dcBufferStatus.get(s)&&(this.dcBufferStatus.set(s,o),this.emit(re.DCBufferStatusChanged,o,s))},this.isBufferStatusLow=s=>{const o=this.dataChannelForKind(s);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>C(this,void 0,void 0,function*(){!this.url||!(yield fetch(no(this.url),{method:"HEAD"}).then(o=>o.ok).catch(()=>!1))||(this.log.info("detected network reconnected"),(this.client.currentState===We.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===We.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(Ma.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>C(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch(no(this.url),{method:"HEAD"}),Pt(4e3).then(()=>Promise.reject())])}catch{window.navigator.onLine===!1&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=ki((n=e.loggerName)!==null&&n!==void 0?n:Dn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Cf(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new Bt,this.dataProcessLock=new Bt,this.dcBufferStatus=new Map([[Re.LOSSY,!0],[Re.RELIABLE,!0]]),this.client.onParticipantUpdate=s=>this.emit(re.ParticipantUpdate,s),this.client.onConnectionQuality=s=>this.emit(re.ConnectionQualityUpdate,s),this.client.onRoomUpdate=s=>this.emit(re.RoomUpdate,s),this.client.onSubscriptionError=s=>this.emit(re.SubscriptionError,s),this.client.onSubscriptionPermissionUpdate=s=>this.emit(re.SubscriptionPermissionUpdate,s),this.client.onSpeakersChanged=s=>this.emit(re.SpeakersChanged,s),this.client.onStreamStateUpdate=s=>this.emit(re.StreamStateChanged,s),this.client.onRequestResponse=s=>this.emit(re.SignalRequestResponse,s)}get logContext(){var e,n,s,o,l,u;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.room)===null||o===void 0?void 0:o.sid,participant:(u=(l=this.latestJoinResponse)===null||l===void 0?void 0:l.participant)===null||u===void 0?void 0:u.identity,pID:this.participantSid}}join(e,n,s,o){return C(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=s,this.maxJoinAttempts=s.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const l=yield this.client.join(e,n,s,o);return this._isClosed=!1,this.latestJoinResponse=l,this.subscriberPrimary=l.subscriberPrimary,this.pcManager||(yield this.configure(l)),(!this.subscriberPrimary||l.fastPublish)&&this.negotiate().catch(u=>{Ce.error(u,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=l.clientConfiguration,this.emit(re.SignalConnected,l),l}catch(l){if(l instanceof Oe&&l.reason===Se.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,s,o);throw l}})}close(){return C(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(re.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return C(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=s=>{s&&(s.close(),s.onbufferedamountlow=null,s.onclose=null,s.onclosing=null,s.onerror=null,s.onmessage=null,s.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new W0,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return C(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new vi("a track with the same ID has already been published");return new Promise((n,s)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],s(new Oe("publication of local track timed out, no response from server",Se.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:l=>{clearTimeout(o),n(l)},reject:()=>{clearTimeout(o),s(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return C(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return C(this,void 0,void 0,function*(){var n,s;if(this.pcManager&&this.pcManager.currentState!==ot.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const o=this.makeRTCConfiguration(e);this.pcManager=new uA(o,this.options.singlePeerConnection?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(re.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(l,u)=>{this.client.sendIceCandidate(l,u)},this.pcManager.onPublisherOffer=(l,u)=>{this.client.sendOffer(l,u)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(l,u,d)=>C(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(l),this.logContext),["closed","disconnected","failed"].includes(u)&&(this.publisherConnectionPromise=void 0),l===ot.CONNECTED){const g=this.pcState===Sn.New;this.pcState=Sn.Connected,g&&this.emit(re.Connected,e)}else l===ot.FAILED&&(this.pcState===Sn.Connected||this.pcState===Sn.Reconnecting)&&(this.pcState=Sn.Disconnected,this.handleDisconnect("peerconnection failed",d==="failed"?Ma.RR_SUBSCRIBER_FAILED:Ma.RR_PUBLISHER_FAILED));const f=this.client.isDisconnected||this.client.currentState===We.RECONNECTING,m=[ot.FAILED,ot.CLOSING,ot.CLOSED].includes(l);f&&m&&!this._isClosed&&this.emit(re.Offline)}),this.pcManager.onTrack=l=>{l.streams.length!==0&&this.emit(re.MediaTrackAdded,l.track,l.streams[0],l.receiver)},PA((s=e.serverInfo)===null||s===void 0?void 0:s.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,n,s)=>C(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:s})),this.midToTrackId=s,yield this.pcManager.setPublisherAnswer(e,n))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=(e,n,s)=>C(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=n,!this.pcManager)return;this.midToTrackId=s;const o=yield this.pcManager.createSubscriberAnswerFromOffer(e,n);o&&this.client.sendAnswer(o,n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:s}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],s(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(re.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(re.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var n;this.token=e,(n=this.regionUrlProvider)===null||n===void 0||n.updateToken(e)},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(re.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(re.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var n;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(re.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var n,s;const o={direction:"recvonly"};for(let l=0;l<e.numAudios;l++)(n=this.pcManager)===null||n===void 0||n.addPublisherTransceiverOfKind("audio",o);for(let l=0;l<e.numVideos;l++)(s=this.pcManager)===null||s===void 0||s.addPublisherTransceiverOfKind("video",o);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",Ma.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:US,regionSettings:e.regions})),e.action){case As.DISCONNECT:this.emit(re.Disconnected,e==null?void 0:e.reason),this.close();break;case As.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(vh);break;case As.RESUME:this.handleDisconnect(vh)}}}makeRTCConfiguration(e){var n;const s=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),s.encodedInsertableStreams=!0),e.iceServers&&!s.iceServers){const o=[];e.iceServers.forEach(l=>{const u={urls:l.urls};l.username&&(u.username=l.username),l.credential&&(u.credential=l.credential),o.push(u)}),s.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Wr.ENABLED&&(s.iceTransportPolicy="relay"),s.sdpSemantics="unified-plan",s.continualGatheringPolicy="gather_continually",s}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(uy,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(dy,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,s){return C(this,void 0,void 0,function*(){if(Uh())return yield this.createTransceiverRTCRtpSender(e,n,s);if(Bh())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new St("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,s,o){return C(this,void 0,void 0,function*(){if(Uh())return this.createSimulcastTransceiverSender(e,n,s,o);if(Bh())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new St("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,s){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new St("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),la(e)&&(e.codec=n.videoCodec);const l={direction:"sendonly",streams:o};return s&&(l.sendEncodings=s),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,l)).sender})}createSimulcastTransceiverSender(e,n,s,o){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new St("publisher is closed");const l={direction:"sendonly"};o&&(l.sendEncodings=o);const u=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,l);if(s.videoCodec)return e.setSimulcastTrackSender(s.videoCodec,u.sender),u.sender})}createRTCRtpSender(e){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new St("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return C(this,void 0,void 0,function*(){var n,s,o;if(!this._isClosed){if(this.attemptingReconnect){Ce.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Wr.DISABLED||((o=(s=this.pcManager)===null||s===void 0?void 0:s.currentState)!==null&&o!==void 0?o:ot.NEW)===ot.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(l){this.reconnectAttempts+=1;let u=!0;l instanceof St?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:l})),u=!1):l instanceof xs||(this.fullReconnectOnNext=!0),u?this.handleDisconnect("reconnect",Ma.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(re.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return C(this,void 0,void 0,function*(){var n,s,o;try{if(!this.url||!this.token)throw new St("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(re.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let l;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new xs;l=yield this.join(e??this.url,this.token,this.signalOpts)}catch(u){throw u instanceof Oe&&u.reason===Se.NotAllowed?new St("could not reconnect, token might be expired"):new xs}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(re.SignalRestarted,l),yield this.waitForPCReconnected(),this.client.currentState!==We.CONNECTED)throw new xs("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(re.Restarted)}catch(l){const u=yield(s=this.regionUrlProvider)===null||s===void 0?void 0:s.getNextBestRegionUrl();if(u){yield this.restartConnection(u);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),l}})}resumeConnection(e){return C(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new St("could not reconnect, url or token not saved");if(!this.pcManager)throw new St("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(re.Resuming);let s;try{this.setupSignalClientCallbacks(),s=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let l="";throw o instanceof Error&&(l=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof Oe&&o.reason===Se.NotAllowed?new St("could not reconnect, token might be expired"):o instanceof Oe&&o.reason===Se.LeaveRequest?o:new xs(l)}if(this.emit(re.SignalResumed),s){const o=this.makeRTCConfiguration(s);this.pcManager.updateConfiguration(o),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=s.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==We.CONNECTED)throw new xs("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),s!=null&&s.lastMessageSeq&&this.resendReliableMessagesForResume(s.lastMessageSeq),this.emit(re.Resumed)})}waitForPCInitialConnection(e,n){return C(this,void 0,void 0,function*(){if(!this.pcManager)throw new St("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return C(this,void 0,void 0,function*(){this.pcState=Sn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Pt(NA),!this.pcManager)throw new St("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Sn.Connected}catch(e){throw this.pcState=Sn.Disconnected,new Oe("could not establish PC connection, ".concat(e.message),Se.InternalError)}})}publishRpcResponse(e,n,s,o){return C(this,void 0,void 0,function*(){const l=new Ut({destinationIdentities:[e],kind:Re.RELIABLE,value:{case:"rpcResponse",value:new hf({requestId:n,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:s??""}})}});yield this.sendDataPacket(l,Re.RELIABLE)})}publishRpcAck(e,n){return C(this,void 0,void 0,function*(){const s=new Ut({destinationIdentities:[e],kind:Re.RELIABLE,value:{case:"rpcAck",value:new df({requestId:n})}});yield this.sendDataPacket(s,Re.RELIABLE)})}sendDataPacket(e,n){return C(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(n),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const l=nR(e);if(l){const u=yield this.e2eeManager.encryptData(l.toBinary());e.value={case:"encryptedPacket",value:new wb({encryptedValue:u.payload,iv:u.iv,keyIndex:u.keyIndex})}}}n===Re.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const s=e.toBinary();yield this.waitForBufferStatusLow(n);const o=this.dataChannelForKind(n);if(o){if(n===Re.RELIABLE&&this.reliableMessageBuffer.push({data:s,sequence:e.sequence}),this.attemptingReconnect)return;o.send(s)}this.updateAndEmitDCBufferStatus(n)})}resendReliableMessagesForResume(e){return C(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Re.RELIABLE);const n=this.dataChannelForKind(Re.RELIABLE);n&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(s=>{n.send(s.data)})),this.updateAndEmitDCBufferStatus(Re.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((n,s)=>C(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const o=()=>s("Engine closed");for(this.once(re.Closing,o);!this.dcBufferStatus.get(e);)yield Pt(10);this.off(re.Closing,o),n()}}))}ensureDataTransportConnected(e){return C(this,arguments,void 0,function(n){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return(function*(){var l;if(!s.pcManager)throw new St("PC manager is closed");const u=o?s.pcManager.subscriber:s.pcManager.publisher,d=o?"Subscriber":"Publisher";if(!u)throw new Oe("".concat(d," connection not set"),Se.InternalError);let f=!1;!o&&!s.dataChannelForKind(n,o)&&(s.createDataChannels(),f=!0),!f&&!o&&!s.pcManager.publisher.isICEConnected&&s.pcManager.publisher.getICEConnectionState()!=="checking"&&(f=!0),f&&s.negotiate().catch(v=>{Ce.error(v,s.logContext)});const m=s.dataChannelForKind(n,o);if((m==null?void 0:m.readyState)==="open")return;const g=new Date().getTime()+s.peerConnectionTimeout;for(;new Date().getTime()<g;){if(u.isICEConnected&&((l=s.dataChannelForKind(n,o))===null||l===void 0?void 0:l.readyState)==="open")return;yield Pt(50)}throw new Oe("could not establish ".concat(d," connection, state: ").concat(u.getICEConnectionState()),Se.InternalError)})()})}ensurePublisherConnected(e){return C(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==ot.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return C(this,void 0,void 0,function*(){return new Promise((e,n)=>C(this,void 0,void 0,function*(){if(!this.pcManager){n(new Lh("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const s=new AbortController,o=()=>{s.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(re.Closing,o),this.pcManager.publisher.once(Ps.RTPVideoPayloadTypes,l=>{const u=new Map;l.forEach(d=>{const f=d.codec.toLowerCase();wR(f)&&u.set(d.payload,f)}),this.emit(re.RTPVideoMapUpdate,u)});try{yield this.pcManager.negotiate(s),e()}catch(l){l instanceof Lh&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Ma.RR_UNKNOWN),n(l)}finally{this.off(re.Closing,o)}}))})}dataChannelForKind(e,n){if(n){if(e===Re.LOSSY)return this.lossyDCSub;if(e===Re.RELIABLE)return this.reliableDCSub}else{if(e===Re.LOSSY)return this.lossyDC;if(e===Re.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var s,o,l,u;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const d=this.pcManager.publisher.getLocalDescription(),f=this.pcManager.publisher.getRemoteDescription(),m=(s=this.pcManager.subscriber)===null||s===void 0?void 0:s.getRemoteDescription(),g=(o=this.pcManager.subscriber)===null||o===void 0?void 0:o.getLocalDescription(),v=(u=(l=this.signalOpts)===null||l===void 0?void 0:l.autoSubscribe)!==null&&u!==void 0?u:!0,S=new Array,T=new Array;e.forEach(x=>{x.isDesired!==v&&S.push(x.trackSid),x.isEnabled||T.push(x.trackSid)}),this.client.sendSyncState(new vf({answer:this.options.singlePeerConnection?f?_s({sdp:f.sdp,type:f.type}):void 0:g?_s({sdp:g.sdp,type:g.type}):void 0,offer:this.options.singlePeerConnection?d?_s({sdp:d.sdp,type:d.type}):void 0:m?_s({sdp:m.sdp,type:m.type}):void 0,subscription:new bc({trackSids:S,subscribe:!v,participantTracks:[]}),publishTracks:IR(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:T,datachannelReceiveStates:this.reliableReceivedState.map((x,E)=>new Yb({publisherSid:E,lastSeq:x}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(s,o)=>{(s==null?void 0:s.id)!==void 0&&s.id!==null&&e.push(new Kb({label:s.label,id:s.id,target:o}))};return n(this.dataChannelForKind(Re.LOSSY),An.PUBLISHER),n(this.dataChannelForKind(Re.RELIABLE),An.PUBLISHER),n(this.dataChannelForKind(Re.LOSSY,!0),An.SUBSCRIBER),n(this.dataChannelForKind(Re.RELIABLE,!0),An.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Dt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Jt()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){Jt()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var n;const s=(n=this.pcManager)===null||n===void 0?void 0:n.getMidForReceiver(e);if(s){const o=Object.entries(this.midToTrackId).find(l=>{let[u]=l;return u===s});if(o)return o[1]}}}class xs extends Error{}function PA(a){return a!==void 0&&a>13}function hy(a,e){const n=a.participantIdentity?a.participantIdentity:e.participantIdentity;a.participantIdentity=n,e.participantIdentity=n;const s=a.destinationIdentities.length!==0?a.destinationIdentities:e.destinationIdentities;a.destinationIdentities=s,e.destinationIdentities=s}class VS{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new kn("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),jt.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new kn("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),jt.LengthExceeded)}}constructor(e,n,s,o){this.reader=n,this.totalByteSize=s,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=o}}class LA extends VS{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader();let n=new Tn,s=null,o=null;if(this.signal){const u=this.signal;o=()=>{var d;(d=n.reject)===null||d===void 0||d.call(n,u.reason)},u.addEventListener("abort",o),s=u}const l=()=>{e.releaseLock(),s&&o&&s.removeEventListener("abort",o),this.signal=void 0};return{next:()=>C(this,void 0,void 0,function*(){var u,d;try{const{done:f,value:m}=yield Promise.race([e.read(),n.promise,(d=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&d!==void 0?d:new Promise(()=>{})]);return f?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(m),{done:!1,value:m.content})}catch(f){throw l(),f}}),return(){return C(this,void 0,void 0,function*(){return l(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var s,o,l,u;let d=new Set;const f=n.signal?e.withAbortSignal(n.signal):e;try{for(var m=!0,g=gi(f),v;v=yield g.next(),s=v.done,!s;m=!0){u=v.value,m=!1;const S=u;d.add(S)}}catch(S){o={error:S}}finally{try{!m&&!s&&(l=g.return)&&(yield l.call(g))}finally{if(o)throw o.error}}return Array.from(d)})()})}}class IA extends VS{constructor(e,n,s,o){super(e,n,s,o),this.receivedChunks=new Map}handleChunkReceived(e){var n;const s=Ql(e.chunkIndex),o=this.receivedChunks.get(s);if(o&&o.version>e.version)return;this.receivedChunks.set(s,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const l=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,l)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder("utf-8",{fatal:!0});let s=new Tn,o=null,l=null;if(this.signal){const d=this.signal;l=()=>{var f;(f=s.reject)===null||f===void 0||f.call(s,d.reason)},d.addEventListener("abort",l),o=d}const u=()=>{e.releaseLock(),o&&l&&o.removeEventListener("abort",l),this.signal=void 0};return{next:()=>C(this,void 0,void 0,function*(){var d,f;try{const{done:m,value:g}=yield Promise.race([e.read(),s.promise,(f=(d=this.outOfBandFailureRejectingFuture)===null||d===void 0?void 0:d.promise)!==null&&f!==void 0?f:new Promise(()=>{})]);if(m)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(g);let v;try{v=n.decode(g.content)}catch(S){throw new kn("Cannot decode datastream chunk ".concat(g.chunkIndex," as text: ").concat(S),jt.DecodeFailed)}return{done:!1,value:v}}}catch(m){throw u(),m}}),return(){return C(this,void 0,void 0,function*(){return u(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return C(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var s,o,l,u;let d="";const f=n.signal?e.withAbortSignal(n.signal):e;try{for(var m=!0,g=gi(f),v;v=yield g.next(),s=v.done,!s;m=!0)u=v.value,m=!1,d+=u}catch(S){o={error:S}}finally{try{!m&&!s&&(l=g.return)&&(yield l.call(g))}finally{if(o)throw o.error}}return d})()})}}class jA{constructor(){this.log=Ce,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new kn('A text stream handler for topic "'.concat(e,'" has already been set.'),jt.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new kn('A byte stream handler for topic "'.concat(e,'" has already been set.'),jt.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var n,s,o,l;const u=Array.from(this.textStreamControllers.entries()).filter(f=>f[1].sendingParticipantIdentity===e),d=Array.from(this.byteStreamControllers.entries()).filter(f=>f[1].sendingParticipantIdentity===e);if(u.length>0||d.length>0){const f=new kn("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),jt.AbnormalEnd);for(const[m,g]of d)(s=(n=g.outOfBandFailureRejectingFuture).reject)===null||s===void 0||s.call(n,f),this.byteStreamControllers.delete(m);for(const[m,g]of u)(l=(o=g.outOfBandFailureRejectingFuture).reject)===null||l===void 0||l.call(o,f),this.textStreamControllers.delete(m)}}handleDataStreamPacket(e,n){return C(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,n);case"streamChunk":return this.handleStreamChunk(e.value.value,n);case"streamTrailer":return this.handleStreamTrailer(e.value.value,n);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,n,s){return C(this,void 0,void 0,function*(){var o;if(e.contentHeader.case==="byteHeader"){const l=this.byteStreamHandlers.get(e.topic);if(!l){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let u;const d=new Tn;d.promise.catch(g=>{this.log.error(g)});const f={id:e.streamId,name:(o=e.contentHeader.value.name)!==null&&o!==void 0?o:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Ql(e.timestamp),attributes:e.attributes,encryptionType:s},m=new ReadableStream({start:g=>{if(u=g,this.textStreamControllers.has(e.streamId))throw new kn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),jt.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:f,controller:u,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:d})}});l(new LA(f,m,Ql(e.totalLength),d),{identity:n})}else if(e.contentHeader.case==="textHeader"){const l=this.textStreamHandlers.get(e.topic);if(!l){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let u;const d=new Tn;d.promise.catch(g=>{this.log.error(g)});const f={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:s},m=new ReadableStream({start:g=>{if(u=g,this.textStreamControllers.has(e.streamId))throw new kn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),jt.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:f,controller:u,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:d})}});l(new IA(f,m,Ql(e.totalLength),d),{identity:n})}})}handleStreamChunk(e,n){const s=this.byteStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==n?(s.controller.error(new kn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(s.info.encryptionType),jt.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&s.controller.enqueue(e));const o=this.textStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==n?(o.controller.error(new kn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(o.info.encryptionType),jt.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&o.controller.enqueue(e))}handleStreamTrailer(e,n){const s=this.textStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==n?s.controller.error(new kn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(s.info.encryptionType),jt.EncryptionTypeMismatch)):(s.info.attributes=Object.assign(Object.assign({},s.info.attributes),e.attributes),s.controller.close(),this.textStreamControllers.delete(e.streamId)));const o=this.byteStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==n?o.controller.error(new kn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(o.info.encryptionType),jt.EncryptionTypeMismatch)):(o.info.attributes=Object.assign(Object.assign({},o.info.attributes),e.attributes),o.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class HS{constructor(e,n,s){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=s,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return C(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class UA extends HS{}class BA extends HS{}const fy=15e3;class zA{constructor(e,n){this.engine=e,this.log=n}setupEngine(e){this.engine=e}sendText(e,n){return C(this,void 0,void 0,function*(){var s;const o=crypto.randomUUID(),u=new TextEncoder().encode(e).byteLength,d=(s=n==null?void 0:n.attachments)===null||s===void 0?void 0:s.map(()=>crypto.randomUUID()),f=new Array(d?d.length+1:1).fill(0),m=(v,S)=>{var T;f[S]=v;const x=f.reduce((E,D)=>E+D,0);(T=n==null?void 0:n.onProgress)===null||T===void 0||T.call(n,x)},g=yield this.streamText({streamId:o,totalSize:u,destinationIdentities:n==null?void 0:n.destinationIdentities,topic:n==null?void 0:n.topic,attachedStreamIds:d,attributes:n==null?void 0:n.attributes});return yield g.write(e),m(1,0),yield g.close(),n!=null&&n.attachments&&d&&(yield Promise.all(n.attachments.map((v,S)=>C(this,void 0,void 0,function*(){return this._sendFile(d[S],v,{topic:n.topic,mimeType:v.type,onProgress:T=>{m(T,S+1)}})})))),g.info})}streamText(e){return C(this,void 0,void 0,function*(){var n,s,o;const l=(n=e==null?void 0:e.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),u={id:l,mimeType:"text/plain",timestamp:Date.now(),topic:(s=e==null?void 0:e.topic)!==null&&s!==void 0?s:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes,encryptionType:!((o=this.engine.e2eeManager)===null||o===void 0)&&o.isDataChannelEncryptionEnabled?kt.GCM:kt.NONE},d=new nc({streamId:l,mimeType:u.mimeType,topic:u.topic,timestamp:Na(u.timestamp),totalLength:Na(e==null?void 0:e.totalSize),attributes:u.attributes,contentHeader:{case:"textHeader",value:new Ub({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?xh.UPDATE:xh.CREATE})}}),f=e==null?void 0:e.destinationIdentities,m=new Ut({destinationIdentities:f,value:{case:"streamHeader",value:d}});yield this.engine.sendDataPacket(m,Re.RELIABLE);let g=0;const v=this.engine,S=new WritableStream({write(E){return C(this,void 0,void 0,function*(){for(const D of OR(E,fy)){const M=new ic({content:D,streamId:l,chunkIndex:Na(g)}),Y=new Ut({destinationIdentities:f,value:{case:"streamChunk",value:M}});yield v.sendDataPacket(Y,Re.RELIABLE),g+=1}})},close(){return C(this,void 0,void 0,function*(){const E=new ac({streamId:l}),D=new Ut({destinationIdentities:f,value:{case:"streamTrailer",value:E}});yield v.sendDataPacket(D,Re.RELIABLE)})},abort(E){console.log("Sink error:",E)}});let T=()=>C(this,void 0,void 0,function*(){yield x.close()});v.once(re.Closing,T);const x=new UA(S,u,()=>this.engine.off(re.Closing,T));return x})}sendFile(e,n){return C(this,void 0,void 0,function*(){const s=crypto.randomUUID();return yield this._sendFile(s,e,n),{id:s}})}_sendFile(e,n,s){return C(this,void 0,void 0,function*(){var o;const l=yield this.streamBytes({streamId:e,totalSize:n.size,name:n.name,mimeType:(o=s==null?void 0:s.mimeType)!==null&&o!==void 0?o:n.type,topic:s==null?void 0:s.topic,destinationIdentities:s==null?void 0:s.destinationIdentities}),u=n.stream().getReader();for(;;){const{done:d,value:f}=yield u.read();if(d)break;yield l.write(f)}return yield l.close(),l.info})}streamBytes(e){return C(this,void 0,void 0,function*(){var n,s,o,l,u,d;const f=(n=e==null?void 0:e.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),m=e==null?void 0:e.destinationIdentities,g={id:f,mimeType:(s=e==null?void 0:e.mimeType)!==null&&s!==void 0?s:"application/octet-stream",topic:(o=e==null?void 0:e.topic)!==null&&o!==void 0?o:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(l=e==null?void 0:e.name)!==null&&l!==void 0?l:"unknown",encryptionType:!((u=this.engine.e2eeManager)===null||u===void 0)&&u.isDataChannelEncryptionEnabled?kt.GCM:kt.NONE},v=new nc({totalLength:Na((d=g.size)!==null&&d!==void 0?d:0),mimeType:g.mimeType,streamId:f,topic:g.topic,timestamp:Na(Date.now()),attributes:g.attributes,contentHeader:{case:"byteHeader",value:new Bb({name:g.name})}}),S=new Ut({destinationIdentities:m,value:{case:"streamHeader",value:v}});yield this.engine.sendDataPacket(S,Re.RELIABLE);let T=0;const x=new Bt,E=this.engine,D=this.log,M=new WritableStream({write(P){return C(this,void 0,void 0,function*(){const A=yield x.lock();let N=0;try{for(;N<P.byteLength;){const V=P.slice(N,N+fy),X=new Ut({destinationIdentities:m,value:{case:"streamChunk",value:new ic({content:V,streamId:f,chunkIndex:Na(T)})}});yield E.sendDataPacket(X,Re.RELIABLE),T+=1,N+=V.byteLength}}finally{A()}})},close(){return C(this,void 0,void 0,function*(){const P=new ac({streamId:f}),A=new Ut({destinationIdentities:m,value:{case:"streamTrailer",value:P}});yield E.sendDataPacket(A,Re.RELIABLE)})},abort(P){D.error("Sink error:",P)}});return new BA(M,g)})}}class GS extends Z{constructor(e,n,s,o,l){super(e,s,l),this.sid=n,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ie.Muted:ie.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=s=>{s.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(ie.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return C(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Af)),jR()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const s=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(s){const{timestamp:o,rtpTimestamp:l}=s;l&&this.rtpTimestamp!==l&&(this.emit(ie.TimeSyncUpdate,{timestamp:o,rtpTimestamp:l}),this.rtpTimestamp=l)}};e()}}class qA extends GS{constructor(e,n,s,o,l,u){super(e,n,Z.Kind.Audio,s,u),this.monitorReceiver=()=>C(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=Tc(d,this.prevStats)),this.prevStats=d}),this.audioContext=o,this.webAudioPluginNodes=[],l&&(this.sinkId=l.deviceId)}setVolume(e){var n;for(const s of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):s.volume=e;Fn()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Fn())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return C(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(zh(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&zh(e)&&e.setSinkId(this.sinkId).catch(s=>{this.log.error("Failed to set sink id on remote audio track",s,this.logContext)}),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let s=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{s.connect(o),s=o}),this.gainNode=e.createGain(),s.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ie.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit(ie.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return C(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(s=>{s.type==="inbound-rtp"&&(n={type:"audio",streamId:s.id,timestamp:s.timestamp,jitter:s.jitter,bytesReceived:s.bytesReceived,concealedSamples:s.concealedSamples,concealmentEvents:s.concealmentEvents,silentConcealedSamples:s.silentConcealedSamples,silentConcealmentEvents:s.silentConcealmentEvents,totalAudioEnergy:s.totalAudioEnergy,totalSamplesDuration:s.totalSamplesDuration})}),n})}}const yh=100;class FA extends GS{constructor(e,n,s,o,l){super(e,n,Z.Kind.Video,s,l),this.elementInfos=[],this.monitorReceiver=()=>C(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=Tc(u,this.prevStats)),this.prevStats=u}),this.debouncedHandleResize=Ef(()=>{this.updateDimensions()},yh),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===Z.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Ns(this._mediaStreamTrack,n):ws(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new VA(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(s=>s===e);for(const s of n)s.stopObserving();this.elementInfos=this.elementInfos.filter(s=>s!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const s of n)this.stopObservingElement(s);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return C(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,s="",o=new Map;return e.forEach(l=>{l.type==="inbound-rtp"?(s=l.codecId,n={type:"video",streamId:l.id,framesDecoded:l.framesDecoded,framesDropped:l.framesDropped,framesReceived:l.framesReceived,packetsReceived:l.packetsReceived,packetsLost:l.packetsLost,frameWidth:l.frameWidth,frameHeight:l.frameHeight,pliCount:l.pliCount,firCount:l.firCount,nackCount:l.nackCount,jitter:l.jitter,timestamp:l.timestamp,bytesReceived:l.bytesReceived,decoderImplementation:l.decoderImplementation}):l.type==="codec"&&o.set(l.id,l)}),n&&s!==""&&o.get(s)&&(n.mimeType=o.get(s).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(s=>s.element===e);for(const s of n)this.stopObservingElementInfo(s)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return C(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var n,s;const o=this.elementInfos.reduce((f,m)=>Math.max(f,m.visibilityChangedAt||0),0),l=!((s=(n=this.adaptiveStreamSettings)===null||n===void 0?void 0:n.pauseVideoInBackground)!==null&&s!==void 0)||s?this.isInBackground:!1,u=this.elementInfos.some(f=>f.pictureInPicture),d=this.elementInfos.some(f=>f.visible)&&!l||u;if(!(this.lastVisible===d&&!e)){if(!d&&Date.now()-o<yh){Dt.setTimeout(()=>{this.updateVisibility()},yh);return}this.lastVisible=d,this.emit(ie.VisibilityChanged,d,this)}}updateDimensions(){var e,n;let s=0,o=0;const l=this.getPixelDensity();for(const u of this.elementInfos){const d=u.width()*l,f=u.height()*l;d+f>s+o&&(s=d,o=f)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===s&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===o||(this.lastDimensions={width:s,height:o},this.emit(ie.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?V0():n||(V0()>2?2:1)}}class VA{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=s=>{var o;const{target:l,isIntersecting:u}=s;l===this.element&&(this.isIntersecting=u,this.isPiP=Fr(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var s,o,l;(o=(s=window.documentPictureInPicture)===null||s===void 0?void 0:s.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Fr(this.element),(l=this.handleVisibilityChanged)===null||l===void 0||l.call(this)},this.onLeavePiP=()=>{var s;this.isPiP=Fr(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.element=e,this.isIntersecting=n??Kh(e),this.isPiP=Jt()&&Fr(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,s;this.isIntersecting=Kh(this.element),this.isPiP=Fr(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,G0().observe(this.element),H0().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(s=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||s===void 0||s.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,s,o,l;(e=G0())===null||e===void 0||e.unobserve(this.element),(n=H0())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(s=window.documentPictureInPicture)===null||s===void 0||s.removeEventListener("enter",this.onEnterPiP),(l=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||l===void 0||l.removeEventListener("pagehide",this.onLeavePiP)}}function Fr(a){var e,n;return document.pictureInPictureElement===a?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Kh(a,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Kh(a,e){const n=e||window;let s=a.offsetTop,o=a.offsetLeft;const l=a.offsetWidth,u=a.offsetHeight,{hidden:d}=a,{display:f}=getComputedStyle(a);for(;a.offsetParent;)a=a.offsetParent,s+=a.offsetTop,o+=a.offsetLeft;return s<n.pageYOffset+n.innerHeight&&o<n.pageXOffset+n.innerWidth&&s+u>n.pageYOffset&&o+l>n.pageXOffset&&!d&&f!=="none"}class hi extends Gn.EventEmitter{constructor(e,n,s,o){var l;super(),this.metadataMuted=!1,this.encryption=kt.NONE,this.log=Ce,this.handleMuted=()=>{this.emit(ie.Muted)},this.handleUnmuted=()=>{this.emit(ie.Unmuted)},this.log=ki((l=o==null?void 0:o.loggerName)!==null&&l!==void 0?l:Dn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=s,this.source=Z.Source.Unknown}setTrack(e){this.track&&(this.track.off(ie.Muted,this.handleMuted),this.track.off(ie.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ie.Muted,this.handleMuted),e.on(ie.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),_e(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==kt.NONE}get audioTrack(){if(qn(this.track))return this.track}get videoTrack(){if(la(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Z.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Z.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(a){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(a.SubscriptionStatus||(a.SubscriptionStatus={})),(function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"})(a.PermissionStatus||(a.PermissionStatus={}))})(hi||(hi={}));class Qh extends hi{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,s,o){super(e,n.sid,n.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ie.Ended)},this.handleCpuConstrained=()=>{this.track&&la(this.track)&&this.emit(ie.CpuConstrained,this.track)},this.updateInfo(n),this.setTrack(s)}setTrack(e){this.track&&(this.track.off(ie.Ended,this.handleTrackEnded),this.track.off(ie.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(ie.Ended,this.handleTrackEnded),e.on(ie.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return C(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return C(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return C(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return C(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(qn(this.track)){const n=this.track.getSourceTrackSettings(),s=new Set;return n.autoGainControl&&s.add(Et.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&s.add(Et.TF_ECHO_CANCELLATION),n.noiseSuppression&&s.add(Et.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&s.add(Et.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||s.add(Et.TF_NO_DTX),this.track.enhancedNoiseCancellation&&s.add(Et.TF_ENHANCED_NOISE_CANCELLATION),Array.from(s.values())}else return[]}}function Cc(a,e){return C(this,void 0,void 0,function*(){a??(a={});let n=!1;const{audioProcessor:s,videoProcessor:o,optionsWithoutProcessor:l}=PS(a);let u=l.audio,d=l.video;if(s&&typeof l.audio=="object"&&(l.audio.processor=s),o&&typeof l.video=="object"&&(l.video.processor=o),a.audio&&typeof l.audio=="object"&&typeof l.audio.deviceId=="string"){const v=l.audio.deviceId;l.audio.deviceId={exact:v},n=!0,u=Object.assign(Object.assign({},l.audio),{deviceId:{ideal:v}})}if(l.video&&typeof l.video=="object"&&typeof l.video.deviceId=="string"){const v=l.video.deviceId;l.video.deviceId={exact:v},n=!0,d=Object.assign(Object.assign({},l.video),{deviceId:{ideal:v}})}l.audio===!0?l.audio={deviceId:"default"}:typeof l.audio=="object"&&l.audio!==null&&(l.audio=Object.assign(Object.assign({},l.audio),{deviceId:l.audio.deviceId||"default"})),l.video===!0?l.video={deviceId:"default"}:typeof l.video=="object"&&!l.video.deviceId&&(l.video.deviceId="default");const f=NS(l,IS,jS),m=Tf(f),g=navigator.mediaDevices.getUserMedia(m);l.audio&&(wt.userMediaPromiseMap.set("audioinput",g),g.catch(()=>wt.userMediaPromiseMap.delete("audioinput"))),l.video&&(wt.userMediaPromiseMap.set("videoinput",g),g.catch(()=>wt.userMediaPromiseMap.delete("videoinput")));try{const v=yield g;return yield Promise.all(v.getTracks().map(S=>C(this,void 0,void 0,function*(){const T=S.kind==="audio";let x=T?f.audio:f.video;(typeof x=="boolean"||!x)&&(x={});let E;const D=T?m.audio:m.video;typeof D!="boolean"&&(E=D);const M=S.getSettings().deviceId;E!=null&&E.deviceId&&sa(E.deviceId)!==M?E.deviceId=M:E||(E={deviceId:M});const Y=bA(S,E,e);return Y.kind===Z.Kind.Video?Y.source=Z.Source.Camera:Y.kind===Z.Kind.Audio&&(Y.source=Z.Source.Microphone),Y.mediaStream=v,qn(Y)&&s?yield Y.setProcessor(s):la(Y)&&o&&(yield Y.setProcessor(o)),Y})))}catch(v){if(!n)throw v;return Cc(Object.assign(Object.assign({},a),{audio:u,video:d}),e)}})}function HA(a){return C(this,void 0,void 0,function*(){return(yield Cc({audio:!1,video:!0}))[0]})}function YS(a){return C(this,void 0,void 0,function*(){return(yield Cc({audio:a??!0,video:!1}))[0]})}var ta;(function(a){a.Excellent="excellent",a.Good="good",a.Poor="poor",a.Lost="lost",a.Unknown="unknown"})(ta||(ta={}));function GA(a){switch(a){case Hr.EXCELLENT:return ta.Excellent;case Hr.GOOD:return ta.Good;case Hr.POOR:return ta.Poor;case Hr.LOST:return ta.Lost;default:return ta.Unknown}}class KS extends Gn.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Zr.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===Rs.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,s,o,l,u){let d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Zr.STANDARD;var f;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ta.Unknown,this.log=Ce,this.log=ki((f=u==null?void 0:u.loggerName)!==null&&f!==void 0?f:Dn.Participant),this.loggerOptions=u,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=s,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=d,this._attributes=l??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Tn,this.once(oe.Active,()=>{var e,n;(n=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||n===void 0||n.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(Z.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(Z.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Z.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var n;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===Rs.ACTIVE&&((n=this.participantInfo)===null||n===void 0?void 0:n.state)!==Rs.ACTIVE&&this.emit(oe.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const n=this.metadata!==e,s=this.metadata;this.metadata=e,n&&this.emit(oe.ParticipantMetadataChanged,s)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(oe.ParticipantNameChanged,e)}_setAttributes(e){const n=UR(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(oe.AttributesChanged,n)}setPermissions(e){var n,s,o,l,u,d;const f=this.permissions,m=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((l=this.permissions)===null||l===void 0?void 0:l.hidden)||e.recorder!==((u=this.permissions)===null||u===void 0?void 0:u.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((g,v)=>{var S;return g!==((S=this.permissions)===null||S===void 0?void 0:S.canPublishSources[v])})||e.canSubscribeMetrics!==((d=this.permissions)===null||d===void 0?void 0:d.canSubscribeMetrics);return this.permissions=e,m&&this.emit(oe.ParticipantPermissionsChanged,f),m}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(oe.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=GA(e),n!==this._connectionQuality&&this.emit(oe.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,n;this.activeFuture&&((n=(e=this.activeFuture).reject)===null||n===void 0||n.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>qn(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ie.Muted,()=>{this.emit(oe.TrackMuted,e)}),e.on(ie.Unmuted,()=>{this.emit(oe.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Z.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Z.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function YA(a){var e,n,s;if(!a.participantSid&&!a.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Hb({participantIdentity:(e=a.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=a.participantSid)!==null&&n!==void 0?n:"",allTracks:(s=a.allowAll)!==null&&s!==void 0?s:!1,trackSids:a.allowedTrackSids||[]})}class KA extends KS{constructor(e,n,s,o,l,u){super(e,n,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=kt.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Tn)},this.handleReconnected=()=>{var d,f;(f=(d=this.reconnectFuture)===null||d===void 0?void 0:d.resolve)===null||f===void 0||f.call(d),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var d,f,m,g,v,S;this.reconnectFuture&&(this.reconnectFuture.promise.catch(T=>this.log.warn(T.message,this.logContext)),(f=(d=this.reconnectFuture)===null||d===void 0?void 0:d.reject)===null||f===void 0||f.call(d,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&((g=(m=this.signalConnectedFuture).reject)===null||g===void 0||g.call(m,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),(S=(v=this.activeAgentFuture)===null||v===void 0?void 0:v.reject)===null||S===void 0||S.call(v,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=d=>{var f,m;d.participant&&this.updateInfo(d.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Tn),(m=(f=this.signalConnectedFuture).resolve)===null||m===void 0||m.call(f)},this.handleSignalRequestResponse=d=>{const{requestId:f,reason:m,message:g}=d,v=this.pendingSignalRequests.get(f);v&&(m!==yf.OK&&v.reject(new U0(g,m)),this.pendingSignalRequests.delete(f))},this.handleDataPacket=d=>{switch(d.value.case){case"rpcResponse":let f=d.value.value,m=null,g=null;f.value.case==="payload"?m=f.value.value:f.value.case==="error"&&(g=ct.fromProto(f.value.value)),this.handleIncomingRpcResponse(f.requestId,m,g);break;case"rpcAck":let v=d.value.value;this.handleIncomingRpcAck(v.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(d=>YA(d)))},this.onTrackUnmuted=d=>{this.onTrackMuted(d,d.isUpstreamPaused)},this.onTrackMuted=(d,f)=>{if(f===void 0&&(f=!0),!d.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),_e(d)));return}this.engine.updateMuteStatus(d.sid,f)},this.onTrackUpstreamPaused=d=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),_e(d))),this.onTrackMuted(d,!0)},this.onTrackUpstreamResumed=d=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),_e(d))),this.onTrackMuted(d,d.isMuted)},this.onTrackFeatureUpdate=d=>{const f=this.audioTrackPublications.get(d.sid);if(!f){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(d.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(f.trackSid,f.getTrackFeatures())},this.onTrackCpuConstrained=(d,f)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),_e(f))),this.emit(oe.LocalTrackCpuConstrained,d,f)},this.handleSubscribedQualityUpdate=d=>C(this,void 0,void 0,function*(){var f,m,g,v,S;if(!(!((S=this.roomOptions)===null||S===void 0)&&S.dynacast))return;const T=this.videoTrackPublications.get(d.trackSid);if(!T){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:d.trackSid}));return}if(!T.videoTrack)return;const x=yield T.videoTrack.setPublishingCodecs(d.subscribedCodecs);try{for(var E=!0,D=gi(x),M;M=yield D.next(),f=M.done,!f;E=!0){v=M.value,E=!1;const Y=v;mR(Y)&&(this.log.debug("publish ".concat(Y," for ").concat(T.videoTrack.sid),Object.assign(Object.assign({},this.logContext),_e(T))),yield this.publishAdditionalCodecForTrack(T.videoTrack,Y,T.options))}}catch(Y){m={error:Y}}finally{try{!E&&!f&&(g=D.return)&&(yield g.call(D))}finally{if(m)throw m.error}}}),this.handleLocalTrackUnpublished=d=>{const f=this.trackPublications.get(d.trackSid);if(!f){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:d.trackSid}));return}this.unpublishTrack(f.track)},this.handleTrackEnded=d=>C(this,void 0,void 0,function*(){if(d.source===Z.Source.ScreenShare||d.source===Z.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),_e(d))),this.unpublishTrack(d);else if(d.isUserProvided)yield d.mute();else if(di(d)||$i(d))try{if(Jt())try{const f=yield navigator==null?void 0:navigator.permissions.query({name:d.source===Z.Source.Camera?"camera":"microphone"});if(f&&f.state==="denied")throw this.log.warn("user has revoked access to ".concat(d.source),Object.assign(Object.assign({},this.logContext),_e(d))),f.onchange=()=>{f.state!=="denied"&&(d.isMuted||d.restartTrack(),f.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}d.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),_e(d))),di(d)?yield d.restartTrack({deviceId:"default"}):yield d.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),_e(d))),yield d.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=s,this.roomOptions=o,this.setupEngine(s),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=l,this.roomOutgoingDataStreamManager=u}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==kt.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){var n;this.engine=e,this.engine.on(re.RemoteMute,(s,o)=>{const l=this.trackPublications.get(s);!l||!l.track||(o?l.mute():l.unmute())}),!((n=this.signalConnectedFuture)===null||n===void 0)&&n.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(re.Connected,this.handleReconnected).on(re.SignalConnected,this.handleSignalConnected).on(re.SignalRestarted,this.handleReconnected).on(re.SignalResumed,this.handleReconnected).on(re.Restarting,this.handleReconnecting).on(re.Resuming,this.handleReconnecting).on(re.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(re.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(re.Closing,this.handleClosing).on(re.SignalRequestResponse,this.handleSignalRequestResponse).on(re.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return C(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return C(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return C(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return C(this,arguments,void 0,function(n){var s=this;let{metadata:o,name:l,attributes:u}=n;return(function*(){return new Promise((d,f)=>C(s,void 0,void 0,function*(){var m,g;try{let v=!1;const S=yield this.engine.client.sendUpdateLocalMetadata((m=o??this.metadata)!==null&&m!==void 0?m:"",(g=l??this.name)!==null&&g!==void 0?g:"",u),T=performance.now();for(this.pendingSignalRequests.set(S,{resolve:d,reject:x=>{f(x),v=!0},values:{name:l,metadata:o,attributes:u}});performance.now()-T<5e3&&!v;){if((!l||this.name===l)&&(!o||this.metadata===o)&&(!u||Object.entries(u).every(x=>{let[E,D]=x;return this.attributes[E]===D||D===""&&!this.attributes[E]}))){this.pendingSignalRequests.delete(S),d();return}yield Pt(50)}f(new U0("Request to update local metadata timed out","TimeoutError"))}catch(v){v instanceof Error&&f(v)}}))})()})}setCameraEnabled(e,n,s){return this.setTrackEnabled(Z.Source.Camera,e,n,s)}setMicrophoneEnabled(e,n,s){return this.setTrackEnabled(Z.Source.Microphone,e,n,s)}setScreenShareEnabled(e,n,s){return this.setTrackEnabled(Z.Source.ScreenShare,e,n,s)}setE2EEEnabled(e){return C(this,void 0,void 0,function*(){this.encryptionType=e?kt.GCM:kt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,s,o){return C(this,void 0,void 0,function*(){var l,u;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let d=this.getTrackPublication(e);if(n)if(d)yield d.unmute();else{let f;if(this.pendingPublishing.has(e)){const m=yield this.waitForPendingPublicationOfSource(e);return m||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield m==null?void 0:m.unmute(),m}this.pendingPublishing.add(e);try{switch(e){case Z.Source.Camera:f=yield this.createTracks({video:(l=s)!==null&&l!==void 0?l:!0});break;case Z.Source.Microphone:f=yield this.createTracks({audio:(u=s)!==null&&u!==void 0?u:!0});break;case Z.Source.ScreenShare:f=yield this.createScreenTracks(Object.assign({},s));break;default:throw new vi(e)}}catch(m){throw f==null||f.forEach(g=>{g.stop()}),m instanceof Error&&this.emit(oe.MediaDevicesError,m,Vh(e)),this.pendingPublishing.delete(e),m}for(const m of f){const g=Object.assign(Object.assign({},this.roomOptions.publishDefaults),s);e===Z.Source.Microphone&&qn(m)&&g.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),m.startPreConnectBuffer())}try{const m=[];for(const v of f)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),_e(v))),m.push(this.publishTrack(v,o));[d]=yield Promise.all(m)}catch(m){throw f==null||f.forEach(g=>{g.stop()}),m}finally{this.pendingPublishing.delete(e)}}else if(!(d!=null&&d.track)&&this.pendingPublishing.has(e)&&(d=yield this.waitForPendingPublicationOfSource(e),d||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),d&&d.track)if(e===Z.Source.ScreenShare){d=yield this.unpublishTrack(d.track);const f=this.getTrackPublication(Z.Source.ScreenShareAudio);f&&f.track&&this.unpublishTrack(f.track)}else yield d.mute();return d})}enableCameraAndMicrophone(){return C(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Z.Source.Camera)||this.pendingPublishing.has(Z.Source.Microphone))){this.pendingPublishing.add(Z.Source.Camera),this.pendingPublishing.add(Z.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Z.Source.Camera),this.pendingPublishing.delete(Z.Source.Microphone)}}})}createTracks(e){return C(this,void 0,void 0,function*(){var n,s;e??(e={});const o=NS(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(s=this.roomOptions)===null||s===void 0?void 0:s.videoCaptureDefaults);try{return(yield Cc(o,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(d=>(qn(d)&&(this.microphoneError=void 0,d.setAudioContext(this.audioContext),d.source=Z.Source.Microphone,this.emit(oe.AudioStreamAcquired)),la(d)&&(this.cameraError=void 0,d.source=Z.Source.Camera),d))}catch(l){throw l instanceof Error&&(e.audio&&(this.microphoneError=l),e.video&&(this.cameraError=l)),l}})}createScreenTracks(e){return C(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Sf("getDisplayMedia not supported");e.resolution===void 0&&!SR()&&(e.resolution=kf.h1080fps30.resolution);const n=LR(e),s=yield navigator.mediaDevices.getDisplayMedia(n),o=s.getVideoTracks();if(o.length===0)throw new vi("no video track found");const l=new lc(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});l.source=Z.Source.ScreenShare,e.contentHint&&(l.mediaStreamTrack.contentHint=e.contentHint);const u=[l];if(s.getAudioTracks().length>0){this.emit(oe.AudioStreamAcquired);const d=new oc(s.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});d.source=Z.Source.ScreenShareAudio,u.push(d)}return u})}publishTrack(e,n){return C(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return C(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return(function*(){var d,f,m,g;di(s)&&s.setAudioContext(l.audioContext),yield(d=l.reconnectFuture)===null||d===void 0?void 0:d.promise,l.republishPromise&&!u&&(yield l.republishPromise),Os(s)&&l.pendingPublishPromises.has(s)&&(yield l.pendingPublishPromises.get(s));let v;if(s instanceof MediaStreamTrack)v=s.getConstraints();else{v=s.constraints;let M;switch(s.source){case Z.Source.Microphone:M="audioinput";break;case Z.Source.Camera:M="videoinput"}M&&l.activeDeviceMap.has(M)&&(v=Object.assign(Object.assign({},v),{deviceId:l.activeDeviceMap.get(M)}))}if(s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new oc(s,v,!0,l.audioContext,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;case"video":s=new lc(s,v,!0,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;default:throw new vi("unsupported MediaStreamTrack kind ".concat(s.kind))}else s.updateLoggerOptions({loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});let S;if(l.trackPublications.forEach(M=>{M.track&&M.track===s&&(S=M)}),S)return l.log.warn("track has already been published, skipping",Object.assign(Object.assign({},l.logContext),_e(S))),S;const T=Object.assign(Object.assign({},l.roomOptions.publishDefaults),o),x="channelCount"in s.mediaStreamTrack.getSettings()&&s.mediaStreamTrack.getSettings().channelCount===2||s.mediaStreamTrack.getConstraints().channelCount===2,E=(f=T.forceStereo)!==null&&f!==void 0?f:x;E&&(T.dtx===void 0&&l.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},l.logContext),_e(s))),T.red===void 0&&l.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(m=T.dtx)!==null&&m!==void 0||(T.dtx=!1),(g=T.red)!==null&&g!==void 0||(T.red=!1)),!TR()&&l.roomOptions.e2ee&&(l.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},l.logContext)),T.simulcast=!1),T.source&&(s.source=T.source);const D=new Promise((M,Y)=>C(l,void 0,void 0,function*(){try{if(this.engine.client.currentState!==We.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:_e(s)}));let P=!1;const A=setTimeout(()=>{P=!0,s.stop(),Y(new j0("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(A),P)return;const N=yield this.publish(s,T,E);M(N)}else try{const P=yield this.publish(s,T,E);M(P)}catch(P){Y(P)}}catch(P){Y(P)}}));l.pendingPublishPromises.set(s,D);try{return yield D}catch(M){throw M}finally{l.pendingPublishPromises.delete(s)}})()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Tn),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),_e(e))),!1;const{canPublish:n,canPublishSources:s}=this.permissions;return n&&(s.length===0||s.map(o=>BR(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),_e(e))),!1)}publish(e,n,s){return C(this,void 0,void 0,function*(){var o,l,u,d,f,m,g,v,S,T;if(!this.hasPermissionsToPublish(e))throw new j0("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(J=>Os(e)&&J.source===e.source)&&e.source!==Z.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),_e(e))),n.stopMicTrackOnMute&&qn(e)&&(e.stopOnMute=!0),e.source===Z.Source.ScreenShare&&Da()&&(n.simulcast=!1),n.videoCodec==="av1"&&!vR()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!yR()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Hh),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(J=>n.videoCodec===Qr(J.mime))||(n.videoCodec=Qr(this.enabledPublishVideoCodecs[0].mime)));const E=n.videoCodec;e.on(ie.Muted,this.onTrackMuted),e.on(ie.Unmuted,this.onTrackUnmuted),e.on(ie.Ended,this.handleTrackEnded),e.on(ie.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ie.UpstreamResumed,this.onTrackUpstreamResumed),e.on(ie.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const D=[],M=!(!((o=n.dtx)!==null&&o!==void 0)||o),Y=e.getSourceTrackSettings();Y.autoGainControl&&D.push(Et.TF_AUTO_GAIN_CONTROL),Y.echoCancellation&&D.push(Et.TF_ECHO_CANCELLATION),Y.noiseSuppression&&D.push(Et.TF_NOISE_SUPPRESSION),Y.channelCount&&Y.channelCount>1&&D.push(Et.TF_STEREO),M&&D.push(Et.TF_NO_DTX),di(e)&&e.hasPreConnectBuffer&&D.push(Et.TF_PRECONNECT_BUFFER);const P=new $r({cid:e.mediaStreamTrack.id,name:n.name,type:Z.kindToProto(e.kind),muted:e.isMuted,source:Z.sourceToProto(e.source),disableDtx:M,encryption:this.encryptionType,stereo:s,disableRed:this.isE2EEEnabled||!(!((l=n.red)!==null&&l!==void 0)||l),stream:n==null?void 0:n.stream,backupCodecPolicy:n==null?void 0:n.backupCodecPolicy,audioFeatures:D});let A;if(e.kind===Z.Kind.Video){let J={width:0,height:0};try{J=yield e.waitForDimensions()}catch{const se=(d=(u=this.roomOptions.videoCaptureDefaults)===null||u===void 0?void 0:u.resolution)!==null&&d!==void 0?d:eo.h720.resolution;J={width:se.width,height:se.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),_e(e)),{dims:J}))}P.width=J.width,P.height=J.height,$i(e)&&(Mn(E)&&(e.source===Z.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),_e(e))))),n.scalabilityMode=(f=n.scalabilityMode)!==null&&f!==void 0?f:"L3T3_KEY"),P.simulcastCodecs=[new wh({codec:E,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Hh}),n.backupCodec&&E!==n.backupCodec.codec&&P.encryption===kt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),P.simulcastCodecs.push(new wh({codec:n.backupCodec.codec,cid:""})))),A=Yh(e.source===Z.Source.ScreenShare,P.width,P.height,n),P.layers=cy(P.width,P.height,A,Mn(n.videoCodec))}else e.kind===Z.Kind.Audio&&(A=[{maxBitrate:(m=n.audioPreset)===null||m===void 0?void 0:m.maxBitrate,priority:(v=(g=n.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&v!==void 0?v:"high",networkPriority:(T=(S=n.audioPreset)===null||S===void 0?void 0:S.priority)!==null&&T!==void 0?T:"high"}]);if(!this.engine||this.engine.isClosed)throw new St("cannot publish track when not connected");const N=()=>C(this,void 0,void 0,function*(){var J,H,se;if(!this.engine.pcManager)throw new St("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,A),this.emit(oe.LocalSenderCreated,e.sender,e),$i(e)&&((J=n.degradationPreference)!==null&&J!==void 0||(n.degradationPreference=AA(e)),e.setDegradationPreference(n.degradationPreference)),A)if(Da()&&e.kind===Z.Kind.Audio){let fe;for(const qe of this.engine.pcManager.publisher.getTransceivers())if(qe.sender===e.sender){fe=qe;break}fe&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:fe,codec:"opus",maxbr:!((H=A[0])===null||H===void 0)&&H.maxBitrate?A[0].maxBitrate/1e3:0})}else e.codec&&Mn(e.codec)&&(!((se=A[0])===null||se===void 0)&&se.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:P.cid,codec:e.codec,maxbr:A[0].maxBitrate/1e3});yield this.engine.negotiate()});let V;const X=new Promise((J,H)=>C(this,void 0,void 0,function*(){var se;try{V=yield this.engine.addTrack(P),J(V)}catch(fe){e.sender&&(!((se=this.engine.pcManager)===null||se===void 0)&&se.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(qe=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),_e(e)),{error:qe}))})),H(fe)}}));if(this.enabledPublishVideoCodecs.length>0)V=(yield Promise.all([X,N()]))[0];else{V=yield X;let J;if(V.codecs.forEach(H=>{J===void 0&&(J=H.mimeType)}),J&&e.kind===Z.Kind.Video){const H=Qr(J);H!==E&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),_e(e)),{codec:H})),n.videoCodec=H,A=Yh(e.source===Z.Source.ScreenShare,P.width,P.height,n))}yield N()}const z=new Qh(e.kind,V,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(z.on(ie.CpuConstrained,J=>this.onTrackCpuConstrained(J,z)),z.options=n,e.sid=V.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:A,trackInfo:V})),$i(e)?e.startMonitor(this.engine.client):di(e)&&e.startMonitor(),this.addTrackPublication(z),this.emit(oe.LocalTrackPublished,z),di(e)&&V.audioFeatures.includes(Et.TF_PRECONNECT_BUFFER)){const J=e.getPreConnectBuffer(),H=e.getPreConnectBufferMimeType();this.on(oe.LocalTrackSubscribed,se=>{if(se.trackSid===V.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),_e(e))),e.stopPreConnectBuffer()}}),J&&new Promise((fe,qe)=>C(this,void 0,void 0,function*(){var $e,Je,F,ae,ee,De;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),_e(e)));const ne=setTimeout(()=>{qe(new Error("agent not active within 10 seconds"))},1e4),le=yield this.waitUntilActiveAgentPresent();clearTimeout(ne),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),_e(e)));const ge=yield this.streamBytes({name:"preconnect-buffer",mimeType:H,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[le.identity],attributes:{trackId:z.trackSid,sampleRate:String((ee=Y.sampleRate)!==null&&ee!==void 0?ee:"48000"),channels:String((De=Y.channelCount)!==null&&De!==void 0?De:"1")}});try{for(var Le=!0,R=gi(J),K;K=yield R.next(),$e=K.done,!$e;Le=!0){ae=K.value,Le=!1;const ye=ae;yield ge.write(ye)}}catch(ye){Je={error:ye}}finally{try{!Le&&!$e&&(F=R.return)&&(yield F.call(R))}finally{if(Je)throw Je.error}}yield ge.close(),fe()}catch(ne){qe(ne)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),_e(e)))}).catch(fe=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),_e(e)),{error:fe}))})}return z})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,s){return C(this,void 0,void 0,function*(){var o;if(this.encryptionType!==kt.NONE)return;let l;if(this.trackPublications.forEach(T=>{T.track&&T.track===e&&(l=T)}),!l)throw new vi("track is not published");if(!$i(e))throw new vi("track is not a video track");const u=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),s),d=wA(e,n,u);if(!d){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),_e(e)));return}const f=e.addSimulcastTrack(n,d);if(!f)return;const m=new $r({cid:f.mediaStreamTrack.id,type:Z.kindToProto(e.kind),muted:e.isMuted,source:Z.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:u.videoCodec,cid:f.mediaStreamTrack.id}]});if(m.layers=cy(m.width,m.height,d),!this.engine||this.engine.isClosed)throw new St("cannot publish track when not connected");const g=()=>C(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,f,u,d),yield this.engine.negotiate()}),S=(yield Promise.all([this.engine.addTrack(m),g()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:d,trackInfo:S}))})}unpublishTrack(e,n){return C(this,void 0,void 0,function*(){var s,o;if(Os(e)){const m=this.pendingPublishPromises.get(e);m&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),_e(e))),yield m)}const l=this.getPublicationForTrack(e),u=l?_e(l):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),u)),!l||!l.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),u));return}e=l.track,e.off(ie.Muted,this.onTrackMuted),e.off(ie.Unmuted,this.onTrackUnmuted),e.off(ie.Ended,this.handleTrackEnded),e.off(ie.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ie.UpstreamResumed,this.onTrackUpstreamResumed),e.off(ie.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(o=(s=this.roomOptions)===null||s===void 0?void 0:s.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),n?e.stop():e.stopMonitor();let d=!1;const f=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<ot.FAILED&&f)try{for(const m of this.engine.pcManager.publisher.getTransceivers())m.sender===f&&(m.direction="inactive",d=!0);if(this.engine.removeTrack(f)&&(d=!0),$i(e)){for(const[,m]of e.simulcastCodecs)m.sender&&(this.engine.removeTrack(m.sender)&&(d=!0),m.sender=void 0);e.simulcastCodecs.clear()}}catch(m){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),u),{error:m}))}switch(this.trackPublications.delete(l.trackSid),l.kind){case Z.Kind.Audio:this.audioTrackPublications.delete(l.trackSid);break;case Z.Kind.Video:this.videoTrackPublications.delete(l.trackSid);break}return this.emit(oe.LocalTrackUnpublished,l),l.setTrack(void 0),d&&(yield this.engine.negotiate()),l})}unpublishTracks(e){return C(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>this.unpublishTrack(s)))).filter(s=>!!s)})}republishAllTracks(e){return C(this,arguments,void 0,function(n){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){s.republishPromise&&(yield s.republishPromise),s.republishPromise=new Promise((l,u)=>C(s,void 0,void 0,function*(){try{const d=[];this.trackPublications.forEach(f=>{f.track&&(n&&(f.options=Object.assign(Object.assign({},f.options),n)),d.push(f))}),yield Promise.all(d.map(f=>C(this,void 0,void 0,function*(){const m=f.track;yield this.unpublishTrack(m,!1),o&&!m.isMuted&&m.source!==Z.Source.ScreenShare&&m.source!==Z.Source.ScreenShareAudio&&(di(m)||$i(m))&&!m.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:f.trackSid})),yield m.restartTrack()),yield this.publishOrRepublishTrack(m,f.options,!0)}))),l()}catch(d){u(d)}finally{this.republishPromise=void 0}})),yield s.republishPromise})()})}publishData(e){return C(this,arguments,void 0,function(n){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const l=o.reliable?Re.RELIABLE:Re.LOSSY,u=o.destinationIdentities,d=o.topic;let f=new cf({participantIdentity:s.identity,payload:n,destinationIdentities:u,topic:d});const m=new Ut({kind:l,value:{case:"user",value:f}});yield s.engine.sendDataPacket(m,l)})()})}publishDtmf(e,n){return C(this,void 0,void 0,function*(){const s=new Ut({kind:Re.RELIABLE,value:{case:"sipDtmf",value:new Ab({code:e,digit:n})}});yield this.engine.sendDataPacket(s,Re.RELIABLE)})}sendChatMessage(e,n){return C(this,void 0,void 0,function*(){const s={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n==null?void 0:n.attachments},o=new Ut({value:{case:"chatMessage",value:new tc(Object.assign(Object.assign({},s),{timestamp:it.parse(s.timestamp)}))}});return yield this.engine.sendDataPacket(o,Re.RELIABLE),this.emit(oe.ChatMessage,s),s})}editChatMessage(e,n){return C(this,void 0,void 0,function*(){const s=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),o=new Ut({value:{case:"chatMessage",value:new tc(Object.assign(Object.assign({},s),{timestamp:it.parse(s.timestamp),editTimestamp:it.parse(s.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,Re.RELIABLE),this.emit(oe.ChatMessage,s),s})}sendText(e,n){return C(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,n)})}streamText(e){return C(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,n){return C(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,n)})}streamBytes(e){return C(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return C(this,arguments,void 0,function(n){var s=this;let{destinationIdentity:o,method:l,payload:u,responseTimeout:d=15e3}=n;return(function*(){return new Promise((g,v)=>C(s,void 0,void 0,function*(){var S,T,x,E;if(Rf(u)>BS){v(ct.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((T=(S=this.engine.latestJoinResponse)===null||S===void 0?void 0:S.serverInfo)===null||T===void 0)&&T.version&&Vn((E=(x=this.engine.latestJoinResponse)===null||x===void 0?void 0:x.serverInfo)===null||E===void 0?void 0:E.version,"1.8.0")<0){v(ct.builtIn("UNSUPPORTED_SERVER"));return}const D=Math.max(d,8e3),M=crypto.randomUUID();yield this.publishRpcRequest(o,M,l,u,D);const Y=setTimeout(()=>{this.pendingAcks.delete(M),v(ct.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(M),clearTimeout(P)},7e3);this.pendingAcks.set(M,{resolve:()=>{clearTimeout(Y)},participantIdentity:o});const P=setTimeout(()=>{this.pendingResponses.delete(M),v(ct.builtIn("RESPONSE_TIMEOUT"))},d);this.pendingResponses.set(M,{resolve:(A,N)=>{clearTimeout(P),this.pendingAcks.has(M)&&(console.warn("RPC response received before ack",M),this.pendingAcks.delete(M),clearTimeout(Y)),N?v(N):g(A??"")},participantIdentity:o})}))})()})}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,s){const o=this.pendingResponses.get(e);o?(o.resolve(n,s),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,s,o,l){return C(this,void 0,void 0,function*(){const u=new Ut({destinationIdentities:[e],kind:Re.RELIABLE,value:{case:"rpcRequest",value:new uf({id:n,method:s,payload:o,responseTimeoutMs:l,version:1})}});yield this.engine.sendDataPacket(u,Re.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:s}]of this.pendingAcks)s===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:s,resolve:o}]of this.pendingResponses)s===e&&(o(null,ct.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(n=>{var s,o;const l=this.trackPublications.get(n.sid);if(l){const u=l.isMuted||((o=(s=l.track)===null||s===void 0?void 0:s.isUpstreamPaused)!==null&&o!==void 0?o:!1);u!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),_e(l)),{mutedOnServer:u})),this.engine.client.sendMuteTrack(n.sid,u))}}),!0):!1}setActiveAgent(e){var n,s,o,l;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(s=(n=this.activeAgentFuture)===null||n===void 0?void 0:n.resolve)===null||s===void 0||s.call(n,e):(l=(o=this.activeAgentFuture)===null||o===void 0?void 0:o.reject)===null||l===void 0||l.call(o,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Tn),this.activeAgentFuture.promise)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(s=>{const o=s.track;o&&(e instanceof MediaStreamTrack?(di(o)||$i(o))&&o.mediaStreamTrack===e&&(n=s):e===o&&(n=s))}),n}waitForPendingPublicationOfSource(e){return C(this,void 0,void 0,function*(){const s=Date.now();for(;Date.now()<s+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(l=>{let[u]=l;return u.source===e});if(o)return o[1];yield Pt(20)}})}}class QA extends hi{constructor(e,n,s,o){super(e,n.sid,n.name,o),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=l=>{this.setTrack(void 0),this.emit(ie.Ended,l)},this.handleVisibilityChange=l=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(l),this.logContext),this.visible=l,this.emitTrackUpdate()},this.handleVideoDimensionsChange=l=>{this.log.debug("adaptivestream video dimensions ".concat(l.width,"x").concat(l.height),this.logContext),this.videoDimensionsAdaptiveStream=l,this.emitTrackUpdate()},this.subscribed=s,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,s=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new bc({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Nb({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ie.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(s)}get subscriptionStatus(){return this.subscribed===!1?hi.SubscriptionStatus.Unsubscribed:super.isSubscribed?hi.SubscriptionStatus.Subscribed:hi.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?hi.PermissionStatus.Allowed:hi.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,s;this.isManualOperationAllowed()&&(((n=this.requestedVideoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((s=this.requestedVideoDimensions)===null||s===void 0?void 0:s.height)===e.height||(dh(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&dh(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:ln.HIGH}setTrack(e){const n=this.subscriptionStatus,s=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off(ie.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off(ie.VisibilityChanged,this.handleVisibilityChange),o.off(ie.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit(ie.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ie.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ie.VisibilityChanged,this.handleVisibilityChange),e.on(ie.Ended,this.handleEnded),this.emit(ie.Subscribed,e)),this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,s=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ie.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ie.Muted:ie.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ie.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ie.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return dh(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new zb({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Z.Kind.Video){let n=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(n)Q0(this.videoDimensionsAdaptiveStream,n)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const s=zR(this.trackInfo,this.requestedMaxQuality);s&&Q0(this.videoDimensionsAdaptiveStream,s)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream;n?(e.width=Math.ceil(n.width),e.height=Math.ceil(n.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:ln.HIGH})),e.quality=ln.HIGH)}this.emit(ie.UpdateSettings,e)}}class cc extends KS{static fromParticipantInfo(e,n,s){return new cc(e,n.sid,n.identity,n.name,n.metadata,n.attributes,s,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,s,o,l,u,d){let f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Zr.STANDARD;super(n,s||"",o,l,u,d,f),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ie.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),_e(e)),{settings:n})),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ie.UpdateSubscription,n=>{n.participantTracks.forEach(s=>{s.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ie.SubscriptionPermissionChanged,n=>{this.emit(oe.TrackSubscriptionPermissionChanged,e,n)}),e.on(ie.SubscriptionStatusChanged,n=>{this.emit(oe.TrackSubscriptionStatusChanged,e,n)}),e.on(ie.Subscribed,n=>{this.emit(oe.TrackSubscribed,n,e)}),e.on(ie.Unsubscribed,n=>{this.emit(oe.TrackUnsubscribed,n,e)}),e.on(ie.SubscriptionFailed,n=>{this.emit(oe.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z.Source.Microphone;this.volumeMap.set(n,e);const s=this.getTrackPublication(n);s&&s.track&&s.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Z.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,s,o,l,u){let d=this.getTrackPublicationBySid(n);if(d||n.startsWith("TR")||this.trackPublications.forEach(g=>{!d&&e.kind===g.kind.toString()&&(d=g)}),!d){if(u===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(oe.TrackSubscriptionFailed,n);return}u===void 0&&(u=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,s,o,l,u-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),_e(d))),this.emit(oe.TrackSubscriptionFailed,n);return}const f=e.kind==="video";let m;return f?m=new FA(e,n,o,l):m=new qA(e,n,o,this.audioContext,this.audioOutput),m.source=d.source,m.isMuted=d.isMuted,m.setMediaStream(s),m.start(),d.setTrack(m),this.volumeMap.has(d.source)&&qh(m)&&qn(m)&&m.setVolume(this.volumeMap.get(d.source)),d}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,s=new Map;return e.tracks.forEach(o=>{var l,u;let d=this.getTrackPublicationBySid(o.sid);if(d)d.updateInfo(o);else{const f=Z.kindFromProto(o.type);if(!f)return;d=new QA(f,o,(l=this.signalClient.connectOptions)===null||l===void 0?void 0:l.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(u=this.loggerOptions)===null||u===void 0?void 0:u.loggerName}),d.updateInfo(o),s.set(o.sid,d);const m=Array.from(this.trackPublications.values()).find(g=>g.source===(d==null?void 0:d.source));m&&d.source!==Z.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(d.source),Object.assign(Object.assign({},this.logContext),{oldTrack:_e(m),newTrack:_e(d)})),this.addTrackPublication(d)}n.set(o.sid,d)}),this.trackPublications.forEach(o=>{n.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),_e(o))),this.unpublishTrack(o.trackSid,!0))}),s.forEach(o=>{this.emit(oe.TrackPublished,o)}),!0}unpublishTrack(e,n){const s=this.trackPublications.get(e);if(!s)return;const{track:o}=s;switch(o&&(o.stop(),s.setTrack(void 0)),this.trackPublications.delete(e),s.kind){case Z.Kind.Audio:this.audioTrackPublications.delete(e);break;case Z.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(oe.TrackUnpublished,s)}setAudioOutput(e){return C(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(s=>{var o;qn(s.track)&&qh(s.track)&&n.push(s.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:s})),super.emit(e,...s)}}var Ue;(function(a){a.Disconnected="disconnected",a.Connecting="connecting",a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting"})(Ue||(Ue={}));const JA=4*1e3;class Is extends Gn.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var n,s,o,l;if(super(),n=this,this.state=Ue.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Ce,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(u,d,f)=>C(this,void 0,void 0,function*(){var m;if(!bR())throw Fn()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const g=yield this.disconnectLock.lock();if(this.state===Ue.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),g(),Promise.resolve();if(this.connectFuture)return g(),this.connectFuture.promise;this.setAndEmitConnectionState(Ue.Connecting),((m=this.regionUrlProvider)===null||m===void 0?void 0:m.getServerUrl().toString())!==u&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),rc(new URL(u))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new ze(u,d):this.regionUrlProvider.updateToken(d),this.regionUrlProvider.fetchRegionSettings().then(T=>{var x;(x=this.regionUrlProvider)===null||x===void 0||x.setServerReportedRegions(T)}).catch(T=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:T}))}));const v=(T,x,E)=>C(this,void 0,void 0,function*(){var D,M;this.abortController&&this.abortController.abort();const Y=new AbortController;this.abortController=Y,g==null||g();try{if(yield Ds.getInstance().getBackOffPromise(u),Y.signal.aborted)throw new Oe("Connection attempt aborted",Se.Cancelled);yield this.attemptConnection(E??u,d,f,Y),this.abortController=void 0,T()}catch(P){if(this.regionUrlProvider&&P instanceof Oe&&P.reason!==Se.Cancelled&&P.reason!==Se.NotAllowed){let A=null;try{this.log.debug("Fetching next region"),A=yield this.regionUrlProvider.getNextBestRegionUrl((D=this.abortController)===null||D===void 0?void 0:D.signal)}catch(N){if(N instanceof Oe&&(N.status===401||N.reason===Se.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),x(N);return}}[Se.InternalError,Se.ServerUnreachable,Se.Timeout].includes(P.reason)&&(this.log.debug("Adding failed connection attempt to back off"),Ds.getInstance().addFailedConnectionAttempt(u)),A&&!(!((M=this.abortController)===null||M===void 0)&&M.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(P.message,". Retrying with another region: ").concat(A),this.logContext),this.recreateEngine(),yield v(T,x,A)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,K0(P)),x(P))}else{let A=Nn.UNKNOWN_REASON;P instanceof Oe&&(A=K0(P)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,A),x(P)}}}),S=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Tn((T,x)=>{v(T,x,S)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(u,d,f,m,g,v)=>C(this,void 0,void 0,function*(){var S,T,x;const E=yield f.join(u,d,{autoSubscribe:m.autoSubscribe,adaptiveStream:typeof g.adaptiveStream=="object"?!0:g.adaptiveStream,maxRetries:m.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:m.websocketTimeout,singlePeerConnection:g.singlePeerConnection},v.signal);let D=E.serverInfo;if(D||(D={version:E.serverVersion,region:E.serverRegion}),this.serverInfo=D,this.log.debug("connected to Livekit Server ".concat(Object.entries(D).map(M=>{let[Y,P]=M;return"".concat(Y,": ").concat(P)}).join(", ")),{room:(S=E.room)===null||S===void 0?void 0:S.name,roomSid:(T=E.room)===null||T===void 0?void 0:T.sid,identity:(x=E.participant)===null||x===void 0?void 0:x.identity}),!D.version)throw new iR("unknown server version");return D.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),g.dynacast=!1),E}),this.applyJoinResponse=u=>{const d=u.participant;if(this.localParticipant.sid=d.sid,this.localParticipant.identity=d.identity,this.localParticipant.setEnabledPublishCodecs(u.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(u.sifTrailer)}catch(f){this.log.error(f instanceof Error?f.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:f}))}this.handleParticipantUpdates([d,...u.otherParticipants]),u.room&&this.handleRoomUpdate(u.room)},this.attemptConnection=(u,d,f,m)=>C(this,void 0,void 0,function*(){var g,v;this.state===Ue.Reconnecting||this.isResuming||!((g=this.engine)===null||g===void 0)&&g.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((v=this.regionUrlProvider)===null||v===void 0)&&v.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},_f),f),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const S=yield this.connectSignal(u,d,this.engine,this.connOptions,this.options,m);this.applyJoinResponse(S),this.setupLocalParticipantEvents(),this.emit(te.SignalConnected)}catch(S){yield this.engine.close(),this.recreateEngine();const T=new Oe("could not establish signal connection",m.signal.aborted?Se.Cancelled:Se.ServerUnreachable);throw S instanceof Error&&(T.message="".concat(T.message,": ").concat(S.message)),S instanceof Oe&&(T.reason=S.reason,T.status=S.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:S})),T}if(m.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Oe("Connection attempt aborted",Se.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,m)}catch(S){throw yield this.engine.close(),this.recreateEngine(),S}Jt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Jt()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ue.Connected),this.emit(te.Connected),Ds.getInstance().resetFailedConnectionAttempts(u),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var u=arguments.length,d=new Array(u),f=0;f<u;f++)d[f]=arguments[f];return C(n,[...d],void 0,function(){var m=this;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var v,S,T;const x=yield m.disconnectLock.lock();try{if(m.state===Ue.Disconnected){m.log.debug("already disconnected",m.logContext);return}if(m.log.info("disconnect from room",Object.assign({},m.logContext)),m.state===Ue.Connecting||m.state===Ue.Reconnecting||m.isResuming){const E="Abort connection attempt due to user initiated disconnect";m.log.warn(E,m.logContext),(v=m.abortController)===null||v===void 0||v.abort(E),(T=(S=m.connectFuture)===null||S===void 0?void 0:S.reject)===null||T===void 0||T.call(S,new Oe("Client initiated disconnect",Se.Cancelled)),m.connectFuture=void 0}m.engine&&(m.engine.client.isDisconnected||(yield m.engine.client.sendLeave()),yield m.engine.close()),m.handleDisconnect(g,Nn.CLIENT_INITIATED),m.engine=void 0}finally{x()}})()})},this.onPageLeave=()=>C(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>C(this,void 0,void 0,function*(){const u=[],d=Xt();if(d&&d.os==="iOS"){const f="livekit-dummy-audio-el";let m=document.getElementById(f);if(!m){m=document.createElement("audio"),m.id=f,m.autoplay=!0,m.hidden=!0;const g=uh();g.enabled=!0;const v=new MediaStream([g]);m.srcObject=v,document.addEventListener("visibilitychange",()=>{m&&(m.srcObject=document.hidden?null:v,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(m),this.once(te.Disconnected,()=>{m==null||m.remove(),m=null})}u.push(m)}this.remoteParticipants.forEach(f=>{f.audioTrackPublications.forEach(m=>{m.track&&m.track.attachedElements.forEach(g=>{u.push(g)})})});try{yield Promise.all([this.acquireAudioContext(),...u.map(f=>(f.muted=!1,f.play()))]),this.handleAudioPlaybackStarted()}catch(f){throw this.handleAudioPlaybackFailed(f),f}}),this.startVideo=()=>C(this,void 0,void 0,function*(){const u=[];for(const d of this.remoteParticipants.values())d.videoTrackPublications.forEach(f=>{var m;(m=f.track)===null||m===void 0||m.attachedElements.forEach(g=>{u.includes(g)||u.push(g)})});yield Promise.all(u.map(d=>d.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(d=>{d.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const u of this.remoteParticipants.values())this.handleParticipantDisconnected(u.identity,u);this.setAndEmitConnectionState(Ue.Reconnecting)&&this.emit(te.Reconnecting)},this.handleSignalRestarted=u=>C(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(u.serverRegion),Object.assign(Object.assign({},this.logContext),{region:u.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(u);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(d){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:d}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:u.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ue.Connected),this.emit(te.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=u=>{u.forEach(d=>{var f;if(d.identity===this.localParticipant.identity){this.localParticipant.updateInfo(d);return}d.identity===""&&(d.identity=(f=this.sidToIdentity.get(d.sid))!==null&&f!==void 0?f:"");let m=this.remoteParticipants.get(d.identity);d.state===Rs.DISCONNECTED?this.handleParticipantDisconnected(d.identity,m):m=this.getOrCreateParticipant(d.identity,d)})},this.handleActiveSpeakersUpdate=u=>{const d=[],f={};u.forEach(m=>{if(f[m.sid]=!0,m.sid===this.localParticipant.sid)this.localParticipant.audioLevel=m.level,this.localParticipant.setIsSpeaking(!0),d.push(this.localParticipant);else{const g=this.getRemoteParticipantBySid(m.sid);g&&(g.audioLevel=m.level,g.setIsSpeaking(!0),d.push(g))}}),f[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(m=>{f[m.sid]||(m.audioLevel=0,m.setIsSpeaking(!1))}),this.activeSpeakers=d,this.emitWhenConnected(te.ActiveSpeakersChanged,d)},this.handleSpeakersChanged=u=>{const d=new Map;this.activeSpeakers.forEach(m=>{const g=this.remoteParticipants.get(m.identity);g&&g.sid!==m.sid||d.set(m.sid,m)}),u.forEach(m=>{let g=this.getRemoteParticipantBySid(m.sid);m.sid===this.localParticipant.sid&&(g=this.localParticipant),g&&(g.audioLevel=m.level,g.setIsSpeaking(m.active),m.active?d.set(m.sid,g):d.delete(m.sid))});const f=Array.from(d.values());f.sort((m,g)=>g.audioLevel-m.audioLevel),this.activeSpeakers=f,this.emitWhenConnected(te.ActiveSpeakersChanged,f)},this.handleStreamStateUpdate=u=>{u.streamStates.forEach(d=>{const f=this.getRemoteParticipantBySid(d.participantSid);if(!f)return;const m=f.getTrackPublicationBySid(d.trackSid);if(!m||!m.track)return;const g=Z.streamStateFromProto(d.state);m.track.setStreamState(g),g!==m.track.streamState&&(f.emit(oe.TrackStreamStateChanged,m,m.track.streamState),this.emitWhenConnected(te.TrackStreamStateChanged,m,m.track.streamState,f))})},this.handleSubscriptionPermissionUpdate=u=>{const d=this.getRemoteParticipantBySid(u.participantSid);if(!d)return;const f=d.getTrackPublicationBySid(u.trackSid);f&&f.setAllowed(u.allowed)},this.handleSubscriptionError=u=>{const d=Array.from(this.remoteParticipants.values()).find(m=>m.trackPublications.has(u.trackSid));if(!d)return;const f=d.getTrackPublicationBySid(u.trackSid);f&&f.setSubscriptionError(u.err)},this.handleDataPacket=(u,d)=>{const f=this.remoteParticipants.get(u.participantIdentity);if(u.value.case==="user")this.handleUserPacket(f,u.value.value,u.kind,d);else if(u.value.case==="transcription")this.handleTranscription(f,u.value.value);else if(u.value.case==="sipDtmf")this.handleSipDtmf(f,u.value.value);else if(u.value.case==="chatMessage")this.handleChatMessage(f,u.value.value);else if(u.value.case==="metrics")this.handleMetrics(u.value.value,f);else if(u.value.case==="streamHeader"||u.value.case==="streamChunk"||u.value.case==="streamTrailer")this.handleDataStream(u,d);else if(u.value.case==="rpcRequest"){const m=u.value.value;this.handleIncomingRpcRequest(u.participantIdentity,m.id,m.method,m.payload,m.responseTimeoutMs,m.version)}},this.handleUserPacket=(u,d,f,m)=>{this.emit(te.DataReceived,d.payload,u,f,d.topic,m),u==null||u.emit(oe.DataReceived,d.payload,f,m)},this.handleSipDtmf=(u,d)=>{this.emit(te.SipDTMFReceived,d,u),u==null||u.emit(oe.SipDTMFReceived,d)},this.handleTranscription=(u,d)=>{const f=d.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(d.transcribedParticipantIdentity),m=f==null?void 0:f.trackPublications.get(d.trackId),g=RR(d,this.transcriptionReceivedTimes);m==null||m.emit(ie.TranscriptionReceived,g),f==null||f.emit(oe.TranscriptionReceived,g,m),this.emit(te.TranscriptionReceived,g,f,m)},this.handleChatMessage=(u,d)=>{const f=AR(d);this.emit(te.ChatMessage,f,u)},this.handleMetrics=(u,d)=>{this.emit(te.MetricsReceived,u,d)},this.handleDataStream=(u,d)=>{this.incomingDataStreamManager.handleDataStreamPacket(u,d)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(te.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=u=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:u})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(te.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(te.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(te.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>C(this,void 0,void 0,function*(){var u;((u=Xt())===null||u===void 0?void 0:u.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(te.MediaDevicesChanged)}),this.handleRoomUpdate=u=>{const d=this.roomInfo;this.roomInfo=u,d&&d.metadata!==u.metadata&&this.emitWhenConnected(te.RoomMetadataChanged,u.metadata),(d==null?void 0:d.activeRecording)!==u.activeRecording&&this.emitWhenConnected(te.RecordingStatusChanged,u.activeRecording)},this.handleConnectionQualityUpdate=u=>{u.updates.forEach(d=>{if(d.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(d.quality);return}const f=this.getRemoteParticipantBySid(d.participantSid);f&&f.setConnectionQuality(d.quality)})},this.onLocalParticipantMetadataChanged=u=>{this.emit(te.ParticipantMetadataChanged,u,this.localParticipant)},this.onLocalParticipantNameChanged=u=>{this.emit(te.ParticipantNameChanged,u,this.localParticipant)},this.onLocalAttributesChanged=u=>{this.emit(te.ParticipantAttributesChanged,u,this.localParticipant)},this.onLocalTrackMuted=u=>{this.emit(te.TrackMuted,u,this.localParticipant)},this.onLocalTrackUnmuted=u=>{this.emit(te.TrackUnmuted,u,this.localParticipant)},this.onTrackProcessorUpdate=u=>{var d;(d=u==null?void 0:u.onPublish)===null||d===void 0||d.call(u,this)},this.onLocalTrackPublished=u=>C(this,void 0,void 0,function*(){var d,f,m,g,v,S;(d=u.track)===null||d===void 0||d.on(ie.TrackProcessorUpdate,this.onTrackProcessorUpdate),(f=u.track)===null||f===void 0||f.on(ie.Restarted,this.onLocalTrackRestarted),(v=(g=(m=u.track)===null||m===void 0?void 0:m.getProcessor())===null||g===void 0?void 0:g.onPublish)===null||v===void 0||v.call(g,this),this.emit(te.LocalTrackPublished,u,this.localParticipant),di(u.track)&&(yield u.track.checkForSilence())&&this.emit(te.LocalAudioSilenceDetected,u);const T=yield(S=u.track)===null||S===void 0?void 0:S.getDeviceId(!1),x=Vh(u.source);x&&T&&T!==this.localParticipant.activeDeviceMap.get(x)&&(this.localParticipant.activeDeviceMap.set(x,T),this.emit(te.ActiveDeviceChanged,x,T))}),this.onLocalTrackUnpublished=u=>{var d,f;(d=u.track)===null||d===void 0||d.off(ie.TrackProcessorUpdate,this.onTrackProcessorUpdate),(f=u.track)===null||f===void 0||f.off(ie.Restarted,this.onLocalTrackRestarted),this.emit(te.LocalTrackUnpublished,u,this.localParticipant)},this.onLocalTrackRestarted=u=>C(this,void 0,void 0,function*(){const d=yield u.getDeviceId(!1),f=Vh(u.source);f&&d&&d!==this.localParticipant.activeDeviceMap.get(f)&&(this.log.debug("local track restarted, setting ".concat(f," ").concat(d," active"),this.logContext),this.localParticipant.activeDeviceMap.set(f,d),this.emit(te.ActiveDeviceChanged,f,d))}),this.onLocalConnectionQualityChanged=u=>{this.emit(te.ConnectionQualityChanged,u,this.localParticipant)},this.onMediaDevicesError=(u,d)=>{this.emit(te.MediaDevicesError,u,d)},this.onLocalParticipantPermissionsChanged=u=>{this.emit(te.ParticipantPermissionsChanged,u,this.localParticipant)},this.onLocalChatMessageSent=u=>{this.emit(te.ChatMessage,u,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},cA),e),this.log=ki((s=this.options.loggerName)!==null&&s!==void 0?s:Dn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},IS),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},jS),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},lA),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new jA,this.outgoingDataStreamManager=new zA(this.engine,this.log),this.disconnectLock=new Bt,this.localParticipant=new KA("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",sa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",sa(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",sa(this.options.audioOutput.deviceId)).catch(u=>this.log.warn("Could not set audio output: ".concat(u.message),this.logContext)),Jt()){const u=new AbortController;(l=navigator.mediaDevices)===null||l===void 0||l.addEventListener("devicechange",this.handleDeviceChange,{signal:u.signal}),Is.cleanupRegistry&&Is.cleanupRegistry.register(this,()=>{u.abort()})}}registerTextStreamHandler(e,n){return this.incomingDataStreamManager.registerTextStreamHandler(e,n)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,n){return this.incomingDataStreamManager.registerByteStreamHandler(e,n)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return C(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const n=!!this.options.encryption,s=this.options.encryption||this.options.e2ee;s&&("e2eeManager"in s?(this.e2eeManager=s.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=n):this.e2eeManager=new qR(s,n),this.e2eeManager.on(na.ParticipantEncryptionStatusChanged,(o,l)=>{NR(l)&&(this.isE2EEEnabled=o),this.emit(te.ParticipantEncryptionStatusChanged,o,l)}),this.e2eeManager.on(na.EncryptionError,(o,l)=>{const u=l?this.getParticipantByIdentity(l):void 0;this.emit(te.EncryptionError,o,u)}),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return C(this,void 0,void 0,function*(){return this.state===Ue.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const s=o=>{o.sid!==""&&(this.engine.off(re.RoomUpdate,s),e(o.sid))};this.engine.on(re.RoomUpdate,s),this.once(te.Disconnected,()=>{this.engine.off(re.RoomUpdate,s),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new DA(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(re.ParticipantUpdate,this.handleParticipantUpdates).on(re.RoomUpdate,this.handleRoomUpdate).on(re.SpeakersChanged,this.handleSpeakersChanged).on(re.StreamStateChanged,this.handleStreamStateUpdate).on(re.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(re.SubscriptionError,this.handleSubscriptionError).on(re.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(re.MediaTrackAdded,(e,n,s)=>{this.onTrackAdded(e,n,s)}).on(re.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(re.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(re.DataPacketReceived,this.handleDataPacket).on(re.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ue.SignalReconnecting)&&this.emit(te.SignalReconnecting)}).on(re.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ue.Connected)&&this.emit(te.Reconnected)}).on(re.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ue.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(re.Restarting,this.handleRestarting).on(re.SignalRestarted,this.handleSignalRestarted).on(re.Offline,()=>{this.setAndEmitConnectionState(Ue.Reconnecting)&&this.emit(te.Reconnecting)}).on(re.DCBufferStatusChanged,(e,n)=>{this.emit(te.DCBufferStatusChanged,e,n)}).on(re.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(s=>{let{trackSid:o}=s;return o===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(oe.LocalTrackSubscribed,n),this.emitWhenConnected(te.LocalTrackSubscribed,n,this.localParticipant)}).on(re.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((n,s)=>{this.handleParticipantDisconnected(s,n)}),this.emit(te.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return wt.getInstance().getDevices(e,n)}prepareConnection(e,n){return C(this,void 0,void 0,function*(){if(this.state===Ue.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(rc(new URL(e))&&n){this.regionUrlProvider=new ze(e,n);const s=yield this.regionUrlProvider.getNextBestRegionUrl();s&&this.state===Ue.Disconnected&&(this.regionUrl=s,yield fetch(no(s),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(s),this.logContext))}else yield fetch(no(e),{method:"HEAD"})}catch(s){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:s}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return C(this,void 0,void 0,function*(){let s=()=>C(this,void 0,void 0,function*(){}),o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new Bn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new Bn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new Bn({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new Bn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":s=()=>C(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new Bn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":s=()=>C(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new Bn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new Bn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),s=()=>C(this,void 0,void 0,function*(){const l=this.engine.client.onLeave;l&&l(new Sc({reason:Nn.CLIENT_INITIATED,action:As.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new Bn({scenario:{case:"subscriberBandwidth",value:Na(n)}});break;case"leave-full-reconnect":o=new Bn({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield s())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return C(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(function*(){var d,f,m,g,v,S,T;let x=!0,E=!1;const D=u?{exact:o}:o;if(s==="audioinput"){E=l.localParticipant.audioTrackPublications.size===0;const M=(d=l.getActiveDevice(s))!==null&&d!==void 0?d:l.options.audioCaptureDefaults.deviceId;l.options.audioCaptureDefaults.deviceId=D;const Y=Array.from(l.localParticipant.audioTrackPublications.values()).filter(A=>A.source===Z.Source.Microphone);try{x=(yield Promise.all(Y.map(A=>{var N;return(N=A.audioTrack)===null||N===void 0?void 0:N.setDeviceId(D)}))).every(A=>A===!0)}catch(A){throw l.options.audioCaptureDefaults.deviceId=M,A}const P=Y.some(A=>{var N,V;return(V=(N=A.track)===null||N===void 0?void 0:N.isMuted)!==null&&V!==void 0?V:!1});x&&P&&(E=!0)}else if(s==="videoinput"){E=l.localParticipant.videoTrackPublications.size===0;const M=(f=l.getActiveDevice(s))!==null&&f!==void 0?f:l.options.videoCaptureDefaults.deviceId;l.options.videoCaptureDefaults.deviceId=D;const Y=Array.from(l.localParticipant.videoTrackPublications.values()).filter(A=>A.source===Z.Source.Camera);try{x=(yield Promise.all(Y.map(A=>{var N;return(N=A.videoTrack)===null||N===void 0?void 0:N.setDeviceId(D)}))).every(A=>A===!0)}catch(A){throw l.options.videoCaptureDefaults.deviceId=M,A}const P=Y.some(A=>{var N,V;return(V=(N=A.track)===null||N===void 0?void 0:N.isMuted)!==null&&V!==void 0?V:!1});x&&P&&(E=!0)}else if(s==="audiooutput"){if(E=!0,!zh()&&!l.options.webAudioMix||l.options.webAudioMix&&l.audioContext&&!("setSinkId"in l.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");l.options.webAudioMix&&(o=(m=yield wt.getInstance().normalizeDeviceId("audiooutput",o))!==null&&m!==void 0?m:""),(g=(T=l.options).audioOutput)!==null&&g!==void 0||(T.audioOutput={});const M=(v=l.getActiveDevice(s))!==null&&v!==void 0?v:l.options.audioOutput.deviceId;l.options.audioOutput.deviceId=o;try{l.options.webAudioMix&&((S=l.audioContext)===null||S===void 0||S.setSinkId(o)),yield Promise.all(Array.from(l.remoteParticipants.values()).map(Y=>Y.setAudioOutput({deviceId:o})))}catch(Y){throw l.options.audioOutput.deviceId=M,Y}}return E&&(l.localParticipant.activeDeviceMap.set(s,o),l.emit(te.ActiveDeviceChanged,s,o)),x})()})}setupLocalParticipantEvents(){this.localParticipant.on(oe.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(oe.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(oe.AttributesChanged,this.onLocalAttributesChanged).on(oe.TrackMuted,this.onLocalTrackMuted).on(oe.TrackUnmuted,this.onLocalTrackUnmuted).on(oe.LocalTrackPublished,this.onLocalTrackPublished).on(oe.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(oe.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(oe.MediaDevicesError,this.onMediaDevicesError).on(oe.AudioStreamAcquired,this.startAudio).on(oe.ChatMessage,this.onLocalChatMessageSent).on(oe.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,s){if(this.state===Ue.Connecting||this.state===Ue.Reconnecting){const v=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:n.id,tracksInStream:n.getTracks().map(T=>T.id)}),this.onTrackAdded(e,n,s),S()},S=()=>{this.off(te.Reconnected,v),this.off(te.Connected,v),this.off(te.Disconnected,S)};this.once(te.Reconnected,v),this.once(te.Connected,v),this.once(te.Disconnected,S);return}if(this.state===Ue.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=gR(n.id),l=o[0];let u=o[1],d=e.id;if(u&&u.startsWith("TR")&&(d=u),l===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const f=Array.from(this.remoteParticipants.values()).find(v=>v.sid===l);if(!f){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(l),this.logContext);return}if(!d.startsWith("TR")){const v=this.engine.getTrackIdForReceiver(s);if(!v){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(l),this.logContext);return}d=v}d.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(l,", streamId: ").concat(u,", trackId: ").concat(d),Object.assign(Object.assign({},this.logContext),{rpID:l,streamId:u,trackId:d}));let m;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?m=this.options.adaptiveStream:m={});const g=f.addSubscribedMediaTrack(e,d,n,s,m);g!=null&&g.isEncrypted&&!this.e2eeManager&&this.emit(te.EncryptionError,new Error("Encrypted ".concat(g.source," track received from participant ").concat(f.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var s;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==Ue.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{o.unpublishTrack(l.trackSid)})}),this.localParticipant.trackPublications.forEach(o=>{var l,u,d;o.track&&this.localParticipant.unpublishTrack(o.track,e),e?((l=o.track)===null||l===void 0||l.detach(),(u=o.track)===null||u===void 0||u.stop()):(d=o.track)===null||d===void 0||d.stopMonitor()}),this.localParticipant.off(oe.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(oe.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(oe.AttributesChanged,this.onLocalAttributesChanged).off(oe.TrackMuted,this.onLocalTrackMuted).off(oe.TrackUnmuted,this.onLocalTrackUnmuted).off(oe.LocalTrackPublished,this.onLocalTrackPublished).off(oe.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(oe.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(oe.MediaDevicesError,this.onMediaDevicesError).off(oe.AudioStreamAcquired,this.startAudio).off(oe.ChatMessage,this.onLocalChatMessageSent).off(oe.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Jt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(s=navigator.mediaDevices)===null||s===void 0||s.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ue.Disconnected),this.emit(te.Disconnected,n)}}}handleParticipantDisconnected(e,n){var s;this.remoteParticipants.delete(e),n&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),n.trackPublications.forEach(o=>{n.unpublishTrack(o.trackSid,!0)}),this.emit(te.ParticipantDisconnected,n),n.setDisconnected(),(s=this.localParticipant)===null||s===void 0||s.handleParticipantDisconnected(n.identity))}handleIncomingRpcRequest(e,n,s,o,l,u){return C(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),u!==1){yield this.engine.publishRpcResponse(e,n,null,ct.builtIn("UNSUPPORTED_VERSION"));return}const d=this.rpcHandlers.get(s);if(!d){yield this.engine.publishRpcResponse(e,n,null,ct.builtIn("UNSUPPORTED_METHOD"));return}let f=null,m=null;try{const g=yield d({requestId:n,callerIdentity:e,payload:o,responseTimeout:l});Rf(g)>BS?(f=ct.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(s))):m=g}catch(g){g instanceof ct?f=g:(console.warn("Uncaught error returned by RPC handler for ".concat(s,". Returning APPLICATION_ERROR instead."),g),f=ct.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,m,f)})}selectDefaultDevices(){return C(this,void 0,void 0,function*(){var e,n,s;const o=wt.getInstance().previousDevices,l=yield wt.getInstance().getDevices(void 0,!1),u=Xt();if((u==null?void 0:u.name)==="Chrome"&&u.os!=="iOS")for(let f of l){const m=o.find(g=>g.deviceId===f.deviceId);m&&m.label!==""&&m.kind===f.kind&&m.label!==f.label&&this.getActiveDevice(f.kind)==="default"&&this.emit(te.ActiveDeviceChanged,f.kind,f.deviceId)}const d=["audiooutput","audioinput","videoinput"];for(let f of d){const m=PR(f),g=this.localParticipant.getTrackPublication(m);if(g&&(!((e=g.track)===null||e===void 0)&&e.isUserProvided))continue;const v=l.filter(T=>T.kind===f),S=this.getActiveDevice(f);if(S===((n=o.filter(T=>T.kind===f)[0])===null||n===void 0?void 0:n.deviceId)&&v.length>0&&((s=v[0])===null||s===void 0?void 0:s.deviceId)!==S){yield this.switchActiveDevice(f,v[0].deviceId);continue}f==="audioinput"&&!to()||f==="videoinput"||v.length>0&&!v.find(T=>T.deviceId===this.getActiveDevice(f))&&(f!=="audiooutput"||!to())&&(yield this.switchActiveDevice(f,v[0].deviceId))}})}acquireAudioContext(){return C(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=DS())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Pt(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const s=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";s!==this.canPlaybackAudio&&(this.audioEnabled=s,this.emit(te.AudioPlaybackStatusChanged,s))})}createParticipant(e,n){var s;let o;return n?o=cc.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new cc(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((s=this.options.audioOutput)===null||s===void 0)&&s.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),o}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return n&&o.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),o}const s=this.createParticipant(e,n);return this.remoteParticipants.set(e,s),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(te.ParticipantConnected,s),s.on(oe.TrackPublished,o=>{this.emitWhenConnected(te.TrackPublished,o,s)}).on(oe.TrackSubscribed,(o,l)=>{o.kind===Z.Kind.Audio?(o.on(ie.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on(ie.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===Z.Kind.Video&&(o.on(ie.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on(ie.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(te.TrackSubscribed,o,l,s)}).on(oe.TrackUnpublished,o=>{this.emit(te.TrackUnpublished,o,s)}).on(oe.TrackUnsubscribed,(o,l)=>{this.emit(te.TrackUnsubscribed,o,l,s)}).on(oe.TrackMuted,o=>{this.emitWhenConnected(te.TrackMuted,o,s)}).on(oe.TrackUnmuted,o=>{this.emitWhenConnected(te.TrackUnmuted,o,s)}).on(oe.ParticipantMetadataChanged,o=>{this.emitWhenConnected(te.ParticipantMetadataChanged,o,s)}).on(oe.ParticipantNameChanged,o=>{this.emitWhenConnected(te.ParticipantNameChanged,o,s)}).on(oe.AttributesChanged,o=>{this.emitWhenConnected(te.ParticipantAttributesChanged,o,s)}).on(oe.ConnectionQualityChanged,o=>{this.emitWhenConnected(te.ConnectionQualityChanged,o,s)}).on(oe.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(te.ParticipantPermissionsChanged,o,s)}).on(oe.TrackSubscriptionStatusChanged,(o,l)=>{this.emitWhenConnected(te.TrackSubscriptionStatusChanged,o,l,s)}).on(oe.TrackSubscriptionFailed,(o,l)=>{this.emit(te.TrackSubscriptionFailed,o,s,l)}).on(oe.TrackSubscriptionPermissionChanged,(o,l)=>{this.emitWhenConnected(te.TrackSubscriptionPermissionChanged,o,l,s)}).on(oe.Active,()=>{this.emitWhenConnected(te.ParticipantActive,s),s.kind===Zr.AGENT&&this.localParticipant.setActiveAgent(s)}),n&&s.updateInfo(n),s}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((s,o)=>(s.push(...o.getTrackPublications()),s),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&MR(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Dt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Nn.STATE_MISMATCH))):e=0},JA)}clearConnectionReconcile(){this.connectionReconcileInterval&&Dt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(te.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,s]=e;this.emit(n,...s)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];if(this.state===Ue.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,s]);else if(this.state===Ue.Connected)return this.emit(e,...s);return!1}simulateParticipants(e){return C(this,void 0,void 0,function*(){var n,s;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),l=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new gc({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:it.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Oa({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(te.SignalConnected),this.emit(te.Connected),this.setAndEmitConnectionState(Ue.Connected),o.video){const u=new Qh(Z.Kind.Video,new Es({source:vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Rn.AUDIO,name:"video-dummy"}),new lc(o.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Y0(160*((n=l.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(u),this.localParticipant.emit(oe.LocalTrackPublished,u)}if(o.audio){const u=new Qh(Z.Kind.Audio,new Es({source:vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Rn.AUDIO}),new oc(o.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:uh(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(u),this.localParticipant.emit(oe.LocalTrackPublished,u)}for(let u=0;u<l.count-1;u+=1){let d=new Oa({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(u),state:Rs.ACTIVE,tracks:[],joinedAt:it.parse(Date.now())});const f=this.getOrCreateParticipant(d.identity,d);if(l.video){const m=Y0(160*((s=l.aspectRatios[u%l.aspectRatios.length])!==null&&s!==void 0?s:1),160,!1,!0),g=new Es({source:vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Rn.AUDIO});f.addSubscribedMediaTrack(m,g.sid,new MediaStream([m]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}if(l.audio){const m=uh(),g=new Es({source:vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Rn.AUDIO});f.addSubscribedMediaTrack(m,g.sid,new MediaStream([m]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}f.updateInfo(d)}})}emit(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];if(e!==te.ActiveSpeakersChanged&&e!==te.TranscriptionReceived){const l=QS(s).filter(u=>u!==void 0);(e===te.TrackSubscribed||e===te.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l}))}return super.emit(e,...s)}}Is.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(a=>{a()});function QS(a){return a.map(e=>{if(e)return Array.isArray(e)?QS(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var _n;(function(a){a[a.IDLE=0]="IDLE",a[a.RUNNING=1]="RUNNING",a[a.SKIPPED=2]="SKIPPED",a[a.SUCCESS=3]="SUCCESS",a[a.FAILED=4]="FAILED"})(_n||(_n={}));class ca extends Gn.EventEmitter{constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=_n.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Is(s.roomOptions),this.connectOptions=s.connectOptions,this.options=s}run(e){return C(this,void 0,void 0,function*(){if(this.status!==_n.IDLE)throw Error("check is running already");this.setStatus(_n.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==_n.SKIPPED&&this.setStatus(this.isSuccess()?_n.SUCCESS:_n.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return C(this,void 0,void 0,function*(){return this.room.state===Ue.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return C(this,void 0,void 0,function*(){this.room&&this.room.state!==Ue.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(_n.SKIPPED)}switchProtocol(e){return C(this,void 0,void 0,function*(){let n=!1,s=!1;if(this.room.on(te.Reconnecting,()=>{n=!0}),this.room.once(te.Reconnected,()=>{s=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(l=>setTimeout(l,1e3)),!n)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(s)return;yield Pt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class XA extends ca{get description(){return"Cloud regions"}perform(){return C(this,void 0,void 0,function*(){const e=new ze(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],s=new Set;for(let l=0;l<3;l++){const u=yield e.getNextBestRegionUrl();if(!u)break;if(s.has(u))continue;s.add(u);const d=yield this.checkCloudRegion(u);this.appendMessage("".concat(d.region," RTT: ").concat(d.rtt,"ms, duration: ").concat(d.duration,"ms")),n.push(d)}n.sort((l,u)=>(l.duration-u.duration)*.5+(l.rtt-u.rtt)*.5);const o=n[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return C(this,void 0,void 0,function*(){var n,s;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!o)throw new Error("Region not found");const l=yield this.room.localParticipant.streamText({topic:"test"}),u=1e3,f=1e6/u,m="A".repeat(u),g=Date.now();for(let x=0;x<f;x++)yield l.write(m);yield l.close();const v=Date.now(),S=yield(s=this.room.engine.pcManager)===null||s===void 0?void 0:s.publisher.getStats(),T={region:o,rtt:1e4,duration:v-g};return S==null||S.forEach(x=>{x.type==="candidate-pair"&&x.nominated&&(T.rtt=x.currentRoundTripTime*1e3)}),yield this.disconnect(),T})}}const bh=1e4;class WA extends ca{get description(){return"Connection via UDP vs TCP"}perform(){return C(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const s=this.bestStats;this.appendMessage("upstream bitrate: ".concat((s.bitrateTotal/s.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((s.rttTotal/s.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((s.jitterTotal/s.count*1e3).toFixed(2)," ms")),s.packetsLost>0&&this.appendWarning("packets lost: ".concat((s.packetsLost/s.packetsSent*100).toFixed(2),"%")),s.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((s.qualityLimitationDurations.bandwidth/(bh/1e3)*100).toFixed(2),"%")),s.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((s.qualityLimitationDurations.cpu/(bh/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return C(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const s=n.getContext("2d");if(!s)throw new Error("Could not get canvas context");let o=0;const l=()=>{o=(o+1)%360,s.fillStyle="hsl(".concat(o,", 100%, 50%)"),s.fillRect(0,0,n.width,n.height),requestAnimationFrame(l)};l();const d=n.captureStream(30).getVideoTracks()[0],m=(yield this.room.localParticipant.publishTrack(d,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,g={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},v=setInterval(()=>C(this,void 0,void 0,function*(){const S=yield m.getRTCStatsReport();S==null||S.forEach(T=>{T.type==="outbound-rtp"?(g.packetsSent=T.packetsSent,g.qualityLimitationDurations=T.qualityLimitationDurations,g.bitrateTotal+=T.targetBitrate,g.count++):T.type==="remote-inbound-rtp"&&(g.packetsLost=T.packetsLost,g.rttTotal+=T.roundTripTime,g.jitterTotal+=T.jitter)})}),1e3);return yield new Promise(S=>setTimeout(S,bh)),clearInterval(v),d.stop(),n.remove(),yield this.disconnect(),g})}}class ZA extends ca{get description(){return"Can publish audio"}perform(){return C(this,void 0,void 0,function*(){var e;const n=yield this.connect(),s=yield YS();if(yield OS(s,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(s),yield new Promise(d=>setTimeout(d,3e3));const l=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!l)throw new Error("Could not get RTCStats");let u=0;if(l.forEach(d=>{d.type==="outbound-rtp"&&(d.kind==="audio"||!d.kind&&d.mediaType==="audio")&&(u=d.packetsSent)}),u===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(u," audio packets"))})}}class $A extends ca{get description(){return"Can publish video"}perform(){return C(this,void 0,void 0,function*(){var e;const n=yield this.connect(),s=yield HA();yield this.checkForVideo(s.mediaStreamTrack),n.localParticipant.publishTrack(s),yield new Promise(u=>setTimeout(u,5e3));const o=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let l=0;if(o.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="video"||!u.kind&&u.mediaType==="video")&&(l+=u.packetsSent)}),l===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(l," video packets"))})}checkForVideo(e){return C(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const s=document.createElement("video");s.srcObject=n,s.muted=!0,s.autoplay=!0,s.playsInline=!0,s.setAttribute("playsinline","true"),document.body.appendChild(s),yield new Promise(o=>{s.onplay=()=>{setTimeout(()=>{var l,u,d,f;const m=document.createElement("canvas"),g=e.getSettings(),v=(u=(l=g.width)!==null&&l!==void 0?l:s.videoWidth)!==null&&u!==void 0?u:1280,S=(f=(d=g.height)!==null&&d!==void 0?d:s.videoHeight)!==null&&f!==void 0?f:720;m.width=v,m.height=S;const T=m.getContext("2d");T.drawImage(s,0,0);const E=T.getImageData(0,0,m.width,m.height).data;let D=!0;for(let M=0;M<E.length;M+=4)if(E[M]!==0||E[M+1]!==0||E[M+2]!==0){D=!1;break}D?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},s.play()}),n.getTracks().forEach(o=>o.stop()),s.remove()})}}class eM extends ca{get description(){return"Resuming connection after interruption"}perform(){return C(this,void 0,void 0,function*(){var e;const n=yield this.connect();let s=!1,o=!1,l;const u=new Promise(m=>{setTimeout(m,5e3),l=m}),d=()=>{s=!0};n.on(te.SignalReconnecting,d).on(te.Reconnecting,d).on(te.Reconnected,()=>{o=!0,l(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const f=n.engine.client.onClose;if(f&&f(""),yield u,s){if(!o||n.state!==Ue.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class tM extends ca{get description(){return"Can connect via TURN"}perform(){return C(this,void 0,void 0,function*(){var e,n;const s=new Cf,o=yield s.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3,singlePeerConnection:!1});let l=!1,u=!1,d=!1;for(let f of o.iceServers)for(let m of f.urls)m.startsWith("turn:")?(u=!0,d=!0):m.startsWith("turns:")&&(u=!0,d=!0,l=!0),m.startsWith("stun:")&&(d=!0);d?u&&!l&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield s.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(f=>setTimeout(f,0)))})}}class nM extends ca{get description(){return"Establishing WebRTC connection"}perform(){return C(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(te.SignalConnected,()=>{var s;const o=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(l,u)=>{if(l.candidate){const d=new RTCIceCandidate(l);let f="".concat(d.protocol," ").concat(d.address,":").concat(d.port," ").concat(d.type);d.address&&(iM(d.address)?f+=" (private)":d.protocol==="tcp"&&d.tcpType==="passive"?(e=!0,f+=" (passive)"):d.protocol==="udp"&&(n=!0)),this.appendMessage(f)}o&&o(l,u)},!((s=this.room.engine.pcManager)===null||s===void 0)&&s.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=l=>{l instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(l.errorCode," ").concat(l.errorText," ").concat(l.url))})});try{yield this.connect(),Ce.info("now the room is connected")}catch(s){throw this.appendWarning("ports need to be open on firewall in order to connect."),s}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function iM(a){const e=a.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class aM extends ca{get description(){return"Connecting to signal connection via WebSocket"}perform(){return C(this,void 0,void 0,function*(){var e,n,s;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new Cf;const l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3,singlePeerConnection:!1});this.appendMessage("Connected to server, version ".concat(l.serverVersion,".")),((e=l.serverInfo)===null||e===void 0?void 0:e.edition)===Db.Cloud&&(!((n=l.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((s=l.serverInfo)===null||s===void 0?void 0:s.region)),yield o.close()})}}class NM extends Gn.EventEmitter{constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=s}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:_n.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==_n.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return C(this,void 0,void 0,function*(){const n=this.getNextCheckId(),s=new e(this.url,this.token,this.options),o=u=>{this.updateCheck(n,u)};s.on("update",o);const l=yield s.run();return s.off("update",o),l})}checkWebsocket(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(aM)})}checkWebRTC(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(nM)})}checkTURN(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(tM)})}checkReconnect(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(eM)})}checkPublishAudio(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(ZA)})}checkPublishVideo(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck($A)})}checkConnectionProtocol(){return C(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(WA);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return C(this,void 0,void 0,function*(){return this.createAndRunCheck(XA)})}}function Ae(a,e,n){return(e=rM(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function sM(a,e){if(typeof a!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var s=n.call(a,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function rM(a){var e=sM(a,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class zt extends Error{constructor(e,n){var s;super(e,n),Ae(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(s=Error.captureStackTrace)===null||s===void 0||s.call(Error,this,this.constructor)}}Ae(zt,"code","ERR_JOSE_GENERIC");class oM extends zt{constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:s,reason:o,payload:n}}),Ae(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),Ae(this,"claim",void 0),Ae(this,"reason",void 0),Ae(this,"payload",void 0),this.claim=s,this.reason=o,this.payload=n}}Ae(oM,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class lM extends zt{constructor(e,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:s,reason:o,payload:n}}),Ae(this,"code","ERR_JWT_EXPIRED"),Ae(this,"claim",void 0),Ae(this,"reason",void 0),Ae(this,"payload",void 0),this.claim=s,this.reason=o,this.payload=n}}Ae(lM,"code","ERR_JWT_EXPIRED");class cM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}Ae(cM,"code","ERR_JOSE_ALG_NOT_ALLOWED");class uM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JOSE_NOT_SUPPORTED")}}Ae(uM,"code","ERR_JOSE_NOT_SUPPORTED");class dM extends zt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",n=arguments.length>1?arguments[1]:void 0;super(e,n),Ae(this,"code","ERR_JWE_DECRYPTION_FAILED")}}Ae(dM,"code","ERR_JWE_DECRYPTION_FAILED");class hM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JWE_INVALID")}}Ae(hM,"code","ERR_JWE_INVALID");class fM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JWS_INVALID")}}Ae(fM,"code","ERR_JWS_INVALID");class mM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JWT_INVALID")}}Ae(mM,"code","ERR_JWT_INVALID");class pM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JWK_INVALID")}}Ae(pM,"code","ERR_JWK_INVALID");class gM extends zt{constructor(){super(...arguments),Ae(this,"code","ERR_JWKS_INVALID")}}Ae(gM,"code","ERR_JWKS_INVALID");class vM extends zt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",n=arguments.length>1?arguments[1]:void 0;super(e,n),Ae(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}Ae(vM,"code","ERR_JWKS_NO_MATCHING_KEY");class yM extends zt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",n=arguments.length>1?arguments[1]:void 0;super(e,n),Ae(this,Symbol.asyncIterator,void 0),Ae(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}Ae(yM,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class bM extends zt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",n=arguments.length>1?arguments[1]:void 0;super(e,n),Ae(this,"code","ERR_JWKS_TIMEOUT")}}Ae(bM,"code","ERR_JWKS_TIMEOUT");class SM extends zt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",n=arguments.length>1?arguments[1]:void 0;super(e,n),Ae(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}Ae(SM,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");function yi(){return yi=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(a[s]=n[s])}return a},yi.apply(null,arguments)}const my=new Uint8Array(0);class io{static getFullOptions(e){return yi({clientTools:{},onConnect:()=>{},onDebug:()=>{},onDisconnect:()=>{},onError:()=>{},onMessage:()=>{},onAudio:()=>{},onModeChange:()=>{},onStatusChange:()=>{},onCanSendFeedbackChange:()=>{},onInterruption:()=>{}},e)}constructor(e,n){var s=this;this.options=void 0,this.connection=void 0,this.lastInterruptTimestamp=0,this.mode="listening",this.status="connecting",this.volume=1,this.currentEventId=1,this.lastFeedbackEventId=0,this.canSendFeedback=!1,this.endSessionWithDetails=async function(o){s.status!=="connected"&&s.status!=="connecting"||(s.updateStatus("disconnecting"),await s.handleEndSession(),s.updateStatus("disconnected"),s.options.onDisconnect&&s.options.onDisconnect(o))},this.onMessage=async function(o){switch(o.type){case"interruption":return void s.handleInterruption(o);case"agent_response":return void s.handleAgentResponse(o);case"user_transcript":return void s.handleUserTranscript(o);case"internal_tentative_agent_response":return void s.handleTentativeAgentResponse(o);case"client_tool_call":try{await s.handleClientToolCall(o)}catch(l){s.onError(`Unexpected error in client tool call handling: ${l instanceof Error?l.message:String(l)}`,{clientToolName:o.client_tool_call.tool_name,toolCallId:o.client_tool_call.tool_call_id})}return;case"audio":return void s.handleAudio(o);case"vad_score":return void s.handleVadScore(o);case"ping":return void s.connection.sendMessage({type:"pong",event_id:o.ping_event.event_id});case"mcp_tool_call":return void s.handleMCPToolCall(o);case"mcp_connection_status":return void s.handleMCPConnectionStatus(o);case"agent_tool_request":return void s.handleAgentToolRequest(o);case"agent_tool_response":return void s.handleAgentToolResponse(o);case"conversation_initiation_metadata":return void s.handleConversationMetadata(o);case"asr_initiation_metadata":return void s.handleAsrInitiationMetadata(o);case"agent_chat_response_part":return void s.handleAgentChatResponsePart(o);case"error":return void s.handleErrorEvent(o);default:return void(s.options.onDebug&&s.options.onDebug(o))}},this.setVolume=({volume:o})=>{this.volume=o},this.options=e,this.connection=n,this.options.onConnect&&this.options.onConnect({conversationId:n.conversationId}),this.connection.onMessage(this.onMessage),this.connection.onDisconnect(this.endSessionWithDetails),this.connection.onModeChange(o=>this.updateMode(o)),this.updateStatus("connected")}endSession(){return this.endSessionWithDetails({reason:"user"})}async handleEndSession(){this.connection.close()}updateMode(e){e!==this.mode&&(this.mode=e,this.options.onModeChange&&this.options.onModeChange({mode:e}))}updateStatus(e){e!==this.status&&(this.status=e,this.options.onStatusChange&&this.options.onStatusChange({status:e}))}updateCanSendFeedback(){const e=this.currentEventId!==this.lastFeedbackEventId;this.canSendFeedback!==e&&(this.canSendFeedback=e,this.options.onCanSendFeedbackChange&&this.options.onCanSendFeedbackChange({canSendFeedback:e}))}handleInterruption(e){e.interruption_event&&(this.lastInterruptTimestamp=e.interruption_event.event_id,this.options.onInterruption&&this.options.onInterruption({event_id:e.interruption_event.event_id}))}handleAgentResponse(e){this.options.onMessage&&this.options.onMessage({source:"ai",message:e.agent_response_event.agent_response})}handleUserTranscript(e){this.options.onMessage&&this.options.onMessage({source:"user",message:e.user_transcription_event.user_transcript})}handleTentativeAgentResponse(e){this.options.onDebug&&this.options.onDebug({type:"tentative_agent_response",response:e.tentative_agent_response_internal_event.tentative_agent_response})}handleVadScore(e){this.options.onVadScore&&this.options.onVadScore({vadScore:e.vad_score_event.vad_score})}async handleClientToolCall(e){if(Object.prototype.hasOwnProperty.call(this.options.clientTools,e.client_tool_call.tool_name))try{var n;const s=(n=await this.options.clientTools[e.client_tool_call.tool_name](e.client_tool_call.parameters))!=null?n:"Client tool execution successful.",o=typeof s=="object"?JSON.stringify(s):String(s);this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:o,is_error:!1})}catch(s){this.onError(`Client tool execution failed with following error: ${s==null?void 0:s.message}`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool execution failed: ${s==null?void 0:s.message}`,is_error:!0})}else{if(this.options.onUnhandledClientToolCall)return void this.options.onUnhandledClientToolCall(e.client_tool_call);this.onError(`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,is_error:!0})}}handleAudio(e){}handleMCPToolCall(e){this.options.onMCPToolCall&&this.options.onMCPToolCall(e.mcp_tool_call)}handleMCPConnectionStatus(e){this.options.onMCPConnectionStatus&&this.options.onMCPConnectionStatus(e.mcp_connection_status)}handleAgentToolRequest(e){this.options.onAgentToolRequest&&this.options.onAgentToolRequest(e.agent_tool_request)}handleAgentToolResponse(e){e.agent_tool_response.tool_name==="end_call"&&this.endSessionWithDetails({reason:"agent",context:new CloseEvent("end_call",{reason:"Agent ended the call"})}),this.options.onAgentToolResponse&&this.options.onAgentToolResponse(e.agent_tool_response)}handleConversationMetadata(e){this.options.onConversationMetadata&&this.options.onConversationMetadata(e.conversation_initiation_metadata_event)}handleAsrInitiationMetadata(e){this.options.onAsrInitiationMetadata&&this.options.onAsrInitiationMetadata(e.asr_initiation_metadata_event)}handleAgentChatResponsePart(e){this.options.onAgentChatResponsePart&&this.options.onAgentChatResponsePart(e.text_response_part)}handleErrorEvent(e){const n=e.error_event.error_type,s=e.error_event.message||e.error_event.reason||"Unknown error";n!=="max_duration_exceeded"?this.onError(`Server error: ${s}`,{errorType:n,code:e.error_event.code,debugMessage:e.error_event.debug_message,details:e.error_event.details}):this.endSessionWithDetails({reason:"error",message:s,context:new Event("max_duration_exceeded")})}onError(e,n){console.error(e,n),this.options.onError&&this.options.onError(e,n)}getId(){return this.connection.conversationId}isOpen(){return this.status==="connected"}setMicMuted(e){this.connection.setMicMuted(e)}getInputByteFrequencyData(){return my}getOutputByteFrequencyData(){return my}getInputVolume(){return 0}getOutputVolume(){return 0}sendFeedback(e){this.canSendFeedback?(this.connection.sendMessage({type:"feedback",score:e?"like":"dislike",event_id:this.currentEventId}),this.lastFeedbackEventId=this.currentEventId,this.updateCanSendFeedback()):console.warn(this.lastFeedbackEventId===0?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")}sendContextualUpdate(e){this.connection.sendMessage({type:"contextual_update",text:e})}sendUserMessage(e){this.connection.sendMessage({type:"user_message",text:e})}sendUserActivity(){this.connection.sendMessage({type:"user_activity"})}sendMCPToolApprovalResult(e,n){this.connection.sendMessage({type:"mcp_tool_approval_result",tool_call_id:e,is_approved:n})}}class JS{constructor(e={}){this.queue=[],this.disconnectionDetails=null,this.onDisconnectCallback=null,this.onMessageCallback=null,this.onModeChangeCallback=null,this.onDebug=void 0,this.onDebug=e.onDebug}debug(e){this.onDebug&&this.onDebug(e)}onMessage(e){this.onMessageCallback=e;const n=this.queue;this.queue=[],n.length>0&&queueMicrotask(()=>{n.forEach(e)})}onDisconnect(e){this.onDisconnectCallback=e;const n=this.disconnectionDetails;n&&queueMicrotask(()=>{e(n)})}onModeChange(e){this.onModeChangeCallback=e}updateMode(e){var n;(n=this.onModeChangeCallback)==null||n.call(this,e)}disconnect(e){var n;this.disconnectionDetails||(this.disconnectionDetails=e,(n=this.onDisconnectCallback)==null||n.call(this,e))}handleMessage(e){this.onMessageCallback?this.onMessageCallback(e):this.queue.push(e)}}function uc(a){const[e,n]=a.split("_");if(!["pcm","ulaw"].includes(e))throw new Error(`Invalid format: ${a}`);const s=Number.parseInt(n);if(Number.isNaN(s))throw new Error(`Invalid sample rate: ${n}`);return{format:e,sampleRate:s}}const XS="0.11.3";function Jh(a){return!!a.type}const WS="conversation_initiation_client_data";function ZS(a){var e;const n={type:WS};var s,o,l,u,d;return a.overrides&&(n.conversation_config_override={agent:{prompt:(s=a.overrides.agent)==null?void 0:s.prompt,first_message:(o=a.overrides.agent)==null?void 0:o.firstMessage,language:(l=a.overrides.agent)==null?void 0:l.language},tts:{voice_id:(u=a.overrides.tts)==null?void 0:u.voiceId},conversation:{text_only:(d=a.overrides.conversation)==null?void 0:d.textOnly}}),a.customLlmExtraBody&&(n.custom_llm_extra_body=a.customLlmExtraBody),a.dynamicVariables&&(n.dynamic_variables=a.dynamicVariables),a.userId&&(n.user_id=a.userId),(e=a.overrides)!=null&&e.client&&(n.source_info={source:a.overrides.client.source,version:a.overrides.client.version}),n}class ao extends JS{constructor(e,n,s,o){super(),this.socket=void 0,this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.socket=e,this.conversationId=n,this.inputFormat=s,this.outputFormat=o,this.socket.addEventListener("error",l=>{setTimeout(()=>this.disconnect({reason:"error",message:"The connection was closed due to a socket error.",context:l}),0)}),this.socket.addEventListener("close",l=>{this.disconnect(l.code===1e3?{reason:"agent",context:l}:{reason:"error",message:l.reason||"The connection was closed by the server.",context:l})}),this.socket.addEventListener("message",l=>{try{const u=JSON.parse(l.data);if(!Jh(u))return void this.debug({type:"invalid_event",message:"Received invalid socket event",data:l.data});this.handleMessage(u)}catch(u){this.debug({type:"parsing_error",message:"Failed to parse socket message",error:u instanceof Error?u.message:String(u),data:l.data})}})}static async create(e){let n=null;try{var s,o,l;const d=(s=e.origin)!=null?s:"wss://api.elevenlabs.io";let f;const m=((o=e.overrides)==null||(o=o.client)==null?void 0:o.version)||XS,g=((l=e.overrides)==null||(l=l.client)==null?void 0:l.source)||"js_sdk";if(e.signedUrl){const Y=e.signedUrl.includes("?")?"&":"?";f=`${e.signedUrl}${Y}source=${g}&version=${m}`}else f=`${d}/v1/convai/conversation?agent_id=${e.agentId}&source=${g}&version=${m}`;const v=["convai"];e.authorization&&v.push(`bearer.${e.authorization}`),n=new WebSocket(f,v);const S=await new Promise((Y,P)=>{n.addEventListener("open",()=>{var A;const N=ZS(e);(A=n)==null||A.send(JSON.stringify(N))},{once:!0}),n.addEventListener("error",A=>{setTimeout(()=>P(A),0)}),n.addEventListener("close",P),n.addEventListener("message",A=>{const N=JSON.parse(A.data);Jh(N)&&(N.type==="conversation_initiation_metadata"?Y(N.conversation_initiation_metadata_event):console.warn("First received message is not conversation metadata."))},{once:!0})}),{conversation_id:T,agent_output_audio_format:x,user_input_audio_format:E}=S,D=uc(E??"pcm_16000"),M=uc(x);return new ao(n,T,D,M)}catch(d){var u;throw(u=n)==null||u.close(),d}}close(){this.socket.close()}sendMessage(e){this.socket.send(JSON.stringify(e))}async setMicMuted(e){console.warn(`WebSocket connection setMicMuted called with ${e}, but this is handled by VoiceConversation`)}}function $S(a){const e=new Uint8Array(a);return window.btoa(String.fromCharCode(...e))}function kM(a){const e=window.atob(a),n=e.length,s=new Uint8Array(n);for(let o=0;o<n;o++)s[o]=e.charCodeAt(o);return s.buffer}const Dl=new Map;function ek(a,e){return async(n,s)=>{const o=Dl.get(a);if(o)return n.addModule(o);if(s)try{return await n.addModule(s),void Dl.set(a,s)}catch(d){throw new Error(`Failed to load the ${a} worklet module from path: ${s}. Error: ${d}`)}const l=new Blob([e],{type:"application/javascript"}),u=URL.createObjectURL(l);try{return await n.addModule(u),void Dl.set(a,u)}catch{URL.revokeObjectURL(u)}try{const d=`data:application/javascript;base64,${btoa(e)}`;await n.addModule(d),Dl.set(a,d)}catch{throw new Error(`Failed to load the ${a} worklet module. Make sure the browser supports AudioWorklets. If you are using a strict CSP, you may need to self-host the worklet files.`)}}}const tk=ek("rawAudioProcessor",`/*
 * ulaw encoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const BIAS = 0x84;
const CLIP = 32635;
const encodeTable = [
  0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,
  4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
];

function encodeSample(sample) {
  let sign;
  let exponent;
  let mantissa;
  let muLawSample;
  sign = (sample >> 8) & 0x80;
  if (sign !== 0) sample = -sample;
  sample = sample + BIAS;
  if (sample > CLIP) sample = CLIP;
  exponent = encodeTable[(sample>>7) & 0xFF];
  mantissa = (sample >> (exponent+3)) & 0x0F;
  muLawSample = ~(sign | (exponent << 4) | mantissa);
  
  return muLawSample;
}

class RawAudioProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
              
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.isMuted = false;
          this.buffer = []; // Initialize an empty buffer
          this.bufferSize = data.sampleRate / 4;
          this.format = data.format;

          if (globalThis.LibSampleRate && sampleRate !== data.sampleRate) {
            globalThis.LibSampleRate.create(1, sampleRate, data.sampleRate).then(resampler => {
              this.resampler = resampler;
            });
          }
          break;
        case "setMuted":
          this.isMuted = data.isMuted;
          break;
      }
    };
  }
  process(inputs) {
    if (!this.buffer) {
      return true;
    }
    
    const input = inputs[0]; // Get the first input node
    if (input.length > 0) {
      let channelData = input[0]; // Get the first channel's data

      // Resample the audio if necessary
      if (this.resampler) {
        channelData = this.resampler.full(channelData);
      }

      // Add channel data to the buffer
      this.buffer.push(...channelData);
      // Get max volume 
      let sum = 0.0;
      for (let i = 0; i < channelData.length; i++) {
        sum += channelData[i] * channelData[i];
      }
      const maxVolume = Math.sqrt(sum / channelData.length);
      // Check if buffer size has reached or exceeded the threshold
      if (this.buffer.length >= this.bufferSize) {
        const float32Array = this.isMuted 
          ? new Float32Array(this.buffer.length)
          : new Float32Array(this.buffer);

        let encodedArray = this.format === "ulaw"
          ? new Uint8Array(float32Array.length)
          : new Int16Array(float32Array.length);

        // Iterate through the Float32Array and convert each sample to PCM16
        for (let i = 0; i < float32Array.length; i++) {
          // Clamp the value to the range [-1, 1]
          let sample = Math.max(-1, Math.min(1, float32Array[i]));

          // Scale the sample to the range [-32768, 32767]
          let value = sample < 0 ? sample * 32768 : sample * 32767;
          if (this.format === "ulaw") {
            value = encodeSample(Math.round(value));
          }

          encodedArray[i] = value;
        }

        // Send the buffered data to the main script
        this.port.postMessage([encodedArray, maxVolume]);

        // Clear the buffer after sending
        this.buffer = [];
      }
    }
    return true; // Continue processing
  }
}
registerProcessor("rawAudioProcessor", RawAudioProcessor);
`);class fi extends JS{constructor(e,n,s,o,l={}){super(l),this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.room=void 0,this.isConnected=!1,this.audioEventId=1,this.audioCaptureContext=null,this.audioElements=[],this.outputDeviceId=null,this.outputAnalyser=null,this.outputFrequencyData=null,this.room=e,this.conversationId=n,this.inputFormat=s,this.outputFormat=o,this.setupRoomEventListeners()}static async create(e){let n;if("conversationToken"in e&&e.conversationToken)n=e.conversationToken;else{if(!("agentId"in e)||!e.agentId)throw new Error("Either conversationToken or agentId is required for WebRTC connection");try{var s,o,l;const m=((s=e.overrides)==null||(s=s.client)==null?void 0:s.version)||XS,g=((o=e.overrides)==null||(o=o.client)==null?void 0:o.source)||"js_sdk",v=`${u=(l=e.origin)!=null?l:"https://api.elevenlabs.io",u.replace(/^wss:\/\//,"https://")}/v1/convai/conversation/token?agent_id=${e.agentId}&source=${g}&version=${m}`,S=await fetch(v);if(!S.ok)throw new Error(`ElevenLabs API returned ${S.status} ${S.statusText}`);if(n=(await S.json()).token,!n)throw new Error("No conversation token received from API")}catch(m){let g=m instanceof Error?m.message:String(m);throw m instanceof Error&&m.message.includes("401")&&(g="Your agent has authentication enabled, but no signed URL or conversation token was provided."),new Error(`Failed to fetch conversation token for agent ${e.agentId}: ${g}`)}}var u;const d=new Is;try{const m=`room_${Date.now()}`,g=uc("pcm_48000"),v=uc("pcm_48000"),S=new fi(d,m,g,v,e),T=e.livekitUrl||"wss://livekit.rtc.elevenlabs.io";var f;await d.connect(T,n),await new Promise(E=>{if(S.isConnected)E();else{const D=()=>{d.off(te.Connected,D),E()};d.on(te.Connected,D)}}),d.name&&(S.conversationId=((f=d.name.match(/(conv_[a-zA-Z0-9]+)/))==null?void 0:f[0])||d.name),await d.localParticipant.setMicrophoneEnabled(!0);const x=ZS(e);return S.debug({type:WS,message:x}),await S.sendMessage(x),S}catch(m){throw await d.disconnect(),m}}setupRoomEventListeners(){var e=this;this.room.on(te.Connected,async function(){e.isConnected=!0,console.info("WebRTC room connected")}),this.room.on(te.Disconnected,n=>{this.isConnected=!1,this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:n==null?void 0:n.toString()})})}),this.room.on(te.ConnectionStateChanged,n=>{n===Ue.Disconnected&&(this.isConnected=!1,this.disconnect({reason:"error",message:`LiveKit connection state changed to ${n}`,context:new Event("connection_state_changed")}))}),this.room.on(te.DataReceived,(n,s)=>{try{const o=JSON.parse(new TextDecoder().decode(n));if(o.type==="audio")return;Jh(o)?this.handleMessage(o):console.warn("Invalid socket event received:",o)}catch(o){console.warn("Failed to parse incoming data message:",o),console.warn("Raw payload:",new TextDecoder().decode(n))}}),this.room.on(te.TrackSubscribed,async function(n,s,o){if(n.kind===Z.Kind.Audio&&o.identity.includes("agent")){const l=n,u=l.attach();if(u.autoplay=!0,u.controls=!1,e.outputDeviceId&&u.setSinkId)try{await u.setSinkId(e.outputDeviceId)}catch(d){console.warn("Failed to set output device for new audio element:",d)}u.style.display="none",document.body.appendChild(u),e.audioElements.push(u),e.audioElements.length===1&&(e.onDebug==null||e.onDebug({type:"audio_element_ready"})),await e.setupAudioCapture(l)}}),this.room.on(te.ActiveSpeakersChanged,async function(n){e.updateMode(n.length>0&&n[0].identity.startsWith("agent")?"speaking":"listening")})}close(){if(this.isConnected){try{this.room.localParticipant.audioTrackPublications.forEach(e=>{e.track&&e.track.stop()})}catch(e){console.warn("Error stopping local tracks:",e)}this.audioCaptureContext&&(this.audioCaptureContext.close().catch(e=>{console.warn("Error closing audio capture context:",e)}),this.audioCaptureContext=null),this.audioElements.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.audioElements=[],this.room.disconnect()}}async sendMessage(e){if(this.isConnected&&this.room.localParticipant){if(!("user_audio_chunk"in e))try{const n=new TextEncoder().encode(JSON.stringify(e));await this.room.localParticipant.publishData(n,{reliable:!0})}catch(n){this.debug({type:"send_message_error",message:{message:e,error:n}}),console.error("Failed to send message via WebRTC:",n)}}else console.warn("Cannot send message: room not connected or no local participant")}getRoom(){return this.room}async setMicMuted(e){if(!this.isConnected||!this.room.localParticipant)return void console.warn("Cannot set microphone muted: room not connected or no local participant");const n=this.room.localParticipant.getTrackPublication(Z.Source.Microphone);if(n!=null&&n.track)try{e?await n.track.mute():await n.track.unmute()}catch{await this.room.localParticipant.setMicrophoneEnabled(!e)}else await this.room.localParticipant.setMicrophoneEnabled(!e)}async setupAudioCapture(e){try{const n=new AudioContext;this.audioCaptureContext=n,this.outputAnalyser=n.createAnalyser(),this.outputAnalyser.fftSize=2048,this.outputAnalyser.smoothingTimeConstant=.8;const s=new MediaStream([e.mediaStreamTrack]),o=n.createMediaStreamSource(s);o.connect(this.outputAnalyser),await tk(n.audioWorklet);const l=new AudioWorkletNode(n,"rawAudioProcessor");this.outputAnalyser.connect(l),l.port.postMessage({type:"setFormat",format:this.outputFormat.format,sampleRate:this.outputFormat.sampleRate}),l.port.onmessage=u=>{const[d,f]=u.data;if(f>.01){const m=$S(d.buffer),g=this.audioEventId++;this.handleMessage({type:"audio",audio_event:{audio_base_64:m,event_id:g}})}},o.connect(l)}catch(n){console.warn("Failed to set up audio capture:",n)}}setAudioVolume(e){this.audioElements.forEach(n=>{n.volume=e})}async setAudioOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");const n=this.audioElements.map(async function(s){try{await s.setSinkId(e)}catch(o){throw console.error("Failed to set sink ID for audio element:",o),o}});await Promise.all(n),this.outputDeviceId=e}async setAudioInputDevice(e){if(!this.isConnected||!this.room.localParticipant)throw new Error("Cannot change input device: room not connected or no local participant");try{const n=this.room.localParticipant.getTrackPublication(Z.Source.Microphone);n!=null&&n.track&&(await n.track.stop(),await this.room.localParticipant.unpublishTrack(n.track));const s={deviceId:{exact:e},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}},o=await YS(s);await this.room.localParticipant.publishTrack(o,{name:"microphone",source:Z.Source.Microphone})}catch(n){console.error("Failed to change input device:",n);try{await this.room.localParticipant.setMicrophoneEnabled(!0)}catch(s){console.error("Failed to recover microphone after device switch error:",s)}throw n}}getOutputByteFrequencyData(){return this.outputAnalyser?(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.outputAnalyser.frequencyBinCount)),this.outputAnalyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData):null}}async function nk(a){const e=(function(n){return n.connectionType?n.connectionType:"conversationToken"in n&&n.conversationToken?"webrtc":"websocket"})(a);switch(e){case"websocket":return ao.create(a);case"webrtc":return fi.create(a);default:throw new Error(`Unknown connection type: ${e}`)}}function ik(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}async function ak(a={default:0,android:3e3}){let e=a.default;var n;if(/android/i.test(navigator.userAgent))e=(n=a.android)!=null?n:e;else if(ik()){var s;e=(s=a.ios)!=null?s:e}e>0&&await new Promise(o=>setTimeout(o,e))}class Nf extends io{static async startSession(e){const n=io.getFullOptions(e);n.onStatusChange&&n.onStatusChange({status:"connecting"}),n.onCanSendFeedbackChange&&n.onCanSendFeedbackChange({canSendFeedback:!1}),n.onModeChange&&n.onModeChange({mode:"listening"}),n.onCanSendFeedbackChange&&n.onCanSendFeedbackChange({canSendFeedback:!1});let s=null;try{return await ak(n.connectionDelay),s=await nk(e),new Nf(n,s)}catch(l){var o;throw n.onStatusChange&&n.onStatusChange({status:"disconnected"}),(o=s)==null||o.close(),l}}}const py={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}};class dc{static async create({sampleRate:e,format:n,preferHeadphonesForIosDevices:s,inputDeviceId:o,workletPaths:l,libsampleratePath:u}){let d=null,f=null;try{const v=yi({sampleRate:{ideal:e}},py);if(ik()&&s){const M=(await window.navigator.mediaDevices.enumerateDevices()).find(Y=>Y.kind==="audioinput"&&["airpod","headphone","earphone"].find(P=>Y.label.toLowerCase().includes(P)));M&&(v.deviceId={ideal:M.deviceId})}o&&(v.deviceId={exact:o});const S=navigator.mediaDevices.getSupportedConstraints().sampleRate;d=new window.AudioContext(S?{sampleRate:e}:{});const T=d.createAnalyser();if(!S){const M=u||"https://cdn.jsdelivr.net/npm/@alexanderolsen/libsamplerate-js@2.1.2/dist/libsamplerate.worklet.js";await d.audioWorklet.addModule(M)}await tk(d.audioWorklet,l==null?void 0:l.rawAudioProcessor);const x=yi({voiceIsolation:!0},v);f=await navigator.mediaDevices.getUserMedia({audio:x});const E=d.createMediaStreamSource(f),D=new AudioWorkletNode(d,"rawAudioProcessor");return D.port.postMessage({type:"setFormat",format:n,sampleRate:e}),E.connect(T),T.connect(D),await d.resume(),new dc(d,T,D,f,E)}catch(v){var m,g;throw(m=f)==null||m.getTracks().forEach(S=>{S.stop()}),(g=d)==null||g.close(),v}}constructor(e,n,s,o,l){this.context=void 0,this.analyser=void 0,this.worklet=void 0,this.inputStream=void 0,this.mediaStreamSource=void 0,this.context=e,this.analyser=n,this.worklet=s,this.inputStream=o,this.mediaStreamSource=l}async close(){this.inputStream.getTracks().forEach(e=>{e.stop()}),this.mediaStreamSource.disconnect(),await this.context.close()}setMuted(e){this.worklet.port.postMessage({type:"setMuted",isMuted:e})}async setInputDevice(e){try{const n=yi({},py);e&&(n.deviceId={exact:e});const s=yi({voiceIsolation:!0},n),o=await navigator.mediaDevices.getUserMedia({audio:s});this.inputStream.getTracks().forEach(l=>{l.stop()}),this.mediaStreamSource.disconnect(),this.inputStream=o,this.mediaStreamSource=this.context.createMediaStreamSource(o),this.mediaStreamSource.connect(this.analyser)}catch(n){throw console.error("Failed to switch input device:",n),n}}}const TM=ek("audioConcatProcessor",`/*
 * ulaw decoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const decodeTable = [0,132,396,924,1980,4092,8316,16764];

function decodeSample(muLawSample) {
  let sign;
  let exponent;
  let mantissa;
  let sample;
  muLawSample = ~muLawSample;
  sign = (muLawSample & 0x80);
  exponent = (muLawSample >> 4) & 0x07;
  mantissa = muLawSample & 0x0F;
  sample = decodeTable[exponent] + (mantissa << (exponent+3));
  if (sign !== 0) sample = -sample;

  return sample;
}

class AudioConcatProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.buffers = []; // Initialize an empty buffer
    this.cursor = 0;
    this.currentBuffer = null;
    this.wasInterrupted = false;
    this.finished = false;
    
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.format = data.format;
          break;
        case "buffer":
          this.wasInterrupted = false;
          this.buffers.push(
            this.format === "ulaw"
              ? new Uint8Array(data.buffer)
              : new Int16Array(data.buffer)
          );
          break;
        case "interrupt":
          this.wasInterrupted = true;
          break;
        case "clearInterrupted":
          if (this.wasInterrupted) {
            this.wasInterrupted = false;
            this.buffers = [];
            this.currentBuffer = null;
          }
      }
    };
  }
  process(_, outputs) {
    let finished = false;
    const output = outputs[0][0];
    for (let i = 0; i < output.length; i++) {
      if (!this.currentBuffer) {
        if (this.buffers.length === 0) {
          finished = true;
          break;
        }
        this.currentBuffer = this.buffers.shift();
        this.cursor = 0;
      }

      let value = this.currentBuffer[this.cursor];
      if (this.format === "ulaw") {
        value = decodeSample(value);
      }
      output[i] = value / 32768;
      this.cursor++;

      if (this.cursor >= this.currentBuffer.length) {
        this.currentBuffer = null;
      }
    }

    if (this.finished !== finished) {
      this.finished = finished;
      this.port.postMessage({ type: "process", finished });
    }

    return true; // Continue processing
  }
}

registerProcessor("audioConcatProcessor", AudioConcatProcessor);
`);class hc{static async create({sampleRate:e,format:n,outputDeviceId:s,workletPaths:o}){let l=null,u=null;try{l=new AudioContext({sampleRate:e});const m=l.createAnalyser(),g=l.createGain();u=new Audio,u.src="",u.load(),u.autoplay=!0,u.style.display="none",document.body.appendChild(u);const v=l.createMediaStreamDestination();u.srcObject=v.stream,g.connect(m),m.connect(v),await TM(l.audioWorklet,o==null?void 0:o.audioConcatProcessor);const S=new AudioWorkletNode(l,"audioConcatProcessor");return S.port.postMessage({type:"setFormat",format:n}),S.connect(g),await l.resume(),s&&u.setSinkId&&await u.setSinkId(s),new hc(l,m,g,S,u)}catch(m){var d,f;throw(d=u)!=null&&d.parentNode&&u.parentNode.removeChild(u),(f=u)==null||f.pause(),l&&l.state!=="closed"&&await l.close(),m}}constructor(e,n,s,o,l){this.context=void 0,this.analyser=void 0,this.gain=void 0,this.worklet=void 0,this.audioElement=void 0,this.context=e,this.analyser=n,this.gain=s,this.worklet=o,this.audioElement=l}async setOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");await this.audioElement.setSinkId(e||"")}async close(){this.audioElement.parentNode&&this.audioElement.parentNode.removeChild(this.audioElement),this.audioElement.pause(),await this.context.close()}}class Of extends io{static async startSession(e){var n;const s=io.getFullOptions(e);s.onStatusChange&&s.onStatusChange({status:"connecting"}),s.onCanSendFeedbackChange&&s.onCanSendFeedbackChange({canSendFeedback:!1});let o=null,l=null,u=null,d=null,f=null;if((n=e.useWakeLock)==null||n)try{f=await navigator.wakeLock.request("screen")}catch{}try{var m;return d=await navigator.mediaDevices.getUserMedia({audio:!0}),await ak(s.connectionDelay),l=await nk(e),[o,u]=await Promise.all([dc.create(yi({},l.inputFormat,{preferHeadphonesForIosDevices:e.preferHeadphonesForIosDevices,inputDeviceId:e.inputDeviceId,workletPaths:e.workletPaths,libsampleratePath:e.libsampleratePath})),hc.create(yi({},l.outputFormat,{outputDeviceId:e.outputDeviceId,workletPaths:e.workletPaths}))]),(m=d)==null||m.getTracks().forEach(E=>{E.stop()}),d=null,new Of(s,l,o,u,f)}catch(E){var g,v,S,T;s.onStatusChange&&s.onStatusChange({status:"disconnected"}),(g=d)==null||g.getTracks().forEach(D=>{D.stop()}),(v=l)==null||v.close(),await((S=o)==null?void 0:S.close()),await((T=u)==null?void 0:T.close());try{var x;await((x=f)==null?void 0:x.release()),f=null}catch{}throw E}}constructor(e,n,s,o,l){super(e,n),this.input=void 0,this.output=void 0,this.wakeLock=void 0,this.inputFrequencyData=void 0,this.outputFrequencyData=void 0,this.onInputWorkletMessage=u=>{this.status==="connected"&&this.connection.sendMessage({user_audio_chunk:$S(u.data[0].buffer)})},this.onOutputWorkletMessage=({data:u})=>{u.type==="process"&&this.updateMode(u.finished?"listening":"speaking")},this.addAudioBase64Chunk=u=>{this.output.gain.gain.cancelScheduledValues(this.output.context.currentTime),this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"}),this.output.worklet.port.postMessage({type:"buffer",buffer:kM(u)})},this.fadeOutAudio=()=>{this.updateMode("listening"),this.output.worklet.port.postMessage({type:"interrupt"}),this.output.gain.gain.exponentialRampToValueAtTime(1e-4,this.output.context.currentTime+2),setTimeout(()=>{this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"})},2e3)},this.calculateVolume=u=>{if(u.length===0)return 0;let d=0;for(let f=0;f<u.length;f++)d+=u[f]/255;return d/=u.length,d<0?0:d>1?1:d},this.setVolume=({volume:u})=>{const d=Number.isFinite(u)?Math.min(1,Math.max(0,u)):1;this.volume=d,this.connection instanceof fi?this.connection.setAudioVolume(d):this.output.gain.gain.value=d},this.input=s,this.output=o,this.wakeLock=l,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.output.worklet.port.onmessage=this.onOutputWorkletMessage}async handleEndSession(){await super.handleEndSession();try{var e;await((e=this.wakeLock)==null?void 0:e.release()),this.wakeLock=null}catch{}await this.input.close(),await this.output.close()}handleInterruption(e){super.handleInterruption(e),this.fadeOutAudio()}handleAudio(e){var n,s;this.lastInterruptTimestamp<=e.audio_event.event_id&&((n=(s=this.options).onAudio)==null||n.call(s,e.audio_event.audio_base_64),this.connection instanceof fi||this.addAudioBase64Chunk(e.audio_event.audio_base_64),this.currentEventId=e.audio_event.event_id,this.updateCanSendFeedback(),this.updateMode("speaking"))}setMicMuted(e){this.connection instanceof fi?this.connection.setMicMuted(e):this.input.setMuted(e)}getInputByteFrequencyData(){return this.inputFrequencyData!=null||(this.inputFrequencyData=new Uint8Array(this.input.analyser.frequencyBinCount)),this.input.analyser.getByteFrequencyData(this.inputFrequencyData),this.inputFrequencyData}getOutputByteFrequencyData(){return this.connection instanceof fi?this.connection.getOutputByteFrequencyData()||new Uint8Array(1024):(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.output.analyser.frequencyBinCount)),this.output.analyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData)}getInputVolume(){return this.calculateVolume(this.getInputByteFrequencyData())}getOutputVolume(){return this.calculateVolume(this.getOutputByteFrequencyData())}async changeInputDevice({sampleRate:e,format:n,preferHeadphonesForIosDevices:s,inputDeviceId:o}){try{if(this.connection instanceof ao)try{return await this.input.setInputDevice(o),this.input}catch(u){console.warn("Failed to change device on existing input, recreating:",u)}this.connection instanceof fi&&await this.connection.setAudioInputDevice(o||""),await this.input.close();const l=await dc.create({sampleRate:e??this.connection.inputFormat.sampleRate,format:n??this.connection.inputFormat.format,preferHeadphonesForIosDevices:s,inputDeviceId:o,workletPaths:this.options.workletPaths,libsampleratePath:this.options.libsampleratePath});return this.input=l,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.input}catch(l){throw console.error("Error changing input device",l),l}}async changeOutputDevice({sampleRate:e,format:n,outputDeviceId:s}){try{if(this.connection instanceof ao)try{return await this.output.setOutputDevice(s),this.output}catch(l){console.warn("Failed to change device on existing output, recreating:",l)}this.connection instanceof fi&&await this.connection.setAudioOutputDevice(s||""),await this.output.close();const o=await hc.create({sampleRate:e??this.connection.outputFormat.sampleRate,format:n??this.connection.outputFormat.format,outputDeviceId:s,workletPaths:this.options.workletPaths});return this.output=o,this.output}catch(o){throw console.error("Error changing output device",o),o}}}var gy;(function(a){a.SESSION_STARTED="session_started",a.PARTIAL_TRANSCRIPT="partial_transcript",a.COMMITTED_TRANSCRIPT="committed_transcript",a.COMMITTED_TRANSCRIPT_WITH_TIMESTAMPS="committed_transcript_with_timestamps",a.AUTH_ERROR="auth_error",a.ERROR="error",a.OPEN="open",a.CLOSE="close",a.QUOTA_EXCEEDED="quota_exceeded"})(gy||(gy={}));var vy,yy;(function(a){a.PCM_8000="pcm_8000",a.PCM_16000="pcm_16000",a.PCM_22050="pcm_22050",a.PCM_24000="pcm_24000",a.PCM_44100="pcm_44100",a.PCM_48000="pcm_48000",a.ULAW_8000="ulaw_8000"})(vy||(vy={})),(function(a){a.MANUAL="manual",a.VAD="vad"})(yy||(yy={}));class CM extends io{static startSession(e){return e.textOnly?Nf.startSession(e):Of.startSession(e)}}function xM(){return b.jsx("section",{id:"nicotine-ladder",className:"py-16 bg-white",children:b.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[b.jsxs("div",{className:"text-center mb-12",children:[b.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Nicotine Ladder of Health"}),b.jsx("p",{className:"text-lg text-gray-700 max-w-3xl mx-auto leading-relaxed",children:"Smoking harms the body because of combustion, not nicotine itself. This ladder shows common nicotine options from highest harm to lowest harm so you can see where you are today and what safer steps might look like."})]}),b.jsxs("div",{className:"space-y-8",children:[b.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 shadow-sm",children:[b.jsx("div",{className:"mb-4",children:b.jsx("span",{className:"inline-block bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium",children:"Level 1"})}),b.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Combustible Cigarettes"}),b.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Cigarettes burn tobacco at very high temperatures, creating smoke that contains thousands of chemicals including tar and carbon monoxide. Around half of long-term smokers die from smoking-related disease. Nicotine is present, but the main harm comes from combustion."})]}),b.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 shadow-sm",children:[b.jsx("div",{className:"mb-4",children:b.jsx("span",{className:"inline-block bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium",children:"Level 2"})}),b.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Heated Tobacco"}),b.jsx("p",{className:"text-gray-700 leading-relaxed mb-6",children:"Heated tobacco devices warm tobacco to about 350 degrees Celsius without burning it, which removes smoke and reduces harmful chemicals by around 90-95% compared with cigarettes. There is still nicotine and some risk, but no tar and far less carbon monoxide."}),b.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[b.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[b.jsx("img",{src:"/iqos.jpg",alt:"IQOS heated tobacco device",className:"w-full h-32 object-contain rounded-lg mb-4"}),b.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"IQOS"}),b.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"A smoke-free heated tobacco device for adult smokers who would otherwise continue to smoke."}),b.jsx("a",{href:"https://www.iqos.com",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"View on IQOS"})]}),b.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[b.jsx("img",{src:"/ploom.jpg",alt:"Ploom heated tobacco device",className:"w-full h-32 object-contain rounded-lg mb-4"}),b.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Ploom"}),b.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"A compact heated tobacco product that warms tobacco sticks instead of burning them."}),b.jsx("a",{href:"https://www.ploom.co.uk",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"View on Ploom"})]})]})]}),b.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 shadow-sm",children:[b.jsx("div",{className:"mb-4",children:b.jsx("span",{className:"inline-block bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium",children:"Level 3"})}),b.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"UK Regulated Vapes"}),b.jsx("p",{className:"text-gray-700 leading-relaxed mb-6",children:"UK regulated vapes use a nicotine-containing liquid which is heated into vapour. They do not contain tobacco and are tightly regulated on ingredients, nicotine strength and packaging. Evidence from Public Health England and other bodies suggests they are far less harmful than smoking and can help some smokers quit."}),b.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[b.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[b.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Closed Pod Vape"}),b.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Simple pre-filled device for adult smokers who want something easy to start with."}),b.jsx("a",{href:"https://www.gov.uk/guidance/e-cigarettes-regulations-for-consumer-products",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"See regulated vape options"})]}),b.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[b.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Refillable Vape"}),b.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Device where you refill the tank with e-liquid, often cheaper for regular users."}),b.jsx("a",{href:"https://www.gov.uk/guidance/e-cigarettes-regulations-for-consumer-products",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"See regulated vape options"})]})]})]}),b.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 shadow-sm",children:[b.jsx("div",{className:"mb-4",children:b.jsx("span",{className:"inline-block bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium",children:"Level 4"})}),b.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Nicotine Pouches"}),b.jsx("p",{className:"text-gray-700 leading-relaxed mb-6",children:"Small white pouches that sit under the lip and release pharmaceutical-grade nicotine through the gums. They contain no tobacco and no smoke, do not require inhaling and are popular with adults who want a discreet, lower-harm alternative to smoking. They are still addictive and for existing nicotine users only."}),b.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md max-w-md",children:[b.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Nicotine Pouches"}),b.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Tobacco-free pouches that release nicotine through the lining of the mouth."}),b.jsx("a",{href:"#",className:"inline-block bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"Learn more about pouches"})]})]}),b.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 shadow-sm",children:[b.jsx("div",{className:"mb-4",children:b.jsx("span",{className:"inline-block bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium",children:"Level 5"})}),b.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Nicotine Replacement Therapy (NRT)"}),b.jsx("p",{className:"text-gray-700 leading-relaxed mb-6",children:"Clinically tested products such as gum, patches, lozenges, sprays and microtabs that deliver a measured dose of pharmaceutical-grade nicotine without smoke. Recommended in many stop-smoking guidelines to help manage withdrawal and cravings."}),b.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/nicorette-2mg-nicotine.jpeg",alt:"Nicorette 2mg nicotine lozenge",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Nicorette Lozenge 2mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Nicotine replacement product used to relieve cravings as part of a quit attempt, used according to pack instructions."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/nicorette-2mg-gum.jpeg",alt:"Nicorette 2mg nicotine gum",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Nicorette Gum 2mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Medicated chewing gum that helps manage withdrawal symptoms when trying to quit smoking."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/nicorette-quickmist.jpeg",alt:"Nicorette QuickMist mouth spray",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Nicorette QuickMist"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Fast-acting mouth spray providing rapid relief from cravings and withdrawal symptoms."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/nicorette-invisi.jpeg",alt:"Nicorette Invisi patch 25mg",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Nicorette Invisi Patch 25mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Discreet 16-hour patch that delivers steady nicotine throughout the day to reduce cravings."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/nicorette-inhalator.jpeg",alt:"Nicorette Inhalator",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Nicorette Inhalator"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Inhaler device that mimics the hand-to-mouth action of smoking while delivering nicotine."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/nicorette-microtab.jpeg",alt:"Nicorette Microtab 2mg",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Nicorette Microtab 2mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Small tablets that dissolve under the tongue for discreet nicotine replacement therapy."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/niquitin.jpeg",alt:"NiQuitin Clear patch 21mg",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"NiQuitin Clear Patch 21mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Transparent 24-hour patch providing continuous nicotine support throughout day and night."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/niquitin-minis.jpeg",alt:"NiQuitin Minis lozenges 4mg",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"NiQuitin Minis 4mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Small lozenges that provide controlled nicotine release to help cope with strong cravings."})]}),b.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-md",children:[b.jsx("img",{src:"/niquitin-lozenges.jpeg",alt:"NiQuitin Mint lozenges 2mg",className:"w-full h-24 object-contain rounded mb-3"}),b.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"NiQuitin Mint Lozenges 2mg"}),b.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Mint-flavoured lozenges offering gradual nicotine release for craving management."})]})]})]}),b.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 shadow-sm",children:[b.jsx("div",{className:"mb-4",children:b.jsx("span",{className:"inline-block bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium",children:"Level 6"})}),b.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Nicotine Free"}),b.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Many people step down from smoking to lower-risk products, and some then choose to stop nicotine completely. The final choice is personal, but the lowest health risk is achieved when both smoke and nicotine are no longer used."})]})]})]})})}const EM=()=>{const[a,e]=B.useState(""),[n,s]=B.useState(!1),[o,l]=B.useState(""),[u,d]=B.useState(null),[f,m]=B.useState("Disconnected"),[g,v]=B.useState(""),[S,T]=B.useState(!1),[x,E]=B.useState([]),[D,M]=B.useState(window.innerWidth<=768),Y=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;let P=null;B.useEffect(()=>{const z=new URLSearchParams(window.location.search).get("email");z&&Y.test(z)&&(e(z),A(z));const J=()=>{document.hidden&&P&&S&&(console.log(" Page hidden - stopping conversation"),V())};document.addEventListener("visibilitychange",J);const H=()=>{M(window.innerWidth<=768)};return window.addEventListener("resize",H),()=>{document.removeEventListener("visibilitychange",J),window.removeEventListener("resize",H),P&&(console.log(" Component unmounting - cleaning up conversation"),P.endSession().catch(console.error),P=null)}},[]);const A=async z=>{s(!0),l("");try{const H=await fetch(`http://localhost:3000/api/user?email=${encodeURIComponent(z)}`);if(H.ok){const se=await H.json();d(se)}else if(H.status===404)l("We couldn't find your assessment. Enter your email again."),d(null);else throw new Error("Failed to load user profile")}catch{l("Unable to load your profile. Please try again.")}finally{s(!1)}};async function N(){try{l(""),console.log(" Requesting microphone permission..."),await navigator.mediaDevices.getUserMedia({audio:!0}),console.log(" Using ElevenLabs Conversation from npm package..."),console.log(" Starting conversation...");const z="agent_2901kb13dkgbemkbxhve2tbsymd2";console.log(" Using agent ID:",z);const J={};if(u&&u.answers){const H=u.answers;J.first_name=H["First name"]||"",J.smoking_duration=H["How long have you smoked cigarettes?"]||"",J.brand=H["What is your preferred cigarette brand?"]||"",J.cigs_per_day=H["On average, how many cigarettes do you smoke per day?"]||"",J.quit_attempts=H["How many times have you seriously tried to quit smoking?"]||"",J.long_quits=H["How many times have you quit smoking for 30 days or more?"]||"",J.motivation=H["What is your main motivation for wanting to quit smoking?"]||"";const se=H["Date of birth"];if(se){const fe=new Date(se),qe=new Date,$e=qe.getFullYear()-fe.getFullYear(),Je=qe.getMonth()-fe.getMonth();Je<0||Je===0&&qe.getDate()<fe.getDate()?J.age=($e-1).toString():J.age=$e.toString()}else J.age=""}console.log(" Dynamic variables:",J),P=await CM.startSession({agentId:z,connectionType:"websocket",dynamicVariables:J,onConnect:()=>{console.log(" Connected to agent successfully"),m("Connected"),T(!0)},onDisconnect:H=>{console.log(" Disconnected from agent. Reason:",H),m("Disconnected"),T(!1),v(""),l(`Disconnected: ${H||"Unknown reason"}`)},onError:H=>{console.error(" Conversation Error Details:",H),l(`Error: ${JSON.stringify(H)}`)},onModeChange:H=>{console.log(" Mode changed to:",H),v(H.mode==="speaking"?"Speaking":"Listening")},onMessage:H=>{if(console.log(" Message received:",H),H.type==="user_transcript"||H.source==="user"&&H.message){const se=H.message||H.text||H.content;se&&E(fe=>[...fe,{role:"user",content:se,timestamp:new Date}])}else if(H.type==="agent_response"||H.source==="ai"||H.role==="ai"){const se=H.message||H.text||H.content;se&&E(fe=>[...fe,{role:"agent",content:se,timestamp:new Date}])}console.log(x)},onStatusChange:H=>{console.log(" Status changed:",H),m(typeof H=="object"?H.status||"Unknown":H)}}),console.log(" Conversation object created:",P)}catch(z){console.error(" Failed to start conversation:",z),l(`Failed to start conversation: ${z.message||z}`)}}async function V(){if(console.log(" Stopping conversation..."),m("Disconnecting..."),T(!1),v(""),l(""),P){try{console.log(" Ending ElevenLabs session..."),await P.endSession(),console.log(" ElevenLabs session ended successfully")}catch(z){console.error(" Error ending session:",z)}P=null}try{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&document.querySelectorAll("audio, video").forEach(J=>{J.srcObject&&J.srcObject.getTracks().forEach(H=>H.stop())})}catch(z){console.log("Error stopping media streams:",z)}m("Disconnected"),T(!1),v(""),console.log(" Conversation fully stopped"),setTimeout(()=>{console.log(" Refreshing page for clean state..."),window.location.reload()},1e3)}const X=z=>{if(z.preventDefault(),!a||!Y.test(a)){l("Please enter a valid email address");return}window.location.href=`/chat-v2?email=${encodeURIComponent(a)}`};return n?b.jsxs("div",{style:Ke.loadingContainer,children:[b.jsx("div",{style:Ke.spinner}),b.jsx("p",{children:"Preparing your personalized session"})]}):u?b.jsxs(b.Fragment,{children:[b.jsx("style",{children:`
        @keyframes speakingWave {
          0%, 100% {
            transform: scaleY(0.3);
          }
          50% {
            transform: scaleY(1.2);
          }
        }
        
        @keyframes listeningPulse {
          0%, 100% {
            transform: scaleY(0.6);
            opacity: 0.6;
          }
          50% {
            transform: scaleY(0.8);
            opacity: 1;
          }
        }
        
        @keyframes textPulse {
          0%, 100% {
            opacity: 0.7;
          }
          50% {
            opacity: 1;
          }
        }
      `}),b.jsxs("div",{style:Ke.fullScreenContainer,children:[b.jsx("div",{style:{background:"radial-gradient(circle at 30% 50%, rgba(59,130,246,0.1), transparent 50%), radial-gradient(circle at 70% 50%, rgba(34,197,94,0.1), transparent 50%)",textAlign:"center"},children:b.jsx("h1",{style:{background:"linear-gradient(to right, rgb(37, 99, 235), hsl(var(--primary)), rgb(22, 163, 74))",WebkitBackgroundClip:"text",backgroundClip:"text",display:"inline-block",color:"transparent",fontSize:"2rem",fontWeight:"bold",padding:"0.5rem"},children:"Smart Nicotine"})}),b.jsxs("div",{style:Ke.chatContainer,children:[b.jsxs("div",{style:Ke.audioVisualizerContainer,children:[b.jsxs("h3",{style:Ke.visualizerTitle,children:["Conversation with David Haye AI",b.jsxs("span",{style:Ke.statusContainer,children:[b.jsx("span",{style:Ke.statusDot,children:S?"":""}),b.jsx("span",{style:Ke.statusText,children:f}),g&&b.jsxs("span",{style:Ke.speakingIndicator,children:[" ",g]})]})]}),b.jsxs("div",{style:Ke.visualizerContent,children:[b.jsx("div",{style:Ke.waveContainer,children:[...Array(7)].map((z,J)=>b.jsx("div",{style:{...Ke.waveBar,animationDelay:`${J*.15}s`,...S&&g==="Speaking"?{...Ke.speakingBar,animationName:"speakingWave"}:S&&g==="Listening"?{...Ke.listeningBar,animationName:"listeningPulse"}:{...Ke.idleBar}}},J))}),!S&&b.jsx("p",{style:Ke.idleText,children:"Ready to start conversation..."}),S&&g==="Listening"&&b.jsx("p",{style:Ke.listeningText,children:" Listening for your voice..."}),S&&g==="Speaking"&&b.jsx("p",{style:Ke.speakingText,children:" David is speaking..."}),S&&!g&&b.jsx("p",{style:Ke.idleText,children:"Connected - Ready..."})]})]}),b.jsx("div",{style:Ke.controlsContainer,children:S?b.jsx("button",{onClick:V,style:Ke.stopButton,children:" Stop Conversation"}):b.jsx("button",{onClick:N,style:Ke.startButton,children:"PRESS ONCE to activate DH AI Coach"})})]})]}),b.jsxs("div",{className:"relative",children:[b.jsxs("svg",{className:"w-full h-24",viewBox:"0 0 1200 120",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("defs",{children:b.jsxs("linearGradient",{id:"waveGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[b.jsx("stop",{offset:"0%",stopColor:"#f8f9fa"}),b.jsx("stop",{offset:"100%",stopColor:"#ffffff"})]})}),b.jsx("path",{d:"M0,60 C150,100 300,0 600,60 C900,120 1050,20 1200,60 L1200,120 L0,120 Z",fill:"url(#waveGradient)"}),b.jsx("path",{d:"M0,80 C200,120 400,40 600,80 C800,120 1000,40 1200,80 L1200,120 L0,120 Z",fill:"#ffffff",opacity:"0.8"})]}),b.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"animate-bounce mb-2",children:b.jsx("svg",{className:"w-6 h-6 mx-auto text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),b.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Explore the Nicotine Ladder"})]})})]}),b.jsx(xM,{})]}):b.jsx("div",{style:Ke.emailContainer,children:b.jsxs("div",{style:Ke.emailForm,children:[b.jsx("h2",{children:"Smart Nicotine AI Guide"}),b.jsx("p",{children:"Enter your email to continue"}),o&&b.jsx("div",{style:Ke.error,children:o}),b.jsxs("form",{onSubmit:X,children:[b.jsx("input",{type:"email",value:a,onChange:z=>e(z.target.value),placeholder:"your.email@example.com",style:Ke.emailInput,required:!0}),b.jsx("button",{type:"submit",style:Ke.emailButton,children:"Continue"})]})]})})},Ke={emailContainer:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",padding:"20px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},emailForm:{background:"white",padding:"40px",borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",textAlign:"center",maxWidth:"400px",width:"100%"},emailInput:{width:"100%",padding:"12px 16px",border:"2px solid #e1e5e9",borderRadius:"8px",fontSize:"16px",marginBottom:"20px",boxSizing:"border-box",fontFamily:"inherit"},emailButton:{background:"#4CAF50",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",cursor:"pointer",width:"100%",fontFamily:"inherit"},error:{background:"#fee",color:"#c53030",padding:"12px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #fed7d7"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},spinner:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #4CAF50",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"20px"},fullScreenContainer:{display:"flex",flexDirection:"column",width:"100vw",background:"#f8f9fa",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',overflow:"hidden",marginBottom:"100px"},statusContainer:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"14px",marginLeft:"15px"},statusDot:{fontSize:"10px"},statusText:{fontWeight:"500",color:"gray"},speakingIndicator:{color:"#ffeb3b",fontWeight:"600"},chatContainer:{flex:1,display:"flex",flexDirection:"column",padding:"20px",background:"#ffffff"},controlsContainer:{display:"flex",gap:"16px",marginBottom:"30px",justifyContent:"center",flexWrap:"wrap"},startButton:{background:"linear-gradient(135deg, #4CAF50, #45a049)",color:"white",border:"none",borderRadius:"12px",padding:"16px 32px",cursor:"pointer",fontSize:"16px",fontFamily:"inherit",fontWeight:"600",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)",transition:"all 0.3s ease",minWidth:"200px"},stopButton:{background:"linear-gradient(135deg, #f44336, #d32f2f)",color:"white",border:"none",borderRadius:"12px",padding:"16px 32px",cursor:"pointer",fontSize:"16px",fontFamily:"inherit",fontWeight:"600",boxShadow:"0 4px 12px rgba(244, 67, 54, 0.3)",transition:"all 0.3s ease",minWidth:"200px"},audioVisualizerContainer:{background:"#f8f9fa",borderRadius:"12px",border:"1px solid #e1e5e9",overflow:"hidden",display:"flex",flexDirection:"column",width:"100%",maxWidth:"700px",margin:"0 auto 20px auto"},visualizerTitle:{margin:"0",padding:"16px 20px",borderBottom:"1px solid #e1e5e9",background:"#ffffff",fontSize:"18px",fontWeight:"600",color:"#2c3e50"},visualizerContent:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px",minHeight:"300px"},waveContainer:{display:"flex",alignItems:"end",justifyContent:"center",gap:"8px",marginBottom:"24px"},waveBar:{width:"8px",borderRadius:"4px",transition:"all 0.3s ease"},idleBar:{height:"12px",backgroundColor:"#e0e0e0",animation:"none"},listeningBar:{height:"20px",backgroundColor:"#2196F3",animation:"listeningPulse 2s ease-in-out infinite"},speakingBar:{height:"35px",backgroundColor:"#4CAF50",animation:"speakingWave 0.8s ease-in-out infinite"},idleText:{color:"#666",fontSize:"16px",fontWeight:"500",textAlign:"center",margin:"0"},listeningText:{color:"#2196F3",fontSize:"16px",fontWeight:"600",textAlign:"center",margin:"0",animation:"textPulse 2s ease-in-out infinite"},speakingText:{color:"#4CAF50",fontSize:"16px",fontWeight:"600",textAlign:"center",margin:"0",animation:"textPulse 1s ease-in-out infinite"}};function wM(){return b.jsx($x,{children:b.jsxs(Mx,{children:[b.jsx(Vr,{path:"/",element:b.jsx($v,{children:b.jsx(ew,{})})}),b.jsx(Vr,{path:"/assessment",element:b.jsx($v,{children:b.jsx(tw,{})})}),b.jsx(Vr,{path:"/chat",element:b.jsx(nw,{})}),b.jsx(Vr,{path:"/chat-v2",element:b.jsx(EM,{})})]})})}window.React=Wh;window.ReactDOM=PC;function _M(){return b.jsx(Wh.StrictMode,{children:b.jsx(wM,{})})}const RM=BC.createRoot(document.getElementById("root"));RM.render(b.jsx(_M,{}));
